<!DOCTYPE html>
<html>
  
<!-- Mirrored from beautifulracket.com/wires/specification-and-setup.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 16 Mar 2017 05:47:41 GMT -->
<head>
    <meta charset="UTF-8">
    <title>Beautiful Racket: Imagine a language: wires</title>
    <link rel="stylesheet" type="text/css" media="all" href="../styles.css"/>
    <script type="text/javascript" src="../functions.js"></script>
    <script type="text/javascript" src="../clipboard.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-74684045-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>
<body>
<div id="alert">Thank you for your comment</div>
    <div id="doc"><h3 class="dept" anchorize="false"><a href="../index.html">Beau­ti­ful Racket</a> / <a href="../index.html#tutorials">tuto­ri­als</a></h3><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;imagine-a-language-wires&quot;)"></div><h1 anchor="imagine-a-language-wires" id="imagine-a-language-wires" hyphens="none">Imagine a language: <span class="my-code" decode="exclude">wires</span></h1></div><ul class="siblinks"><li><a href="intro.html">1&emsp;intro</a></li><li><a class="here" href="specification-and-setup.html">2&emsp;spec­i­fi­ca­tion and setup</a></li><li><a href="the-reader.html">3&emsp;the reader</a></li><li><a href="the-expander.html">4&emsp;the expander</a></li><li><a href="testing-the-language.html">5&emsp;test­ing the lan­guage</a></li><li><a href="recap.html">6&emsp;recap</a></li><li><a href="source-listing.html">7&emsp;source list­ing</a></li></ul><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_njV22&quot;)"></div><p id="a_njV22">Recall that in our <a href="../jsonic/index.html"><span class="my-code" decode="exclude">jsonic</span></a> <a href="../jsonic/language-specification.html">lan­guage spec­i­fi­ca­tion</a>, we had the idea to treat ordi­nary JSON as valid source code for our DSL.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_2ZmFO&quot;)"></div><p id="a_2ZmFO">We’ll take a sim­i­lar approach here. Our <a href="input.txt">puz­zle input</a> describes the wires in a cir­cuit. But we could also think of it as the source code of a lan­guage that doesn’t yet exist. If we cre­ate that lan­guage, we can con­vert the puz­zle input from an inert file to some­thing we can run with Racket. And then we can get the solu­tion to our <a href="intro.html#the-question">puz­zle ques­tion</a>.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_e7ru3&quot;)"></div><p id="a_e7ru3">That lan­guage is <span class="my-code" decode="exclude">wires</span>.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;requirements&quot;)"></div><h3 anchor="requirements" class="subhead" id="requirements"><a href="#requirements">Require­ments</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_9GAtC&quot;)"></div><p id="a_9GAtC">The <a href="intro.html#a-programming-puzzle">puz­zle</a> gives us a smaller work­ing cir­cuit that will also be a valid <span class="my-code" decode="exclude">wires</span> pro­gram. Let’s start there and see what we can fig­ure out:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_dIUBA&quot;)"></div><div class="highlight-container" id="a_dIUBA"><div id="code_43" form="false" decode="exclude" style="font-size:0;width:0;height:0">x AND y -&gt; d<br/>x OR y -&gt; e<br/>x LSHIFT 2 -&gt; f<br/>y RSHIFT 2 -&gt; g<br/>NOT x -&gt; h<br/>NOT y -&gt; i<br/>123 -&gt; x<br/>456 -&gt; y</div><div class="highlight" form="false" id="a_2RRoo"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="source"><pre>x AND y -&gt; d
x OR y -&gt; e
x LSHIFT 2 -&gt; f
y RSHIFT 2 -&gt; g
NOT x -&gt; h
NOT y -&gt; i
123 -&gt; x
456 -&gt; y
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk" data-clipboard-target="#code_43" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_kYCoq&quot;)"></div><p id="a_kYCoq">Accord­ing to the puz­zle, each line describes the input to a wire. The name of the wire is on the right end of the line. The input is on the left, sep­a­rated by <span class="my-code" decode="exclude">-&gt;</span>. A wire receives the result of one of six types of input:</p></div><ol><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_AjuGb&quot;)"></div><p id="a_AjuGb">A con­stant value, like <span class="my-code" decode="exclude">123</span> or <span class="my-code" decode="exclude">456</span>.</p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_vm6pA&quot;)"></div><p id="a_vm6pA">A <span class="my-code" decode="exclude">NOT</span> oper­a­tion, which takes one other con­stant value or wire as its argu­ment.</p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_wOv3z&quot;)"></div><p id="a_wOv3z">An oper­a­tion com­bin­ing two other con­stant val­ues or wires—either <span class="my-code" decode="exclude">AND</span>,</p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_ZG9kr&quot;)"></div><p id="a_ZG9kr"><span class="my-code" decode="exclude">OR</span>,</p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_GXhRs&quot;)"></div><p id="a_GXhRs"><span class="my-code" decode="exclude">LSHIFT</span>,</p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_Mx9VZ&quot;)"></div><p id="a_Mx9VZ">or <span class="my-code" decode="exclude">RSHIFT</span>.</p></div></li></ol><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_CZeQ4&quot;)"></div><p id="a_CZeQ4">If we can han­dle these six kinds of input, we should be able to model any wire.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_DKE9G&quot;)"></div><p id="a_DKE9G">The puz­zle also <a href="intro.html#the-problems">asks us</a> to deter­mine the value on a wire. So we’ll print the value of every wire as demon­strated in the puz­zle descrip­tion. We can see how this works now by run­ning our sam­ple cir­cuit as a <span class="my-code" decode="exclude">wires-demo</span> pro­gram:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_nJ49l&quot;)"></div><div class="highlight-container" id="a_nJ49l"><div id="code_44" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang wires-demo<br/>x AND y -&gt; d<br/>x OR y -&gt; e<br/>x LSHIFT 2 -&gt; f<br/>y RSHIFT 2 -&gt; g<br/>NOT x -&gt; h<br/>NOT y -&gt; i<br/>123 -&gt; x<br/>456 -&gt; y</div><div class="highlight" form="false" id="a_2N6b3"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="source"><pre>#lang wires-demo
x AND y -&gt; d
x OR y -&gt; e
x LSHIFT 2 -&gt; f
y RSHIFT 2 -&gt; g
NOT x -&gt; h
NOT y -&gt; i
123 -&gt; x
456 -&gt; y
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk1" data-clipboard-target="#code_44" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_Gwhcp&quot;)"></div><div class="highlight-container" id="a_Gwhcp"><div id="code_45" form="false" decode="exclude" style="font-size:0;width:0;height:0">d: 72<br/>e: 507<br/>f: 492<br/>g: 114<br/>h: 65412<br/>i: 65079<br/>x: 123<br/>y: 456</div><div class="highlight" form="false" id="a_FoTP0"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="source"><pre>d: 72
e: 507
f: 492
g: 114
h: 65412
i: 65079
x: 123
y: 456
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk2" data-clipboard-target="#code_45" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_zy4UZ&quot;)"></div><p id="a_zy4UZ">Two wrin­kles:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_0aEnV&quot;)"></div><p id="a_0aEnV">First, a cir­cuit descrip­tion is a flat list of wires (like a <a href="../stacker/index.html"><span class="my-code" decode="exclude">stacker</span></a> pro­gram was a flat list of argu­ments). There­fore, the <span class="my-code" decode="exclude">wires</span> lan­guage won’t have a <a class="glossary" href="../appendix/glossary.html#recursive"><span class="glossary-link-text">recur­sive</span></a> struc­ture. This will let us sim­plify our <a class="glossary" href="../appendix/glossary.html#reader"><span class="glossary-link-text">reader</span></a>. Specif­i­cally, we can avoid using a sep­a­rate <a class="glossary" href="../appendix/glossary.html#grammar"><span class="glossary-link-text">gram­mar</span></a>-based <a class="glossary" href="../appendix/glossary.html#parser"><span class="glossary-link-text">parser</span></a>.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_lbD2g&quot;)"></div><p id="a_lbD2g">Sec­ond, even though the cir­cuit descrip­tion is a flat list, the depen­den­cies between wires might be in any order. For instance, in the cir­cuit above, the first six wire def­i­n­i­tions rely on val­ues from wires <span class="my-code" decode="exclude">x</span> and <span class="my-code" decode="exclude">y</span>, which aren’t defined until the end.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;design&quot;)"></div><h3 anchor="design" class="subhead" id="design"><a href="#design">Design</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_LDnFR&quot;)"></div><p id="a_LDnFR">As a rule of thumb, we want to model each ele­ment of a domain-spe­cific lan­guage using its clos­est equiv­a­lent in Racket. Why? Because we’re mak­ing a <a class="glossary" href="../appendix/glossary.html#source-to-source-compiler"><span class="glossary-link-text">source-to-source com­piler</span></a>, so we’d like to avoid rein­vent­ing wheels, or pound­ing round pegs into square holes. Wise mod­el­ing choices lead to sim­pler imple­men­ta­tions, because we’re del­e­gat­ing more of the heavy lift­ing to Racket.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_n5hX0&quot;)"></div><p id="a_n5hX0">For <span class="my-code" decode="exclude">wires</span>, our key insight is that each wire name can be thought of as an <a class="glossary" href="../appendix/glossary.html#identifier"><span class="glossary-link-text">iden­ti­fier</span></a>, and each wire descrip­tion as a <a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a> expres­sion bind­ing that iden­ti­fier. Fur­ther­more, the bit­wise oper­a­tions appear­ing on the left side of each wire descrip­tion—like <span class="my-code" decode="exclude">NOT</span>, <span class="my-code" decode="exclude">OR</span>, and <span class="my-code" decode="exclude">LSHIFT</span>—are just func­tions that take wires as their argu­ments.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_BiXUw&quot;)"></div><p id="a_BiXUw">In pseudocode, we could imag­ine trans­form­ing the sam­ple cir­cuit into a Racket pro­gram that looks like this (assum­ing for now that we’ve imple­mented the bit­wise oper­a­tions):</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_fcxIA&quot;)"></div><div class="highlight-container" id="a_fcxIA"><div id="code_46" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define d (AND x y))<br/>(define e (OR x y))<br/>(define f (LSHIFT x 2))<br/>(define g (RSHIFT y 2))<br/>(define h (NOT x))<br/>(define i (NOT y))<br/>(define x 123)<br/>(define y 456)</div><div class="highlight" form="false" id="a_KXM8G"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">d</span> <span class="p">(</span><span class="n">AND</span> <span class="n">x</span> <span class="n">y</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">e</span> <span class="p">(</span><span class="n">OR</span> <span class="n">x</span> <span class="n">y</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">f</span> <span class="p">(</span><span class="n">LSHIFT</span> <span class="n">x</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">g</span> <span class="p">(</span><span class="n">RSHIFT</span> <span class="n">y</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">h</span> <span class="p">(</span><span class="n">NOT</span> <span class="n">x</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">i</span> <span class="p">(</span><span class="n">NOT</span> <span class="n">y</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">x</span> <span class="mi">123</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">y</span> <span class="mi">456</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk3" data-clipboard-target="#code_46" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_nSXxV&quot;)"></div><p id="a_nSXxV">This meets some of our require­ments. The big prob­lem is that the wire def­i­n­i­tions are out of order. So if we were to run this pro­gram, it would fail in the first line when eval­u­at­ing <span class="my-code" decode="exclude">(AND x y)</span>, because <span class="my-code" decode="exclude">x</span> and <span class="my-code" decode="exclude">y</span> aren’t bound yet. We can trig­ger the same error with this anal­o­gous test pro­gram:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_jOQaO&quot;)"></div><div class="highlight-container" id="a_jOQaO"><div id="code_47" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define d (+ x y))<br/>(define x 123)<br/>(define y 456)</div><div class="highlight" form="false" id="a_mx3PR"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">d</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="n">x</span> <span class="n">y</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">x</span> <span class="mi">123</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">y</span> <span class="mi">456</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk4" data-clipboard-target="#code_47" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_RRjd1&quot;)"></div><div class="highlight-container err" id="a_RRjd1"><div id="code_48" form="false" decode="exclude" style="font-size:0;width:0;height:0">x: undefined;<br/> cannot reference an identifier before its definition</div><div class="highlight" form="false" id="a_QeXZ6"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="source"><pre>x: undefined;
 cannot reference an identifier before its definition
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk5" data-clipboard-target="#code_48" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_1dS6B&quot;)"></div><p id="a_1dS6B">So we need a way of set­ting up rela­tion­ships between wires, while delay­ing the actual eval­u­a­tion until requested. The sim­plest fix is to instead model each wire as a <a class="glossary" href="../appendix/glossary.html#function"><span class="glossary-link-text">func­tion</span></a> (again in pseudocode):</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_3JzGm&quot;)"></div><div class="highlight-container" id="a_3JzGm"><div id="code_49" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define (d) (AND (x) (y)))<br/>(define (e) (OR (x) (y)))<br/>(define (f) (LSHIFT (x) 2))<br/>(define (g) (RSHIFT (y) 2))<br/>(define (h) (NOT (x))<br/>(define (i) (NOT (y))<br/>(define (x) 123)<br/>(define (y) 456)</div><div class="highlight" form="false" id="a_vAPvU"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="p">(</span><span class="n">AND</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">(</span><span class="n">OR</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="p">(</span><span class="n">LSHIFT</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="p">(</span><span class="n">RSHIFT</span> <span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="p">(</span><span class="n">NOT</span> <span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">(</span><span class="n">NOT</span> <span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="mi">123</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="mi">456</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk6" data-clipboard-target="#code_49" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_2U8jc&quot;)"></div><p id="a_2U8jc">Con­vert­ing the wires into func­tions doesn’t change their under­ly­ing val­ues. But it does delay the eval­u­a­tion of each wire until we invoke that par­tic­u­lar wire func­tion. It also makes it pos­si­ble to have ref­er­ences between wires that are out of order.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_aLWuc&quot;)"></div><p id="a_aLWuc">Again, we can see how this works by updat­ing our test pro­gram and run­ning it again:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_qZ3re&quot;)"></div><div class="highlight-container" id="a_qZ3re"><div id="code_50" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define (d) (+ (x) (y)))<br/>(define (x) 123)<br/>(define (y) 456)</div><div class="highlight" form="false" id="a_mIH6g"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="mi">123</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="mi">456</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk7" data-clipboard-target="#code_50" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_9HDc9&quot;)"></div><p id="a_9HDc9">This time, no error. And if we eval­u­ate <span class="my-code" decode="exclude">(d)</span> on the REPL:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_tdz0j&quot;)"></div><div class="highlight-container" id="a_tdz0j"><div id="code_51" form="false" decode="exclude" style="font-size:0;width:0;height:0">&gt; (d)</div><div class="highlight" form="false" id="a_9KBEN"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="source"><pre>&gt; (d)
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk8" data-clipboard-target="#code_51" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_AniQU&quot;)"></div><p id="a_AniQU">We get the right answer:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_PVvFZ&quot;)"></div><div class="highlight-container" id="a_PVvFZ"><div id="code_52" form="false" decode="exclude" style="font-size:0;width:0;height:0">579</div><div class="highlight" form="false" id="a_olh5i"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="source"><pre><span class="mi">579</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk9" data-clipboard-target="#code_52" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_pyOFv&quot;)"></div><p id="a_pyOFv">This gives us enough of a roadmap to start build­ing the lan­guage.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_rlxGk&quot;)"></div><p id="a_rlxGk">We’ll also need to fig­ure out how to imple­ment our bit­wise oper­a­tions and our print­ing rou­tine. We’ll deal with those as they arise.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;setup&quot;)"></div><h3 anchor="setup" class="subhead" id="setup"><a href="#setup">Setup</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_f0fKK&quot;)"></div><p id="a_f0fKK">Fol­low the instruc­tions in the <a href="../appendix/master-recipe.html#setting-up-a-language-project">mas­ter recipe</a> to make a <span class="my-code" decode="exclude">wires</span> direc­tory and install it as a pack­age. As with <span class="my-code" decode="exclude">stacker</span>, we’ll be able to build this lan­guage using one (hard-work­ing) source file called <span class="my-code" decode="exclude">"main.rkt"</span>.</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">wires/main.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_YKwDl&quot;)"></div><div class="highlight-container" id="a_YKwDl"><div id="code_53" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br/quicklang<br/>···</div><div class="highlight" form="false" id="a_oT3Ss"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br/quicklang</span>
<span class="n">···</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpka" data-clipboard-target="#code_53" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_hulWl&quot;)"></div><p id="a_hulWl">We’re build­ing our lan­guage using a sin­gle source file. So the <span class="my-code" decode="exclude">"main.rkt"</span> mod­ule will con­tain both the reader and the expander.</p></div><div anchorize="false" style="height:2em"></div><ul class="siblinks"><li><a href="intro.html">1&emsp;intro</a></li><li><a class="here" href="specification-and-setup.html">2&emsp;spec­i­fi­ca­tion and setup</a></li><li><a href="the-reader.html">3&emsp;the reader</a></li><li><a href="the-expander.html">4&emsp;the expander</a></li><li><a href="testing-the-language.html">5&emsp;test­ing the lan­guage</a></li><li><a href="recap.html">6&emsp;recap</a></li><li><a href="source-listing.html">7&emsp;source list­ing</a></li></ul></div>
    <a class="nav-left" href="intro.html">← prev</a>
    <a class="nav-right" href="the-reader.html">next →</a>




</body>

<script type="text/javascript">



function show_all_forms() {
 var elems = document.getElementsByClassName('has_form');
 for (var i = 0 ; i < elems.length ; i++) {
  toggle_form(elems[i].id);
 }
}

// for debugging forms only: uncomment next line
// show_all_forms();

// sets up copy-to-clipboard buttons in code boxes
var clipboard = new Clipboard('.copy-button');
clipboard.on('success', function(e) {console.log(e);});
clipboard.on('error', function(e) {console.log(e);});
</script>