<!DOCTYPE html>
<html>
  
<!-- Mirrored from beautifulracket.com/jsonic/the-parser.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 16 Mar 2017 05:47:17 GMT -->
<head>
    <meta charset="UTF-8">
    <title>Beautiful Racket: Extend a data format: jsonic</title>
    <link rel="stylesheet" type="text/css" media="all" href="../styles.css"/>
    <script type="text/javascript" src="../functions.js"></script>
    <script type="text/javascript" src="../clipboard.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-74684045-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>
<body>
<div id="alert">Thank you for your comment</div>
    <div id="doc"><h3 class="dept" anchorize="false"><a href="../index.html">Beau­ti­ful Racket</a> / <a href="../index.html#tutorials">tuto­ri­als</a></h3><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;extend-a-data-format-jsonic&quot;)"></div><h1 anchor="extend-a-data-format-jsonic" id="extend-a-data-format-jsonic" hyphens="none">Extend a data format: <span class="my-code" decode="exclude">jsonic</span></h1></div><ul class="siblinks"><li><a href="intro.html">1&emsp;intro</a></li><li><a href="specification.html">2&emsp;spec­i­fi­ca­tion</a></li><li><a href="setup.html">3&emsp;setup</a></li><li><a href="the-reader.html">4&emsp;the reader</a></li><li><a href="the-tokenizer.html">5&emsp;the tok­enizer</a></li><li><a class="here" href="the-parser.html">6&emsp;the parser</a></li><li><a href="the-expander.html">7&emsp;the expander</a></li><li><a href="testing-the-language.html">8&emsp;test­ing the lan­guage</a></li><li><a href="recap.html">9&emsp;recap</a></li><li><a href="source-listing.html">10&emsp;source list­ing</a></li></ul><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;the-parser&quot;)"></div><h3 anchor="the-parser" class="subhead" id="the-parser"><a href="#the-parser">The parser</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_eApl0&quot;)"></div><p id="a_eApl0">As we did in <a href="../bf/the-parser.html"><span class="my-code" decode="exclude">bf</span></a>, we’ll use <span class="my-code" decode="exclude">#lang brag</span> to gen­er­ate a parser for <span class="my-code" decode="exclude">jsonic</span> based on a <a class="glossary" href="../appendix/glossary.html#grammar"><span class="glossary-link-text">gram­mar</span></a> that describes the struc­ture of <span class="my-code" decode="exclude">jsonic</span> pro­grams. The parser will take the tokens gen­er­ated by the tok­enizer and orga­nize them into a <a class="glossary" href="../appendix/glossary.html#parse-tree"><span class="glossary-link-text">parse tree</span></a>. (Later, this parse tree will be passed to the <a class="glossary" href="../appendix/glossary.html#expander"><span class="glossary-link-text">expander</span></a> for fur­ther pro­cess­ing.)</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_XFKYW&quot;)"></div><p id="a_XFKYW">Let’s start a new file called <span class="my-code" decode="exclude">"parser.rkt"</span>. From there, we’ll build the gram­mar piece by piece:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic/parser.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_3AH9l&quot;)"></div><div class="highlight-container" id="a_3AH9l"><div id="code_43" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang brag</div><div class="highlight" form="false" id="a_yIF6v"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="source"><pre>#lang brag
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk" data-clipboard-target="#code_43" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_a6zY5&quot;)"></div><p id="a_a6zY5">The first line rep­re­sents the start­ing pro­duc­tion rule, which will become the top node of the parse tree. We name this rule <span class="my-code" decode="exclude">jsonic-program</span>:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic/parser.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_ALSV9&quot;)"></div><div class="highlight-container" id="a_ALSV9"><div id="code_44" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang brag<br/>jsonic-program :</div><div class="highlight" form="false" id="a_UiWtw"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="source"><pre>#lang brag
<span class="hll">jsonic-program :
</span></pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk1" data-clipboard-target="#code_44" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_7Iavb&quot;)"></div><p id="a_7Iavb">What’s in a <span class="my-code" decode="exclude">jsonic-program</span>? Let’s be care­ful: though our source code com­bines syn­tax from JSON and S-expres­sions, our gram­mar doesn’t have to actu­ally han­dle the details of pars­ing JSON and S-expres­sions. It just needs to be able to dis­tin­guish one from the other. After that, the S-expres­sions can be eval­u­ated as usual; every­thing else is JSON, and can be passed through as is.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_A8gwj&quot;)"></div><p id="a_A8gwj">So we describe a <span class="my-code" decode="exclude">jsonic-program</span> as a sequence of two pos­si­ble ele­ments: a <span class="my-code" decode="exclude">jsonic-char</span> or an <span class="my-code" decode="exclude">jsonic-sexp</span>. We use <span class="my-code" decode="exclude">|</span> in the gram­mar to indi­cate a choice between ele­ments, and <span class="my-code" decode="exclude">*</span> to indi­cate zero or more occur­rences of the ele­ment:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic/parser.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_nMe5M&quot;)"></div><div class="highlight-container" id="a_nMe5M"><div id="code_45" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang brag<br/>jsonic-program : (jsonic-char | jsonic-sexp)*</div><div class="highlight" form="false" id="a_1eKfh"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="source"><pre>#lang brag
<span class="hll">jsonic-program : (jsonic-char | jsonic-sexp)*
</span></pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk2" data-clipboard-target="#code_45" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_v48Qt&quot;)"></div><p id="a_v48Qt">Now we need to add pro­duc­tion rules for our two new ele­ments, <span class="my-code" decode="exclude">jsonic-char</span> and <span class="my-code" decode="exclude">jsonic-sexp</span>:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic/parser.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_YIktV&quot;)"></div><div class="highlight-container" id="a_YIktV"><div id="code_46" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang brag<br/>jsonic-program : (jsonic-char | jsonic-sexp)*<br/>jsonic-char    :<br/>jsonic-sexp    :</div><div class="highlight" form="false" id="a_oAzlS"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre>#lang brag
jsonic-program : (jsonic-char | jsonic-sexp)*
<span class="hll">jsonic-char    :
</span><span class="hll">jsonic-sexp    :
</span></pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk3" data-clipboard-target="#code_46" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_TruuP&quot;)"></div><p id="a_TruuP">An <span class="my-code" decode="exclude">jsonic-sexp</span> is any sequence of char­ac­ters between our open and clos­ing delim­iters. But in our tok­enizer, we pack­aged our S-expres­sions into a named token called <span class="my-code" decode="exclude">SEXP-TOK</span>, and other char­ac­ters into a named token called <span class="my-code" decode="exclude">CHAR-TOK</span>. Now, we use these named tokens directly in our gram­mar:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic/parser.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_GE34m&quot;)"></div><div class="highlight-container" id="a_GE34m"><div id="code_47" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang brag<br/>jsonic-program : (jsonic-char | jsonic-sexp)*<br/>jsonic-char    : CHAR-TOK<br/>jsonic-sexp    : SEXP-TOK
</div><div class="highlight" form="false" id="a_5vnS4"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre>#lang brag
jsonic-program : (jsonic-char | jsonic-sexp)*
<span class="hll">jsonic-char    : CHAR-TOK
</span><span class="hll">jsonic-sexp    : SEXP-TOK
</span></pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk4" data-clipboard-target="#code_47" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_fp7N2&quot;)"></div><p id="a_fp7N2">By the way, when the parser matches a named token, it pulls the matched string out of the token and puts it in the parse tree. Thus, the fin­ished parse tree will con­tain no ref­er­ences to <span class="my-code" decode="exclude">SEXP-TOK</span> or <span class="my-code" decode="exclude">CHAR-TOK</span>. It will con­tain the strings that were inside those tokens.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_9yRaD&quot;)"></div><p id="a_9yRaD">And that’s all we need.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;testing-the-parser&quot;)"></div><h3 anchor="testing-the-parser" class="subhead" id="testing-the-parser"><a href="#testing-the-parser">Test­ing the parser</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_5FJnJ&quot;)"></div><p id="a_5FJnJ">As we did with <a href="the-tokenizer.html#testing-the-tokenizer">the tok­enizer</a>, let’s do some quick tests to make sure our gram­mar gen­er­ates sen­si­ble parse trees. Again, this isn’t a sub­sti­tute for thor­ough <a class="glossary" href="../appendix/glossary.html#unit-test"><span class="glossary-link-text">unit tests</span></a>. But it pro­vides a basic san­ity check before we move on. Also, as we’re build­ing a DSL, it’s good to know how we can watch the pieces work together pro­vi­sion­ally before we get all the way to test­ing source files.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_4XU4t&quot;)"></div><p id="a_4XU4t">Let’s start a new source file in DrRacket. We’ll <a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a> our new tok­enizer and parser from <span class="my-code" decode="exclude">jsonic/tokenizer</span> and <span class="my-code" decode="exclude">jsonic/parser</span>, respec­tively. We’ll also <span class="my-code" decode="exclude">require</span> <span class="my-code" decode="exclude">brag/support</span> so we can use <a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._apply-tokenizer-maker))" class="docs" hyphens="none">apply-tokenizer-maker</a> again.</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic-parser-test.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_Te4h3&quot;)"></div><div class="highlight-container" id="a_Te4h3"><div id="code_48" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br<br/>(require jsonic/parser jsonic/tokenizer brag/support)</div><div class="highlight" form="false" id="a_MTGH1"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">jsonic/parser</span> <span class="n">jsonic/tokenizer</span> <span class="n">brag/support</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk5" data-clipboard-target="#code_48" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_VVl6H&quot;)"></div><p id="a_VVl6H">We can now tok­enize &amp; parse toy pro­grams, either within the def­i­n­i­tions win­dow, or at the REPL prompt. For instance, a <span class="my-code" decode="exclude">jsonic</span> pro­gram con­sist­ing only of a com­ment should be parsed into a tree with a top <span class="my-code" decode="exclude">jsonic-program</span> node, and noth­ing else:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic-parser-test.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_RKEqE&quot;)"></div><div class="highlight-container" id="a_RKEqE"><div id="code_49" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br<br/>(require jsonic/parser jsonic/tokenizer brag/support)<br/><br/>(parse-to-datum (apply-tokenizer-maker make-tokenizer "// line commment\n"))</div><div class="highlight" form="false" id="a_0kBoB"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">jsonic/parser</span> <span class="n">jsonic/tokenizer</span> <span class="n">brag/support</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/examples/nested-word-list..rkt)._parse-to-datum))" class="docs" hyphens="none">parse-to-datum</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._apply-tokenizer-maker))" class="docs" hyphens="none">apply-tokenizer-maker</a></span> <span class="n">make-tokenizer</span> <span class="s2">"// line commment</span><span class="se">\n</span><span class="s2">"</span><span class="p">))</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk6" data-clipboard-target="#code_49" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_MX9I3&quot;)"></div><div class="highlight-container" id="a_MX9I3"><div id="code_50" form="false" decode="exclude" style="font-size:0;width:0;height:0">'(jsonic-program)</div><div class="highlight" form="false" id="a_YL1xp"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="source"><pre>&#39;(jsonic-program)
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk7" data-clipboard-target="#code_50" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_WxtvV&quot;)"></div><p id="a_WxtvV">A pro­gram with a sin­gle S-expres­sion between delim­iters:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic-parser-test.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_lJsrd&quot;)"></div><div class="highlight-container" id="a_lJsrd"><div id="code_51" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br<br/>(require jsonic/parser jsonic/tokenizer brag/support)<br/><br/>(parse-to-datum (apply-tokenizer-maker make-tokenizer "@$ 42 $@"))</div><div class="highlight" form="false" id="a_3uRCN"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">jsonic/parser</span> <span class="n">jsonic/tokenizer</span> <span class="n">brag/support</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/examples/nested-word-list..rkt)._parse-to-datum))" class="docs" hyphens="none">parse-to-datum</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._apply-tokenizer-maker))" class="docs" hyphens="none">apply-tokenizer-maker</a></span> <span class="n">make-tokenizer</span> <span class="s2">"@$ 42 $@"</span><span class="p">))</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk8" data-clipboard-target="#code_51" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_srizo&quot;)"></div><div class="highlight-container" id="a_srizo"><div id="code_52" form="false" decode="exclude" style="font-size:0;width:0;height:0">'(jsonic-program (jsonic-sexp " 42 "))</div><div class="highlight" form="false" id="a_QWxWU"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="source"><pre>&#39;(jsonic-program (jsonic-sexp " 42 "))
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk9" data-clipboard-target="#code_52" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_WX05Z&quot;)"></div><p id="a_WX05Z">A pro­gram with­out nested delim­iters:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic-parser-test.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_x1Xcc&quot;)"></div><div class="highlight-container" id="a_x1Xcc"><div id="code_53" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br<br/>(require jsonic/parser jsonic/tokenizer brag/support)<br/><br/>(parse-to-datum (apply-tokenizer-maker make-tokenizer "hi"))</div><div class="highlight" form="false" id="a_vPkRe"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">jsonic/parser</span> <span class="n">jsonic/tokenizer</span> <span class="n">brag/support</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/examples/nested-word-list..rkt)._parse-to-datum))" class="docs" hyphens="none">parse-to-datum</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._apply-tokenizer-maker))" class="docs" hyphens="none">apply-tokenizer-maker</a></span> <span class="n">make-tokenizer</span> <span class="s2">"hi"</span><span class="p">))</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpka" data-clipboard-target="#code_53" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_AerQE&quot;)"></div><div class="highlight-container" id="a_AerQE"><div id="code_54" form="false" decode="exclude" style="font-size:0;width:0;height:0">'(jsonic-program<br/>  (jsonic-char "h")<br/>  (jsonic-char "i"))</div><div class="highlight" form="false" id="a_LtrFn"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="source"><pre>&#39;(jsonic-program
  (jsonic-char "h")
  (jsonic-char "i"))
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkb" data-clipboard-target="#code_54" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_hD47k&quot;)"></div><p id="a_hD47k">A three-line pro­gram that con­tains all three items:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic-parser-test.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_M5eSK&quot;)"></div><div class="highlight-container" id="a_M5eSK"><div id="code_55" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br<br/>(require jsonic/parser jsonic/tokenizer brag/support)<br/><br/>(parse-to-datum (apply-tokenizer-maker make-tokenizer "hi\n// comment\n@$ 42 $@"))</div><div class="highlight" form="false" id="a_d08sa"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">jsonic/parser</span> <span class="n">jsonic/tokenizer</span> <span class="n">brag/support</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/examples/nested-word-list..rkt)._parse-to-datum))" class="docs" hyphens="none">parse-to-datum</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._apply-tokenizer-maker))" class="docs" hyphens="none">apply-tokenizer-maker</a></span> <span class="n">make-tokenizer</span> <span class="s2">"hi</span><span class="se">\n</span><span class="s2">// comment</span><span class="se">\n</span><span class="s2">@$ 42 $@"</span><span class="p">))</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkc" data-clipboard-target="#code_55" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_xCSBt&quot;)"></div><div class="highlight-container" id="a_xCSBt"><div id="code_56" form="false" decode="exclude" style="font-size:0;width:0;height:0">'(jsonic-program<br/>  (jsonic-char "h")<br/>  (jsonic-char "i")<br/>  (jsonic-char "\n")<br/>  (jsonic-sexp " 42 "))</div><div class="highlight" form="false" id="a_7jacq"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="source"><pre>&#39;(jsonic-program
  (jsonic-char "h")
  (jsonic-char "i")
  (jsonic-char "\n")
  (jsonic-sexp " 42 "))
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkd" data-clipboard-target="#code_56" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_mIL8S&quot;)"></div><p id="a_mIL8S">Exactly right.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;here-strings&quot;)"></div><h3 anchor="here-strings" class="subhead" id="here-strings"><a href="#here-strings">Here strings</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_KE6qv&quot;)"></div><p id="a_KE6qv">This is an apt moment to learn an eas­ier way to write mul­ti­line input for any Racket func­tion: a <em><a class="glossary" href="../appendix/glossary.html#here-string"><span class="glossary-link-text">here string</span></a></em>. A here string is intro­duced with <span class="my-code" decode="exclude">#&lt;&lt;LABEL</span>, where <span class="my-code" decode="exclude">LABEL</span> is an arbi­trary name that will ter­mi­nate the here string. The here string starts on the next line, and ends when <span class="my-code" decode="exclude">LABEL</span> appears on a line of its own. Below, we’ll use <span class="my-code" decode="exclude">DEREK</span> as a ter­mi­na­tor, and add quotes around <span class="my-code" decode="exclude">foo</span>:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic-parser-test.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_AHqUe&quot;)"></div><div class="highlight-container" id="a_AHqUe"><div id="code_57" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br<br/>(require jsonic/parser jsonic/tokenizer brag/support)<br/><br/>(parse-to-datum (apply-tokenizer-maker make-tokenizer #&lt;&lt;DEREK<br/>"foo"<br/>// comment<br/>@$ 42 $@<br/>DEREK<br/>))
</div><div class="highlight" form="false" id="a_dfDWZ"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">jsonic/parser</span> <span class="n">jsonic/tokenizer</span> <span class="n">brag/support</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/examples/nested-word-list..rkt)._parse-to-datum))" class="docs" hyphens="none">parse-to-datum</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._apply-tokenizer-maker))" class="docs" hyphens="none">apply-tokenizer-maker</a></span> <span class="n">make-tokenizer</span> <span class="sh">#&lt;&lt;DEREK</span>
<span class="sh">"foo"</span>
<span class="sh">// comment</span>
<span class="sh">@$ 42 $@</span>
<span class="sh">DEREK</span>
<span class="p">))</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpke" data-clipboard-target="#code_57" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_lj32q&quot;)"></div><div class="highlight-container" id="a_lj32q"><div id="code_58" form="false" decode="exclude" style="font-size:0;width:0;height:0">'(jsonic-program<br/>  (jsonic-char "\"")<br/>  (jsonic-char "f")<br/>  (jsonic-char "o")<br/>  (jsonic-char "o")<br/>  (jsonic-char "\"")<br/>  (jsonic-char "\n")<br/>  (jsonic-sexp " 42 "))</div><div class="highlight" form="false" id="a_eSOPW"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="source"><pre>&#39;(jsonic-program
  (jsonic-char "\"")
  (jsonic-char "f")
  (jsonic-char "o")
  (jsonic-char "o")
  (jsonic-char "\"")
  (jsonic-char "\n")
  (jsonic-sexp " 42 "))
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkf" data-clipboard-target="#code_58" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_icuRw&quot;)"></div><p id="a_icuRw">The quotes around <span class="my-code" decode="exclude">"foo"</span> are treated as part of the source string, and thus appear in the parse tree.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_bNSmZ&quot;)"></div><p id="a_bNSmZ">As we look over these results, we should recall that in every parse tree, all the char­ac­ters in our source code will appear in a node of the parse tree (except those that are delib­er­ately removed, like com­ments). Fur­ther­more, the nodes of the parse tree cor­re­spond to the names and pat­terns of the pro­duc­tion rules in the gram­mar. This struc­ture, in turn, will guide the struc­ture of our expander. We’ll add that next.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;reader-recap&quot;)"></div><h3 anchor="reader-recap" class="subhead" id="reader-recap"><a href="#reader-recap">Reader recap</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_eDUjV&quot;)"></div><p id="a_eDUjV">Before we move on, let’s make sure our reader source files are cor­rect:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic/main.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_x72hn&quot;)"></div><div class="highlight-container" id="a_x72hn"><div id="code_59" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br/quicklang<br/>(module reader br<br/>  (require "reader.rkt")<br/>  (provide read-syntax))</div><div class="highlight" form="false" id="a_ssPlz"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br/quicklang</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/module.html#(form._((quote._~23~25kernel)._module))" class="docs" hyphens="none">module</a></span> <span class="n">reader</span> <span class="n">br</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="s2">"reader.rkt"</span><span class="p">)</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._provide))" class="docs" hyphens="none">provide</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/Reading.html#(def._((quote._~23~25kernel)._read-syntax))" class="docs" hyphens="none">read-syntax</a></span><span class="p">))</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkg" data-clipboard-target="#code_59" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic/reader.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_GXlrY&quot;)"></div><div class="highlight-container" id="a_GXlrY"><div id="code_60" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br/quicklang<br/>(require "tokenizer.rkt" "parser.rkt")<br/><br/>(define (read-syntax path port)<br/>  (define parse-tree (parse path (make-tokenizer port)))<br/>  (define module-datum `(module jsonic-module jsonic/expander<br/>                          ,parse-tree))<br/>  (datum-&gt;syntax #f module-datum))<br/>(provide read-syntax)</div><div class="highlight" form="false" id="a_FmXoN"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br/quicklang</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="s2">"tokenizer.rkt"</span> <span class="s2">"parser.rkt"</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/Reading.html#(def._((quote._~23~25kernel)._read-syntax))" class="docs" hyphens="none">read-syntax</a></span> <span class="n">path</span> <span class="n">port</span><span class="p">)</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">parse-tree</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/examples/nested-word-list..rkt)._parse))" class="docs" hyphens="none">parse</a></span> <span class="n">path</span> <span class="p">(</span><span class="n">make-tokenizer</span> <span class="n">port</span><span class="p">)))</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">module-datum</span> <span class="o">`</span><span class="p">(</span><span class="ss">module</span> <span class="ss">jsonic-module</span> <span class="ss">jsonic/expander</span>
                          <span class="o">,</span><span class="n">parse-tree</span><span class="p">))</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stxops.html#(def._((quote._~23~25kernel)._datum-~3esyntax))" class="docs" hyphens="none">datum-&gt;syntax</a></span> <span class="no">#f</span> <span class="n">module-datum</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._provide))" class="docs" hyphens="none">provide</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/Reading.html#(def._((quote._~23~25kernel)._read-syntax))" class="docs" hyphens="none">read-syntax</a></span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkh" data-clipboard-target="#code_60" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic/tokenizer.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_xzTPX&quot;)"></div><div class="highlight-container" id="a_xzTPX"><div id="code_61" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br/quicklang<br/>(require brag/support)<br/><br/>(define (make-tokenizer port)<br/>  (define (next-token)<br/>    (define jsonic-lexer<br/>      (lexer<br/>       [(eof) eof]<br/>       [(from/to "//" "\n") (next-token)]<br/>       [(from/to "@$" "$@")<br/>        (token 'SEXP-TOK (trim-ends "@$" lexeme "$@"))]<br/>       [any-char (token 'CHAR-TOK lexeme)]))<br/>    (jsonic-lexer port))  <br/>  next-token)<br/>(provide make-tokenizer)</div><div class="highlight" form="false" id="a_cFjly"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br/quicklang</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">brag/support</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">make-tokenizer</span> <span class="n">port</span><span class="p">)</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">next-token</span><span class="p">)</span>
    <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">jsonic-lexer</span>
      <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexer))" class="docs" hyphens="none">lexer</a></span>
       <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/port-ops.html#(def._((quote._~23~25kernel)._eof))" class="docs" hyphens="none">eof</a></span><span class="p">)</span> <span class="nb"><a href="http://docs.racket-lang.org/reference/port-ops.html#(def._((quote._~23~25kernel)._eof))" class="docs" hyphens="none">eof</a></span><span class="p">]</span>
       <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._from/to))" class="docs" hyphens="none">from/to</a></span> <span class="s2">"//"</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="p">(</span><span class="n">next-token</span><span class="p">)]</span>
       <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._from/to))" class="docs" hyphens="none">from/to</a></span> <span class="s2">"@$"</span> <span class="s2">"$@"</span><span class="p">)</span>
        <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._token))" class="docs" hyphens="none">token</a></span> <span class="o">&#39;</span><span class="ss">SEXP-TOK</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._trim-ends))" class="docs" hyphens="none">trim-ends</a></span> <span class="s2">"@$"</span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexeme))" class="docs" hyphens="none">lexeme</a></span> <span class="s2">"$@"</span><span class="p">))]</span>
       <span class="p">[</span><span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._any-char))" class="docs" hyphens="none">any-char</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._token))" class="docs" hyphens="none">token</a></span> <span class="o">&#39;</span><span class="ss">CHAR-TOK</span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexeme))" class="docs" hyphens="none">lexeme</a></span><span class="p">)]))</span>
    <span class="p">(</span><span class="n">jsonic-lexer</span> <span class="n">port</span><span class="p">))</span>  
  <span class="n">next-token</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._provide))" class="docs" hyphens="none">provide</a></span> <span class="n">make-tokenizer</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpki" data-clipboard-target="#code_61" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">jsonic/parser.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_GE34ml&quot;)"></div><div class="highlight-container" id="a_GE34ml"><div id="code_62" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang brag<br/>jsonic-program : (jsonic-char | jsonic-sexp)*<br/>jsonic-char    : CHAR-TOK<br/>jsonic-sexp    : SEXP-TOK
</div><div class="highlight" form="false" id="a_5vnS4j"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre>#lang brag
jsonic-program : (jsonic-char | jsonic-sexp)*
jsonic-char    : CHAR-TOK
jsonic-sexp    : SEXP-TOK
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkk" data-clipboard-target="#code_62" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div anchorize="false" style="height:2em"></div><ul class="siblinks"><li><a href="intro.html">1&emsp;intro</a></li><li><a href="specification.html">2&emsp;spec­i­fi­ca­tion</a></li><li><a href="setup.html">3&emsp;setup</a></li><li><a href="the-reader.html">4&emsp;the reader</a></li><li><a href="the-tokenizer.html">5&emsp;the tok­enizer</a></li><li><a class="here" href="the-parser.html">6&emsp;the parser</a></li><li><a href="the-expander.html">7&emsp;the expander</a></li><li><a href="testing-the-language.html">8&emsp;test­ing the lan­guage</a></li><li><a href="recap.html">9&emsp;recap</a></li><li><a href="source-listing.html">10&emsp;source list­ing</a></li></ul></div>
    <a class="nav-left" href="the-tokenizer.html">← prev</a>
    <a class="nav-right" href="the-expander.html">next →</a>




</body>

<script type="text/javascript">



function show_all_forms() {
 var elems = document.getElementsByClassName('has_form');
 for (var i = 0 ; i < elems.length ; i++) {
  toggle_form(elems[i].id);
 }
}

// for debugging forms only: uncomment next line
// show_all_forms();

// sets up copy-to-clipboard buttons in code boxes
var clipboard = new Clipboard('.copy-button');
clipboard.on('success', function(e) {console.log(e);});
clipboard.on('error', function(e) {console.log(e);});
</script>