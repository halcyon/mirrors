<!DOCTYPE html>
<html>
  
<!-- Mirrored from beautifulracket.com/basic-2/conditionals.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 16 Mar 2017 05:48:11 GMT -->
<head>
    <meta charset="UTF-8">
    <title>Beautiful Racket: Into the rapids: more basic</title>
    <link rel="stylesheet" type="text/css" media="all" href="../styles.css"/>
    <script type="text/javascript" src="../functions.js"></script>
    <script type="text/javascript" src="../clipboard.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-74684045-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>
<body>
<div id="alert">Thank you for your comment</div>
    <div id="doc"><h3 class="dept" anchorize="false"><a href="../index.html">Beau­ti­ful Racket</a> / <a href="../index.html#tutorials">tuto­ri­als</a></h3><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;into-the-rapids-more-basic&quot;)"></div><h1 anchor="into-the-rapids-more-basic" id="into-the-rapids-more-basic" hyphens="none">Into the rapids: more <span class="my-code" decode="exclude">basic</span></h1></div><ul class="siblinks"><li><a href="intro.html">1&emsp;intro</a></li><li><a href="specification-and-setup.html">2&emsp;spec­i­fi­ca­tion and setup</a></li><li><a href="the-syntax-colorer.html">3&emsp;the syn­tax col­orer</a></li><li><a href="better-line-errors.html">4&emsp;bet­ter line errors</a></li><li><a href="variables-and-input.html">5&emsp;vari­ables and input</a></li><li><a href="expressions.html">6&emsp;expres­sions</a></li><li><a class="here" href="conditionals.html">7&emsp;con­di­tion­als</a></li><li><a href="subroutines-and-loops.html">8&emsp;sub­rou­tines and loops</a></li><li><a href="recap.html">9&emsp;recap</a></li><li><a href="source-listing.html">10&emsp;source list­ing</a></li></ul><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_iWN1d&quot;)"></div><p id="a_iWN1d">Hav­ing done the heavy lift­ing in <a href="expressions.html">expres­sions</a>, adding con­di­tion­als will seem like a vaca­tion.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_djtJo&quot;)"></div><p id="a_djtJo">We want to sup­port two new BASIC ele­ments:</p></div><ol><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_CbtoL&quot;)"></div><p id="a_CbtoL">Boolean expres­sions, using the rela­tional oper­a­tors <span class="my-code" decode="exclude">&lt;</span> <span class="my-code" decode="exclude">&gt;</span> <span class="my-code" decode="exclude">=</span> and <span class="my-code" decode="exclude">&lt;&gt;</span> (mean­ing “not equal”) and the logic oper­a­tors <span class="my-code" decode="exclude">and</span> <span class="my-code" decode="exclude">or</span> and <span class="my-code" decode="exclude">not</span>. In BASIC, every Boolean expres­sion eval­u­ates to <span class="my-code" decode="exclude">0</span> (denot­ing false) or <span class="my-code" decode="exclude">1</span> (denot­ing true).</p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_3xaEX&quot;)"></div><p id="a_3xaEX">The <span class="my-code" decode="exclude">if</span> state­ment tests a con­di­tion, which is a Boolean expres­sion. If the con­di­tion is true, we exe­cute the state­ment after <span class="my-code" decode="exclude">then</span>, oth­er­wise the state­ment after <span class="my-code" decode="exclude">else</span>. If there is no <span class="my-code" decode="exclude">else</span> state­ment, the pro­gram con­tin­ues to the next line.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_akpci&quot;)"></div><p id="a_akpci">Alter­na­tively, the <span class="my-code" decode="exclude">if</span> con­di­tion can be a numer­i­cal expres­sion, which is treated as false if zero, true oth­er­wise. The <span class="my-code" decode="exclude">then</span> and <span class="my-code" decode="exclude">else</span> state­ments can also be numer­i­cal expres­sions, which are treated as the des­ti­na­tion of a <span class="my-code" decode="exclude">goto</span>.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_PU3Uw&quot;)"></div><div class="highlight-container" id="a_PU3Uw"><div id="code_43" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang basic-demo-2<br/>10 x = 3<br/>20 if x &gt; 0 then print x else 5 * 10<br/>30 x = x - 1<br/>40 goto 20<br/>50 print "done"</div><div class="highlight" form="false" id="a_6uFmi"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="source"><pre>#lang basic-demo-2
<span class="nl">10</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">3</span>
<span class="nl">20</span><span class="w"> </span><span class="vg">if</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">0</span><span class="w"> </span><span class="vg">then</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="vg">else</span><span class="w"> </span><span class="il">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="il">10</span>
<span class="nl">30</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="il">1</span>
<span class="nl">40</span><span class="w"> </span><span class="vg">goto</span><span class="w"> </span><span class="il">20</span>
<span class="nl">50</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="s2">"done"</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk" data-clipboard-target="#code_43" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_Dx7ue&quot;)"></div><div class="highlight-container" id="a_Dx7ue"><div id="code_44" form="false" decode="exclude" style="font-size:0;width:0;height:0">3<br/>2<br/>1<br/>done</div><div class="highlight" form="false" id="a_9YXIG"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre>3
2
1
done
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk1" data-clipboard-target="#code_44" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></li></ol><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_ezwn1&quot;)"></div><p id="a_ezwn1">This tuto­r­ial sec­tion is largely rein­force­ment of things we learned in pre­vi­ous sec­tions. So let’s jump right in to the imple­men­ta­tion.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;lexer-updates&quot;)"></div><h3 anchor="lexer-updates" class="subhead" id="lexer-updates"><a href="#lexer-updates">Lexer updates</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_NF9oI&quot;)"></div><p id="a_NF9oI">As we have before, we start by updat­ing <span class="my-code" decode="exclude">"lexer.rkt"</span> to rec­og­nize the new tokens. To the <span class="my-code" decode="exclude">reserved-terms</span> list we add <span class="my-code" decode="exclude">if</span>, <span class="my-code" decode="exclude">then</span>, and <span class="my-code" decode="exclude">else</span>; our new rela­tional oper­a­tors (<span class="my-code" decode="exclude">&lt;</span>, <span class="my-code" decode="exclude">&gt;</span>, and <span class="my-code" decode="exclude">&lt;&gt;</span>); plus <span class="my-code" decode="exclude">and</span>, <span class="my-code" decode="exclude">or</span>, and <span class="my-code" decode="exclude">not</span>. <span class="my-code" decode="exclude">=</span> is also a rela­tional oper­a­tor, but it’s already included on our <span class="my-code" decode="exclude">reserved-terms</span> list (because of its exist­ing role as an assign­ment oper­a­tor):</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">basic/lexer.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_PhvnY&quot;)"></div><div class="highlight-container" id="a_PhvnY"><div id="code_45" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br<br/>(require brag/support)<br/><br/>(define-lex-abbrev digits (:+ (char-set "0123456789")))<br/><br/>(define-lex-abbrev reserved-terms (:or "print" "goto" "end" "+"<br/>":" ";" "let" "=" "input" "-" "*" "/" "^" "mod" "(" ")" "if"<br/>"then" "else" "&lt;" "&gt;" "&lt;&gt;" "and" "or" "not"))<br/><br/>(define basic-lexer<br/>  (lexer-srcloc<br/>   [(eof) (return-without-srcloc eof)]<br/>   ["\n" (token 'NEWLINE lexeme)]<br/>   [whitespace (token lexeme #:skip? #t)]<br/>   [(from/stop-before "rem" "\n") (token 'REM lexeme)]<br/>   [reserved-terms (token lexeme lexeme)]<br/>   [(:seq alphabetic (:* (:or alphabetic numeric "$")))<br/>    (token 'ID (string-&gt;symbol lexeme))]<br/>   [digits (token 'INTEGER (string-&gt;number lexeme))]<br/>   [(:or (:seq (:? digits) "." digits)<br/>         (:seq digits "."))<br/>    (token 'DECIMAL (string-&gt;number lexeme))]<br/>   [(:or (from/to "\"" "\"") (from/to "'" "'"))<br/>    (token 'STRING<br/>           (substring lexeme<br/>                      1 (sub1 (string-length lexeme))))]))<br/><br/>(provide basic-lexer)</div><div class="highlight" form="false" id="a_fj32O"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">brag/support</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._define-lex-abbrev))" class="docs" hyphens="none">define-lex-abbrev</a></span> <span class="n">digits</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._~3a+))" class="docs" hyphens="none">:+</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._char-set))" class="docs" hyphens="none">char-set</a></span> <span class="s2">"0123456789"</span><span class="p">)))</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._define-lex-abbrev))" class="docs" hyphens="none">define-lex-abbrev</a></span> <span class="n">reserved-terms</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._~3aor))" class="docs" hyphens="none">:or</a></span> <span class="s2">"print"</span> <span class="s2">"goto"</span> <span class="s2">"end"</span> <span class="s2">"+"</span>
<span class="hll"><span class="s2">":"</span> <span class="s2">";"</span> <span class="s2">"let"</span> <span class="s2">"="</span> <span class="s2">"input"</span> <span class="s2">"-"</span> <span class="s2">"*"</span> <span class="s2">"/"</span> <span class="s2">"^"</span> <span class="s2">"mod"</span> <span class="s2">"("</span> <span class="s2">")"</span> <span class="s2">"if"</span>
</span><span class="hll"><span class="s2">"then"</span> <span class="s2">"else"</span> <span class="s2">"&lt;"</span> <span class="s2">"&gt;"</span> <span class="s2">"&lt;&gt;"</span> <span class="s2">"and"</span> <span class="s2">"or"</span> <span class="s2">"not"</span><span class="p">))</span>
</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">basic-lexer</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexer-srcloc))" class="docs" hyphens="none">lexer-srcloc</a></span>
   <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/port-ops.html#(def._((quote._~23~25kernel)._eof))" class="docs" hyphens="none">eof</a></span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._return-without-srcloc))" class="docs" hyphens="none">return-without-srcloc</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/port-ops.html#(def._((quote._~23~25kernel)._eof))" class="docs" hyphens="none">eof</a></span><span class="p">)]</span>
   <span class="p">[</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._token))" class="docs" hyphens="none">token</a></span> <span class="o">&#39;</span><span class="ss">NEWLINE</span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexeme))" class="docs" hyphens="none">lexeme</a></span><span class="p">)]</span>
   <span class="p">[</span><span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._whitespace))" class="docs" hyphens="none">whitespace</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._token))" class="docs" hyphens="none">token</a></span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexeme))" class="docs" hyphens="none">lexeme</a></span> <span class="kd">#:skip?</span> <span class="no">#t</span><span class="p">)]</span>
   <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._from/stop-before))" class="docs" hyphens="none">from/stop-before</a></span> <span class="s2">"rem"</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._token))" class="docs" hyphens="none">token</a></span> <span class="o">&#39;</span><span class="ss">REM</span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexeme))" class="docs" hyphens="none">lexeme</a></span><span class="p">)]</span>
   <span class="p">[</span><span class="n">reserved-terms</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._token))" class="docs" hyphens="none">token</a></span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexeme))" class="docs" hyphens="none">lexeme</a></span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexeme))" class="docs" hyphens="none">lexeme</a></span><span class="p">)]</span>
   <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._~3aseq))" class="docs" hyphens="none">:seq</a></span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._alphabetic))" class="docs" hyphens="none">alphabetic</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._~3a*))" class="docs" hyphens="none">:*</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._~3aor))" class="docs" hyphens="none">:or</a></span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._alphabetic))" class="docs" hyphens="none">alphabetic</a></span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._numeric))" class="docs" hyphens="none">numeric</a></span> <span class="s2">"$"</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._token))" class="docs" hyphens="none">token</a></span> <span class="o">&#39;</span><span class="ss">ID</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/symbols.html#(def._((quote._~23~25kernel)._string-~3esymbol))" class="docs" hyphens="none">string-&gt;symbol</a></span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexeme))" class="docs" hyphens="none">lexeme</a></span><span class="p">))]</span>
   <span class="p">[</span><span class="n">digits</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._token))" class="docs" hyphens="none">token</a></span> <span class="o">&#39;</span><span class="ss">INTEGER</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._string-~3enumber))" class="docs" hyphens="none">string-&gt;number</a></span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexeme))" class="docs" hyphens="none">lexeme</a></span><span class="p">))]</span>
   <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._~3aor))" class="docs" hyphens="none">:or</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._~3aseq))" class="docs" hyphens="none">:seq</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._~3a~3f))" class="docs" hyphens="none">:?</a></span> <span class="n">digits</span><span class="p">)</span> <span class="s2">"."</span> <span class="n">digits</span><span class="p">)</span>
         <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._~3aseq))" class="docs" hyphens="none">:seq</a></span> <span class="n">digits</span> <span class="s2">"."</span><span class="p">))</span>
    <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._token))" class="docs" hyphens="none">token</a></span> <span class="o">&#39;</span><span class="ss">DECIMAL</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._string-~3enumber))" class="docs" hyphens="none">string-&gt;number</a></span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexeme))" class="docs" hyphens="none">lexeme</a></span><span class="p">))]</span>
   <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._~3aor))" class="docs" hyphens="none">:or</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._from/to))" class="docs" hyphens="none">from/to</a></span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(form._((lib._brag/support..rkt)._from/to))" class="docs" hyphens="none">from/to</a></span> <span class="s2">"&#39;"</span> <span class="s2">"&#39;"</span><span class="p">))</span>
    <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/brag/index.html#(def._((lib._brag/support..rkt)._token))" class="docs" hyphens="none">token</a></span> <span class="o">&#39;</span><span class="ss">STRING</span>
           <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/strings.html#(def._((quote._~23~25kernel)._substring))" class="docs" hyphens="none">substring</a></span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexeme))" class="docs" hyphens="none">lexeme</a></span>
                      <span class="mi">1</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._sub1))" class="docs" hyphens="none">sub1</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/strings.html#(def._((quote._~23~25kernel)._string-length))" class="docs" hyphens="none">string-length</a></span> <span class="nb"><a href="http://docs.racket-lang.org/br-parser-tools/Lexers.html#(form._((lib._br-parser-tools/lex..rkt)._lexeme))" class="docs" hyphens="none">lexeme</a></span><span class="p">))))]))</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._provide))" class="docs" hyphens="none">provide</a></span> <span class="n">basic-lexer</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk2" data-clipboard-target="#code_45" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;parser-updates&quot;)"></div><h3 anchor="parser-updates" class="subhead" id="parser-updates"><a href="#parser-updates">Parser updates</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_LFUDD&quot;)"></div><p id="a_LFUDD">Next we add the new parser rules.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_fWtW8&quot;)"></div><p id="a_fWtW8">First, we need a <span class="my-code" decode="exclude">b-if</span> rule to han­dle the <span class="my-code" decode="exclude">if</span> state­ment, with a manda­tory <span class="my-code" decode="exclude">then</span> clause and an optional <span class="my-code" decode="exclude">else</span>. We can have either a state­ment or an expres­sion after the <span class="my-code" decode="exclude">then</span> and <span class="my-code" decode="exclude">else</span>, so our whole rule will look like this:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_9xjsr&quot;)"></div><div class="highlight-container" id="a_9xjsr"><div id="code_46" form="false" decode="exclude" style="font-size:0;width:0;height:0">b-if : /"if" b-expr /"then" (b-statement | b-expr)<br/>                   [/"else" (b-statement | b-expr)]</div><div class="highlight" form="false" id="a_1lnsi"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="source"><pre>b-if : /"if" b-expr /"then" (b-statement | b-expr)
                   [/"else" (b-statement | b-expr)]
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk3" data-clipboard-target="#code_46" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_aqp6B&quot;)"></div><p id="a_aqp6B">We also add <span class="my-code" decode="exclude">b-if</span> as one of the choices for our <span class="my-code" decode="exclude">b-statement</span> rule.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_qVbks&quot;)"></div><p id="a_qVbks">Then we need rules for our log­i­cal oper­a­tors. Just like the oper­a­tors in math­e­mat­i­cal <a href="expressions.html">expres­sions</a>, log­i­cal oper­a­tors are ranked from low­est to high­est prece­dence:</p></div><ol><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_jKqBt&quot;)"></div><p id="a_jKqBt"><span class="my-code" decode="exclude">or</span></p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_tKES4&quot;)"></div><p id="a_tKES4"><span class="my-code" decode="exclude">and</span></p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_IsgLx&quot;)"></div><p id="a_IsgLx"><span class="my-code" decode="exclude">not</span></p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_NAfVx&quot;)"></div><p id="a_NAfVx">The rela­tional oper­a­tors (<span class="my-code" decode="exclude">&lt;</span> <span class="my-code" decode="exclude">&gt;</span> <span class="my-code" decode="exclude">=</span> and <span class="my-code" decode="exclude">&lt;&gt;</span>)</p></div></li></ol><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_9iYnI&quot;)"></div><p id="a_9iYnI">After that, all the math­e­mat­i­cal oper­a­tors have higher prece­dence than the rela­tional oper­a­tors.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_6T6wZ&quot;)"></div><p id="a_6T6wZ">We already know how to enforce prec­dence—by chain­ing together parser rules. So we insert our log­i­cal oper­a­tors into the exist­ing tower of prece­dence:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">basic/parser.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_bpNSl&quot;)"></div><div class="highlight-container" id="a_bpNSl"><div id="code_47" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang brag<br/>b-program : [b-line] (/NEWLINE [b-line])*<br/>b-line : b-line-num [b-statement] (/":" [b-statement])* [b-rem]<br/>@b-line-num : INTEGER<br/>@b-statement : b-end | b-print | b-goto<br/>             | b-let | b-input | b-if<br/>b-rem : REM<br/>b-end : /"end"<br/>b-print : /"print" [b-printable] (/";" [b-printable])*<br/>@b-printable : STRING | b-expr<br/>b-goto : /"goto" b-expr<br/>b-let : [/"let"] b-id /"=" (b-expr | STRING)<br/>b-if : /"if" b-expr /"then" (b-statement | b-expr)<br/>                   [/"else" (b-statement | b-expr)]<br/>b-input : /"input" b-id<br/>@b-id : ID<br/>b-expr : b-or-expr<br/>b-or-expr : [b-or-expr "or"] b-and-expr<br/>b-and-expr : [b-and-expr "and"] b-not-expr<br/>b-not-expr : ["not"] b-comp-expr<br/>b-comp-expr : [b-comp-expr ("="|"&lt;"|"&gt;"|"&lt;&gt;")] b-sum<br/>b-sum : [b-sum ("+"|"-")] b-product<br/>b-product : [b-product ("*"|"/"|"mod")] b-neg<br/>b-neg : ["-"] b-expt<br/>b-expt : [b-expt ("^")] b-value<br/>@b-value : b-number | b-id | /"(" b-expr /")"<br/>@b-number : INTEGER | DECIMAL</div><div class="highlight" form="false" id="a_uPA3b"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="source"><pre>#lang brag
b-program : [b-line] (/NEWLINE [b-line])*
b-line : b-line-num [b-statement] (/":" [b-statement])* [b-rem]
@b-line-num : INTEGER
<span class="hll">@b-statement : b-end | b-print | b-goto
</span><span class="hll">             | b-let | b-input | b-if
</span>b-rem : REM
b-end : /"end"
b-print : /"print" [b-printable] (/";" [b-printable])*
@b-printable : STRING | b-expr
b-goto : /"goto" b-expr
b-let : [/"let"] b-id /"=" (b-expr | STRING)
<span class="hll">b-if : /"if" b-expr /"then" (b-statement | b-expr)
</span><span class="hll">                   [/"else" (b-statement | b-expr)]
</span>b-input : /"input" b-id
@b-id : ID
b-expr : b-or-expr
<span class="hll">b-or-expr : [b-or-expr "or"] b-and-expr
</span><span class="hll">b-and-expr : [b-and-expr "and"] b-not-expr
</span><span class="hll">b-not-expr : ["not"] b-comp-expr
</span><span class="hll">b-comp-expr : [b-comp-expr ("="|"&lt;"|"&gt;"|"&lt;&gt;")] b-sum
</span>b-sum : [b-sum ("+"|"-")] b-product
b-product : [b-product ("*"|"/"|"mod")] b-neg
b-neg : ["-"] b-expt
b-expt : [b-expt ("^")] b-value
@b-value : b-number | b-id | /"(" b-expr /")"
@b-number : INTEGER | DECIMAL
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk4" data-clipboard-target="#code_47" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_ad7NH&quot;)"></div><p id="a_ad7NH">Between <span class="my-code" decode="exclude">b-expr</span> and <span class="my-code" decode="exclude">b-sum</span> we’ve inserted four rules for our log­i­cal oper­a­tors, so that they have lower prece­dence than the exist­ing math­e­mat­i­cal oper­a­tors.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_jvPNf&quot;)"></div><p id="a_jvPNf">For the rules them­selves, we fol­low the same pat­tern that we used before, where the left ele­ment in each pat­tern is a recur­sive ref­er­ence to the rule (thus enforc­ing left-to-right eval­u­a­tion) and the right ele­ment chains to the next rule (thus enforc­ing prece­dence). The excep­tion is <span class="my-code" decode="exclude">b-not-expr</span>, because like <span class="my-code" decode="exclude">b-neg</span>, it only takes one argu­ment.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_qvro7&quot;)"></div><p id="a_qvro7">Because our rela­tional oper­a­tors all have the same prece­dence, we han­dle them with a sin­gle <span class="my-code" decode="exclude">b-comp-expr</span> rule (sim­i­lar to what we did with <span class="my-code" decode="exclude">b-sum</span> and <span class="my-code" decode="exclude">b-product</span>).</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;expander-updates&quot;)"></div><h3 anchor="expander-updates" class="subhead" id="expander-updates"><a href="#expander-updates">Expander updates</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_hU4bZ&quot;)"></div><p id="a_hU4bZ">We’ll start a new mod­ule called <span class="my-code" decode="exclude">"cond.rkt"</span> to hold our expander imple­men­ta­tion for con­di­tion­als. Let’s first update our <span class="my-code" decode="exclude">"elements.rkt"</span> so it picks up this new mod­ule:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">basic/elements.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_OxYKD&quot;)"></div><div class="highlight-container" id="a_OxYKD"><div id="code_48" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br<br/>(require "line.rkt" "go.rkt"<br/>         "expr.rkt" "misc.rkt" "cond.rkt")<br/>(provide<br/> (all-from-out "line.rkt" "go.rkt"<br/>               "expr.rkt" "misc.rkt" "cond.rkt"))</div><div class="highlight" form="false" id="a_H1xSh"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br</span>
<span class="hll"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="s2">"line.rkt"</span> <span class="s2">"go.rkt"</span>
</span>         <span class="s2">"expr.rkt"</span> <span class="s2">"misc.rkt"</span> <span class="s2">"cond.rkt"</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._provide))" class="docs" hyphens="none">provide</a></span>
<span class="hll"> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._all-from-out))" class="docs" hyphens="none">all-from-out</a></span> <span class="s2">"line.rkt"</span> <span class="s2">"go.rkt"</span>
</span>               <span class="s2">"expr.rkt"</span> <span class="s2">"misc.rkt"</span> <span class="s2">"cond.rkt"</span><span class="p">))</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk5" data-clipboard-target="#code_48" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_Zfipj&quot;)"></div><p id="a_Zfipj">Then we can start <span class="my-code" decode="exclude">"cond.rkt"</span> itself. First we make macros cor­re­spond­ing to the parser rules for our log­i­cal oper­a­tors:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">basic/cond.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_bFDFQ&quot;)"></div><div class="highlight-container" id="a_bFDFQ"><div id="code_49" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br<br/>(require "go.rkt")<br/>(provide b-if b-or-expr b-and-expr b-not-expr b-comp-expr)<br/><br/>(define (bool-&gt;int val) (if val 1 0))<br/>(define nonzero? (compose1 not zero?))<br/><br/>(define-macro-cases b-or-expr<br/>  [(_ VAL) #'VAL]<br/>  [(_ LEFT "or" RIGHT)<br/>   #'(bool-&gt;int (or (nonzero? LEFT) (nonzero? RIGHT)))])<br/><br/>(define-macro-cases b-and-expr<br/>  [(_ VAL) #'VAL]<br/>  [(_ LEFT "and" RIGHT)<br/>   #'(bool-&gt;int (and (nonzero? LEFT) (nonzero? RIGHT)))])<br/><br/>(define-macro-cases b-not-expr<br/>  [(_ VAL) #'VAL]<br/>  [(_ "not" VAL) #'(if (nonzero? VAL) 0 1)])</div><div class="highlight" form="false" id="a_8gAKo"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="s2">"go.rkt"</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._provide))" class="docs" hyphens="none">provide</a></span> <span class="n">b-if</span> <span class="n">b-or-expr</span> <span class="n">b-and-expr</span> <span class="n">b-not-expr</span> <span class="n">b-comp-expr</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">bool-&gt;int</span> <span class="n">val</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((quote._~23~25kernel)._if))" class="docs" hyphens="none">if</a></span> <span class="n">val</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">nonzero?</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._not))" class="docs" hyphens="none">not</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._zero~3f))" class="docs" hyphens="none">zero?</a></span><span class="p">))</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-or-expr</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">VAL</span><span class="p">)</span> <span class="o">#&#39;</span><span class="n">VAL</span><span class="p">]</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">LEFT</span> <span class="s2">"or"</span> <span class="n">RIGHT</span><span class="p">)</span>
   <span class="o">#&#39;</span><span class="p">(</span><span class="n">bool-&gt;int</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._or))" class="docs" hyphens="none">or</a></span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">LEFT</span><span class="p">)</span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">RIGHT</span><span class="p">)))])</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-and-expr</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">VAL</span><span class="p">)</span> <span class="o">#&#39;</span><span class="n">VAL</span><span class="p">]</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">LEFT</span> <span class="s2">"and"</span> <span class="n">RIGHT</span><span class="p">)</span>
   <span class="o">#&#39;</span><span class="p">(</span><span class="n">bool-&gt;int</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._and))" class="docs" hyphens="none">and</a></span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">LEFT</span><span class="p">)</span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">RIGHT</span><span class="p">)))])</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-not-expr</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">VAL</span><span class="p">)</span> <span class="o">#&#39;</span><span class="n">VAL</span><span class="p">]</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="s2">"not"</span> <span class="n">VAL</span><span class="p">)</span> <span class="o">#&#39;</span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((quote._~23~25kernel)._if))" class="docs" hyphens="none">if</a></span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">VAL</span><span class="p">)</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)])</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk6" data-clipboard-target="#code_49" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_bQDtX&quot;)"></div><p id="a_bQDtX">Because BASIC Boolean expres­sions work in terms of nonzero-or-zero rather than true-or-false, we cre­ate a <span class="my-code" decode="exclude">nonzero?</span> pred­i­cate to test our con­di­tions. The <a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a> func­tion is com­mon Racket short­hand for com­bin­ing mul­ti­ple func­tions into one, so these expres­sions are equiv­a­lent:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_S7zDK&quot;)"></div><div class="highlight-container" id="a_S7zDK"><div id="code_50" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define (nonzero? x) (not (zero? x)))<br/>(define nonzero? (compose1 not zero?))</div><div class="highlight" form="false" id="a_fpScp"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._not))" class="docs" hyphens="none">not</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._zero~3f))" class="docs" hyphens="none">zero?</a></span> <span class="n">x</span><span class="p">)))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">nonzero?</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._not))" class="docs" hyphens="none">not</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._zero~3f))" class="docs" hyphens="none">zero?</a></span><span class="p">))</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk7" data-clipboard-target="#code_50" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_87kkw&quot;)"></div><p id="a_87kkw">Con­sis­tent with BASIC pro­to­col, we also use a <span class="my-code" decode="exclude">bool-&gt;int</span> func­tion to con­vert the Racket result of these oper­a­tions, which will be <span class="my-code" decode="exclude">#f</span> or some­thing else, to a sim­ple <span class="my-code" decode="exclude">0</span> or <span class="my-code" decode="exclude">1</span> value.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_EVfMn&quot;)"></div><p id="a_EVfMn">Next we add the rela­tional oper­a­tors:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">basic/cond.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_AiA6Q&quot;)"></div><div class="highlight-container" id="a_AiA6Q"><div id="code_51" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br<br/>(require "go.rkt")<br/>(provide b-if b-or-expr b-and-expr b-not-expr b-comp-expr)<br/><br/>(define (bool-&gt;int val) (if val 1 0))<br/>(define nonzero? (compose1 not zero?))<br/><br/>(define-macro-cases b-or-expr ···)<br/>(define-macro-cases b-and-expr ···)<br/>(define-macro-cases b-not-expr ···)<br/><br/>(define b= (compose1 bool-&gt;int =))<br/>(define b&lt; (compose1 bool-&gt;int &lt;))<br/>(define b&gt; (compose1 bool-&gt;int &gt;))<br/>(define b&lt;&gt; (compose1 bool-&gt;int not =))<br/><br/>(define-macro-cases b-comp-expr<br/>  [(_ VAL) #'VAL]<br/>  [(_ LEFT "=" RIGHT) #'(b= LEFT RIGHT)]<br/>  [(_ LEFT "&lt;" RIGHT) #'(b&lt; LEFT RIGHT)]<br/>  [(_ LEFT "&gt;" RIGHT) #'(b&gt; LEFT RIGHT)]<br/>  [(_ LEFT "&lt;&gt;" RIGHT) #'(b&lt;&gt; LEFT RIGHT)])</div><div class="highlight" form="false" id="a_bNKNv"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="s2">"go.rkt"</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._provide))" class="docs" hyphens="none">provide</a></span> <span class="n">b-if</span> <span class="n">b-or-expr</span> <span class="n">b-and-expr</span> <span class="n">b-not-expr</span> <span class="n">b-comp-expr</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">bool-&gt;int</span> <span class="n">val</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((quote._~23~25kernel)._if))" class="docs" hyphens="none">if</a></span> <span class="n">val</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">nonzero?</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._not))" class="docs" hyphens="none">not</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._zero~3f))" class="docs" hyphens="none">zero?</a></span><span class="p">))</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-or-expr</span> <span class="n">···</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-and-expr</span> <span class="n">···</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-not-expr</span> <span class="n">···</span><span class="p">)</span>

<span class="hll"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">b=</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="n">bool-&gt;int</span> <span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" class="docs" hyphens="none">=</a></span><span class="p">))</span>
</span><span class="hll"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">b&lt;</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="n">bool-&gt;int</span> <span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3c))" class="docs" hyphens="none">&lt;</a></span><span class="p">))</span>
</span><span class="hll"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">b&gt;</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="n">bool-&gt;int</span> <span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3e))" class="docs" hyphens="none">&gt;</a></span><span class="p">))</span>
</span><span class="hll"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">b&lt;&gt;</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="n">bool-&gt;int</span> <span class="nb"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._not))" class="docs" hyphens="none">not</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" class="docs" hyphens="none">=</a></span><span class="p">))</span>
</span><span class="hll">
</span><span class="hll"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-comp-expr</span>
</span><span class="hll">  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">VAL</span><span class="p">)</span> <span class="o">#&#39;</span><span class="n">VAL</span><span class="p">]</span>
</span><span class="hll">  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">LEFT</span> <span class="s2">"="</span> <span class="n">RIGHT</span><span class="p">)</span> <span class="o">#&#39;</span><span class="p">(</span><span class="n">b=</span> <span class="n">LEFT</span> <span class="n">RIGHT</span><span class="p">)]</span>
</span><span class="hll">  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">LEFT</span> <span class="s2">"&lt;"</span> <span class="n">RIGHT</span><span class="p">)</span> <span class="o">#&#39;</span><span class="p">(</span><span class="n">b&lt;</span> <span class="n">LEFT</span> <span class="n">RIGHT</span><span class="p">)]</span>
</span><span class="hll">  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">LEFT</span> <span class="s2">"&gt;"</span> <span class="n">RIGHT</span><span class="p">)</span> <span class="o">#&#39;</span><span class="p">(</span><span class="n">b&gt;</span> <span class="n">LEFT</span> <span class="n">RIGHT</span><span class="p">)]</span>
</span><span class="hll">  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">LEFT</span> <span class="s2">"&lt;&gt;"</span> <span class="n">RIGHT</span><span class="p">)</span> <span class="o">#&#39;</span><span class="p">(</span><span class="n">b&lt;&gt;</span> <span class="n">LEFT</span> <span class="n">RIGHT</span><span class="p">)])</span>
</span></pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk8" data-clipboard-target="#code_51" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_qezHC&quot;)"></div><p id="a_qezHC">We cre­ate our BASIC rela­tional oper­a­tors by com­pos­ing them with our exist­ing <span class="my-code" decode="exclude">bool-&gt;int</span> helper func­tion and then the stan­dard Racket ver­sion of ther oper­a­tor. Our <span class="my-code" decode="exclude">b-comp-expr</span> macro dis­patches to the right oper­a­tor.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_VH24T&quot;)"></div><p id="a_VH24T">We fin­ish off by adding a macro for <span class="my-code" decode="exclude">b-if</span>:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">basic/cond.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_XQDg7&quot;)"></div><div class="highlight-container" id="a_XQDg7"><div id="code_52" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br<br/>(require "go.rkt")<br/>(provide b-if b-or-expr b-and-expr b-not-expr b-comp-expr)<br/><br/>(define (bool-&gt;int val) (if val 1 0))<br/>(define nonzero? (compose1 not zero?))<br/><br/>(define-macro-cases b-or-expr ···)<br/>(define-macro-cases b-and-expr ···)<br/>(define-macro-cases b-not-expr ···)<br/><br/>(define b= ···)<br/>(define b&lt; ···)<br/>(define b&gt; ···)<br/>(define b&lt;&gt; ···)<br/><br/>(define-macro-cases b-comp-expr ···)<br/><br/>(define-macro-cases b-if<br/>  [(_ COND-EXPR THEN-EXPR) #'(b-if COND-EXPR THEN-EXPR (void))]<br/>  [(_ COND-EXPR THEN-EXPR ELSE-EXPR)<br/>   #'(let ([result (if (nonzero? COND-EXPR)<br/>                       THEN-EXPR<br/>                       ELSE-EXPR)])<br/>       (when (exact-positive-integer? result)<br/>         (b-goto result)))])</div><div class="highlight" form="false" id="a_Avk6T"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="s2">"go.rkt"</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._provide))" class="docs" hyphens="none">provide</a></span> <span class="n">b-if</span> <span class="n">b-or-expr</span> <span class="n">b-and-expr</span> <span class="n">b-not-expr</span> <span class="n">b-comp-expr</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">bool-&gt;int</span> <span class="n">val</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((quote._~23~25kernel)._if))" class="docs" hyphens="none">if</a></span> <span class="n">val</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">nonzero?</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._not))" class="docs" hyphens="none">not</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._zero~3f))" class="docs" hyphens="none">zero?</a></span><span class="p">))</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-or-expr</span> <span class="n">···</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-and-expr</span> <span class="n">···</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-not-expr</span> <span class="n">···</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">b=</span> <span class="n">···</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">b&lt;</span> <span class="n">···</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">b&gt;</span> <span class="n">···</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">b&lt;&gt;</span> <span class="n">···</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-comp-expr</span> <span class="n">···</span><span class="p">)</span>

<span class="hll"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-if</span>
</span><span class="hll">  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">COND-EXPR</span> <span class="n">THEN-EXPR</span><span class="p">)</span> <span class="o">#&#39;</span><span class="p">(</span><span class="n">b-if</span> <span class="n">COND-EXPR</span> <span class="n">THEN-EXPR</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/void.html#(def._((quote._~23~25kernel)._void))" class="docs" hyphens="none">void</a></span><span class="p">))]</span>
</span><span class="hll">  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">COND-EXPR</span> <span class="n">THEN-EXPR</span> <span class="n">ELSE-EXPR</span><span class="p">)</span>
</span><span class="hll">   <span class="o">#&#39;</span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))" class="docs" hyphens="none">let</a></span> <span class="p">([</span><span class="n">result</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((quote._~23~25kernel)._if))" class="docs" hyphens="none">if</a></span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">COND-EXPR</span><span class="p">)</span>
</span><span class="hll">                       <span class="n">THEN-EXPR</span>
</span><span class="hll">                       <span class="n">ELSE-EXPR</span><span class="p">)])</span>
</span><span class="hll">       <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/when_unless.html#(form._((lib._racket/private/letstx-scheme..rkt)._when))" class="docs" hyphens="none">when</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._exact-positive-integer~3f))" class="docs" hyphens="none">exact-positive-integer?</a></span> <span class="n">result</span><span class="p">)</span>
</span><span class="hll">         <span class="p">(</span><span class="n">b-goto</span> <span class="n">result</span><span class="p">)))])</span>
</span></pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk9" data-clipboard-target="#code_52" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_SfgK4&quot;)"></div><p id="a_SfgK4">The first case of the <span class="my-code" decode="exclude">b-if</span> macro han­dles the sit­u­a­tion when <span class="my-code" decode="exclude">ELSE-EXPR</span> is omit­ted by adding <span class="my-code" decode="exclude">(void)</span> call­ing <span class="my-code" decode="exclude">b-if</span> again. At that point it will match the sec­ond case.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_MuXgC&quot;)"></div><p id="a_MuXgC">As we did above, we use <span class="my-code" decode="exclude">nonzero?</span> to test our con­di­tion. We know from our parser rules that <span class="my-code" decode="exclude">THEN-EXPR</span> or <span class="my-code" decode="exclude">ELSE-EXPR</span> might be a state­ment or a numer­i­cal expres­sion, in which case it should be treated as a <span class="my-code" decode="exclude">goto</span>. We han­dle this by check­ing whether <span class="my-code" decode="exclude">result</span> is an <a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._exact-positive-integer~3f))" class="docs" hyphens="none">exact-positive-integer?</a> and if so, pass­ing it to <span class="my-code" decode="exclude">b-goto</span>.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_KnqVb&quot;)"></div><p id="a_KnqVb">The com­pleted <span class="my-code" decode="exclude">"cond.rkt"</span> mod­ule looks like this:</p></div><div class="filebox" anchorize="false"><div class="filename" anchorize="false" decode="exclude">basic/cond.rkt</div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_BPTag&quot;)"></div><div class="highlight-container" id="a_BPTag"><div id="code_53" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang br<br/>(require "go.rkt")<br/>(provide b-if b-or-expr b-and-expr b-not-expr b-comp-expr)<br/><br/>(define (bool-&gt;int val) (if val 1 0))<br/>(define nonzero? (compose1 not zero?))<br/><br/>(define-macro-cases b-or-expr<br/>  [(_ VAL) #'VAL]<br/>  [(_ LEFT "or" RIGHT)<br/>   #'(bool-&gt;int (or (nonzero? LEFT) (nonzero? RIGHT)))])<br/><br/>(define-macro-cases b-and-expr<br/>  [(_ VAL) #'VAL]<br/>  [(_ LEFT "and" RIGHT)<br/>   #'(bool-&gt;int (and (nonzero? LEFT) (nonzero? RIGHT)))])<br/><br/>(define-macro-cases b-not-expr<br/>  [(_ VAL) #'VAL]<br/>  [(_ "not" VAL) #'(if (nonzero? VAL) 0 1)])<br/><br/>(define b= (compose1 bool-&gt;int =))<br/>(define b&lt; (compose1 bool-&gt;int &lt;))<br/>(define b&gt; (compose1 bool-&gt;int &gt;))<br/>(define b&lt;&gt; (compose1 bool-&gt;int not =))<br/><br/>(define-macro-cases b-comp-expr<br/>  [(_ VAL) #'VAL]<br/>  [(_ LEFT "=" RIGHT) #'(b= LEFT RIGHT)]<br/>  [(_ LEFT "&lt;" RIGHT) #'(b&lt; LEFT RIGHT)]<br/>  [(_ LEFT "&gt;" RIGHT) #'(b&gt; LEFT RIGHT)]<br/>  [(_ LEFT "&lt;&gt;" RIGHT) #'(b&lt;&gt; LEFT RIGHT)])<br/><br/>(define-macro-cases b-if<br/>  [(_ COND-EXPR THEN-EXPR) #'(b-if COND-EXPR THEN-EXPR (void))]<br/>  [(_ COND-EXPR THEN-EXPR ELSE-EXPR)<br/>   #'(let ([result (if (nonzero? COND-EXPR)<br/>                       THEN-EXPR<br/>                       ELSE-EXPR)])<br/>       (when (exact-positive-integer? result)<br/>         (b-goto result)))])</div><div class="highlight" form="false" id="a_McYfz"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="source"><pre><span class="kn">#lang </span><span class="nn">br</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="s2">"go.rkt"</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._provide))" class="docs" hyphens="none">provide</a></span> <span class="n">b-if</span> <span class="n">b-or-expr</span> <span class="n">b-and-expr</span> <span class="n">b-not-expr</span> <span class="n">b-comp-expr</span><span class="p">)</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">bool-&gt;int</span> <span class="n">val</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((quote._~23~25kernel)._if))" class="docs" hyphens="none">if</a></span> <span class="n">val</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">nonzero?</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._not))" class="docs" hyphens="none">not</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._zero~3f))" class="docs" hyphens="none">zero?</a></span><span class="p">))</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-or-expr</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">VAL</span><span class="p">)</span> <span class="o">#&#39;</span><span class="n">VAL</span><span class="p">]</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">LEFT</span> <span class="s2">"or"</span> <span class="n">RIGHT</span><span class="p">)</span>
   <span class="o">#&#39;</span><span class="p">(</span><span class="n">bool-&gt;int</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._or))" class="docs" hyphens="none">or</a></span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">LEFT</span><span class="p">)</span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">RIGHT</span><span class="p">)))])</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-and-expr</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">VAL</span><span class="p">)</span> <span class="o">#&#39;</span><span class="n">VAL</span><span class="p">]</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">LEFT</span> <span class="s2">"and"</span> <span class="n">RIGHT</span><span class="p">)</span>
   <span class="o">#&#39;</span><span class="p">(</span><span class="n">bool-&gt;int</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._and))" class="docs" hyphens="none">and</a></span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">LEFT</span><span class="p">)</span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">RIGHT</span><span class="p">)))])</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-not-expr</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">VAL</span><span class="p">)</span> <span class="o">#&#39;</span><span class="n">VAL</span><span class="p">]</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="s2">"not"</span> <span class="n">VAL</span><span class="p">)</span> <span class="o">#&#39;</span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((quote._~23~25kernel)._if))" class="docs" hyphens="none">if</a></span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">VAL</span><span class="p">)</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)])</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">b=</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="n">bool-&gt;int</span> <span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" class="docs" hyphens="none">=</a></span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">b&lt;</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="n">bool-&gt;int</span> <span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3c))" class="docs" hyphens="none">&lt;</a></span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">b&gt;</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="n">bool-&gt;int</span> <span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3e))" class="docs" hyphens="none">&gt;</a></span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">b&lt;&gt;</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((lib._racket/private/list..rkt)._compose1))" class="docs" hyphens="none">compose1</a></span> <span class="n">bool-&gt;int</span> <span class="nb"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._not))" class="docs" hyphens="none">not</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" class="docs" hyphens="none">=</a></span><span class="p">))</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-comp-expr</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">VAL</span><span class="p">)</span> <span class="o">#&#39;</span><span class="n">VAL</span><span class="p">]</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">LEFT</span> <span class="s2">"="</span> <span class="n">RIGHT</span><span class="p">)</span> <span class="o">#&#39;</span><span class="p">(</span><span class="n">b=</span> <span class="n">LEFT</span> <span class="n">RIGHT</span><span class="p">)]</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">LEFT</span> <span class="s2">"&lt;"</span> <span class="n">RIGHT</span><span class="p">)</span> <span class="o">#&#39;</span><span class="p">(</span><span class="n">b&lt;</span> <span class="n">LEFT</span> <span class="n">RIGHT</span><span class="p">)]</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">LEFT</span> <span class="s2">"&gt;"</span> <span class="n">RIGHT</span><span class="p">)</span> <span class="o">#&#39;</span><span class="p">(</span><span class="n">b&gt;</span> <span class="n">LEFT</span> <span class="n">RIGHT</span><span class="p">)]</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">LEFT</span> <span class="s2">"&lt;&gt;"</span> <span class="n">RIGHT</span><span class="p">)</span> <span class="o">#&#39;</span><span class="p">(</span><span class="n">b&lt;&gt;</span> <span class="n">LEFT</span> <span class="n">RIGHT</span><span class="p">)])</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro-cases))" class="docs" hyphens="none">define-macro-cases</a></span> <span class="n">b-if</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">COND-EXPR</span> <span class="n">THEN-EXPR</span><span class="p">)</span> <span class="o">#&#39;</span><span class="p">(</span><span class="n">b-if</span> <span class="n">COND-EXPR</span> <span class="n">THEN-EXPR</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/void.html#(def._((quote._~23~25kernel)._void))" class="docs" hyphens="none">void</a></span><span class="p">))]</span>
  <span class="p">[(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="docs" hyphens="none">_</a></span> <span class="n">COND-EXPR</span> <span class="n">THEN-EXPR</span> <span class="n">ELSE-EXPR</span><span class="p">)</span>
   <span class="o">#&#39;</span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))" class="docs" hyphens="none">let</a></span> <span class="p">([</span><span class="n">result</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((quote._~23~25kernel)._if))" class="docs" hyphens="none">if</a></span> <span class="p">(</span><span class="n">nonzero?</span> <span class="n">COND-EXPR</span><span class="p">)</span>
                       <span class="n">THEN-EXPR</span>
                       <span class="n">ELSE-EXPR</span><span class="p">)])</span>
       <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/when_unless.html#(form._((lib._racket/private/letstx-scheme..rkt)._when))" class="docs" hyphens="none">when</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._exact-positive-integer~3f))" class="docs" hyphens="none">exact-positive-integer?</a></span> <span class="n">result</span><span class="p">)</span>
         <span class="p">(</span><span class="n">b-goto</span> <span class="n">result</span><span class="p">)))])</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpka" data-clipboard-target="#code_53" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;testing-our-conditionals&quot;)"></div><h3 anchor="testing-our-conditionals" class="subhead" id="testing-our-conditionals"><a href="#testing-our-conditionals">Test­ing our con­di­tion­als</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_jkY6K&quot;)"></div><p id="a_jkY6K">With those improve­ments, our <span class="my-code" decode="exclude">#lang basic</span> should now be able to han­dle con­di­tional expres­sions. Let’s start with our orig­i­nal test pro­gram:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_oSVO6&quot;)"></div><div class="highlight-container" id="a_oSVO6"><div id="code_54" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang basic<br/>10 x = 3<br/>20 if x &gt; 0 then print x else 5 * 10<br/>30 x = x - 1<br/>40 goto 20<br/>50 print "done"</div><div class="highlight" form="false" id="a_fHMzN"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="source"><pre>#lang basic
<span class="nl">10</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">3</span>
<span class="nl">20</span><span class="w"> </span><span class="vg">if</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">0</span><span class="w"> </span><span class="vg">then</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="vg">else</span><span class="w"> </span><span class="il">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="il">10</span>
<span class="nl">30</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="il">1</span>
<span class="nl">40</span><span class="w"> </span><span class="vg">goto</span><span class="w"> </span><span class="il">20</span>
<span class="nl">50</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="s2">"done"</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkb" data-clipboard-target="#code_54" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_Dx7uee&quot;)"></div><div class="highlight-container" id="a_Dx7uee"><div id="code_55" form="false" decode="exclude" style="font-size:0;width:0;height:0">3<br/>2<br/>1<br/>done</div><div class="highlight" form="false" id="a_9YXIGc"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre>3
2
1
done
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkd" data-clipboard-target="#code_55" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_hx0ja&quot;)"></div><p id="a_hx0ja">A good start. Let’s try all of our rela­tional and log­i­cal oper­a­tors:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_QxaFk&quot;)"></div><div class="highlight-container" id="a_QxaFk"><div id="code_56" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang basic<br/>10 print 2 &lt; 4 rem 1<br/>20 print 2 &gt; 4 rem 0<br/>30 print 2 = 4 rem 0<br/>40 print 2 &lt;&gt; 4 rem 1<br/>50 print 2 &lt; 4 or 2 &gt; 4 or 2 = 4 rem 1<br/>60 print 2 &lt; 4 and 2 &gt; 4 and 2 = 4 rem 0<br/>70 print not 2 &gt; 4 or not 2 &lt; 4 rem 1</div><div class="highlight" form="false" id="a_pIgjw"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="source"><pre>#lang basic
<span class="nl">10</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">rem</span><span class="w"> </span><span class="il">1</span>
<span class="nl">20</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">rem</span><span class="w"> </span><span class="il">0</span>
<span class="nl">30</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="vg">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">rem</span><span class="w"> </span><span class="il">0</span>
<span class="nl">40</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">rem</span><span class="w"> </span><span class="il">1</span>
<span class="nl">50</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">or</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">or</span><span class="w"> </span><span class="vg">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">rem</span><span class="w"> </span><span class="il">1</span>
<span class="nl">60</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">and</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">and</span><span class="w"> </span><span class="vg">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">rem</span><span class="w"> </span><span class="il">0</span>
<span class="nl">70</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="vg">not</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">or</span><span class="w"> </span><span class="vg">not</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">rem</span><span class="w"> </span><span class="il">1</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkf" data-clipboard-target="#code_56" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_Aw7Jn&quot;)"></div><div class="highlight-container" id="a_Aw7Jn"><div id="code_57" form="false" decode="exclude" style="font-size:0;width:0;height:0">1<br/>0<br/>0<br/>1<br/>1<br/>0<br/>1</div><div class="highlight" form="false" id="a_aEZHj"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="source"><pre>1
0
0
1
1
0
1
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkg" data-clipboard-target="#code_57" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_XLkBh&quot;)"></div><p id="a_XLkBh">Let’s also try the var­i­ous styles of <span class="my-code" decode="exclude">if</span>:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_ShHn0&quot;)"></div><div class="highlight-container" id="a_ShHn0"><div id="code_58" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang basic<br/>10 if 2 &lt; 4 then print "true" else print "false"<br/>20 if 2 &gt; 4 then print "true" else print "false"<br/>30 if 2 &gt; 4 then goto 50<br/>40 print "not"<br/>50 print "true"<br/>60 if 2 &lt; 4 then 40 + 40 else 70<br/>70 print "not"<br/>80 print "true"</div><div class="highlight" form="false" id="a_lDyhL"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="source"><pre>#lang basic
<span class="nl">10</span><span class="w"> </span><span class="vg">if</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">then</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="s2">"true"</span><span class="w"> </span><span class="vg">else</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="s2">"false"</span>
<span class="nl">20</span><span class="w"> </span><span class="vg">if</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">then</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="s2">"true"</span><span class="w"> </span><span class="vg">else</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="s2">"false"</span>
<span class="nl">30</span><span class="w"> </span><span class="vg">if</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">then</span><span class="w"> </span><span class="vg">goto</span><span class="w"> </span><span class="il">50</span>
<span class="nl">40</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="s2">"not"</span>
<span class="nl">50</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="s2">"true"</span>
<span class="nl">60</span><span class="w"> </span><span class="vg">if</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="vg">then</span><span class="w"> </span><span class="il">40</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="il">40</span><span class="w"> </span><span class="vg">else</span><span class="w"> </span><span class="il">70</span>
<span class="nl">70</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="s2">"not"</span>
<span class="nl">80</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="s2">"true"</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkh" data-clipboard-target="#code_58" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_fgahn&quot;)"></div><div class="highlight-container" id="a_fgahn"><div id="code_59" form="false" decode="exclude" style="font-size:0;width:0;height:0">true<br/>false<br/>not<br/>true<br/>true</div><div class="highlight" form="false" id="a_hbxmy"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="source"><pre>true
false
not
true
true
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpki" data-clipboard-target="#code_59" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_kRnqI&quot;)"></div><p id="a_kRnqI">Every­thing checks out.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;functions-vs--macros-revisited&quot;)"></div><h3 anchor="functions-vs--macros-revisited" class="subhead" id="functions-vs--macros-revisited"><a href="#functions-vs--macros-revisited">Func­tions vs. macros revis­ited</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_bEfHr&quot;)"></div><p id="a_bEfHr">At the end of <a href="expressions.html">expres­sions</a>, we saw that we often have a choice between <a class="explainer" href="../explainer/functions.html">func­tions</a> or <a class="explainer" href="../explainer/macros.html">macros</a> for imple­ment­ing ele­ments of a lan­guage. Usu­ally, we pre­fer to use func­tions where we can, and reserve macros for when we really need them, because macros incur some extra costs. Though in sim­ple cases, those costs are minor.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_koaHV&quot;)"></div><p id="a_koaHV">In this case, a lit­tle reflec­tion will reveal that we <em>can’t</em> imple­ment con­di­tion­als with ordi­nary func­tions. Why not? Because con­di­tion­als come with “short-cir­cuit­ing” logic guar­an­tee­ing that no result expres­sion is eval­u­ated until it’s needed. Con­sider these exam­ples with <a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._or))" class="docs" hyphens="none">or</a> and <a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._and))" class="docs" hyphens="none">and</a>:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_87uqT&quot;)"></div><div class="highlight-container" id="a_87uqT"><div id="code_60" form="false" decode="exclude" style="font-size:0;width:0;height:0">(or (= 1 1) (collapse-solar-system))<br/>(and (= 0 1) (start-zombie-apocalypse))</div><div class="highlight" form="false" id="a_xWsJW"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._or))" class="docs" hyphens="none">or</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" class="docs" hyphens="none">=</a></span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">collapse-solar-system</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._and))" class="docs" hyphens="none">and</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" class="docs" hyphens="none">=</a></span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">start-zombie-apocalypse</span><span class="p">))</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkj" data-clipboard-target="#code_60" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_5Regm&quot;)"></div><p id="a_5Regm">If <span class="my-code" decode="exclude">or</span> and <span class="my-code" decode="exclude">and</span> were imple­mented as func­tions, the nested expres­sions would be eval­u­ated first, includ­ing <span class="my-code" decode="exclude">(collapse-solar-system)</span> and <span class="my-code" decode="exclude">(start-zombie-apocalypse)</span>. Not what we want.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_AvEuB&quot;)"></div><p id="a_AvEuB">Instead, these forms are imple­mented as macros, which rearranges the code at <a class="glossary" href="../appendix/glossary.html#compile-time"><span class="glossary-link-text">com­pile time</span></a> so that at <a class="glossary" href="../appendix/glossary.html#run-time"><span class="glossary-link-text">run time</span></a>, things hap­pen in the right order (or not at all).</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_1yQgC&quot;)"></div><p id="a_1yQgC">How, specif­i­cally? Dur­ing com­pile-time macro expan­sion, we can think of these forms as wrap­ping their expres­sions in <a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="docs" hyphens="none">lambda</a>s to delay their eval­u­a­tion:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_pr6gk&quot;)"></div><div class="highlight-container" id="a_pr6gk"><div id="code_61" form="false" decode="exclude" style="font-size:0;width:0;height:0">(or (λ () (= 1 1)) (λ () (collapse-solar-system)))<br/>(and (λ () (= 0 1)) (λ () (start-zombie-apocalypse)))</div><div class="highlight" form="false" id="a_hbu72"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._or))" class="docs" hyphens="none">or</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))" class="docs" hyphens="none">λ</a></span> <span class="p">()</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" class="docs" hyphens="none">=</a></span> <span class="mi">1</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))" class="docs" hyphens="none">λ</a></span> <span class="p">()</span> <span class="p">(</span><span class="n">collapse-solar-system</span><span class="p">)))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._and))" class="docs" hyphens="none">and</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))" class="docs" hyphens="none">λ</a></span> <span class="p">()</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" class="docs" hyphens="none">=</a></span> <span class="mi">0</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))" class="docs" hyphens="none">λ</a></span> <span class="p">()</span> <span class="p">(</span><span class="n">start-zombie-apocalypse</span><span class="p">)))</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkk" data-clipboard-target="#code_61" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_ipS6k&quot;)"></div><p id="a_ipS6k">That way, the under­ly­ing expres­sions are held in “sus­pended ani­ma­tion” until they’re needed at run time.</p></div><div anchorize="false" style="height:2em"></div><ul class="siblinks"><li><a href="intro.html">1&emsp;intro</a></li><li><a href="specification-and-setup.html">2&emsp;spec­i­fi­ca­tion and setup</a></li><li><a href="the-syntax-colorer.html">3&emsp;the syn­tax col­orer</a></li><li><a href="better-line-errors.html">4&emsp;bet­ter line errors</a></li><li><a href="variables-and-input.html">5&emsp;vari­ables and input</a></li><li><a href="expressions.html">6&emsp;expres­sions</a></li><li><a class="here" href="conditionals.html">7&emsp;con­di­tion­als</a></li><li><a href="subroutines-and-loops.html">8&emsp;sub­rou­tines and loops</a></li><li><a href="recap.html">9&emsp;recap</a></li><li><a href="source-listing.html">10&emsp;source list­ing</a></li></ul></div>
    <a class="nav-left" href="expressions.html">← prev</a>
    <a class="nav-right" href="subroutines-and-loops.html">next →</a>




</body>

<script type="text/javascript">



function show_all_forms() {
 var elems = document.getElementsByClassName('has_form');
 for (var i = 0 ; i < elems.length ; i++) {
  toggle_form(elems[i].id);
 }
}

// for debugging forms only: uncomment next line
// show_all_forms();

// sets up copy-to-clipboard buttons in code boxes
var clipboard = new Clipboard('.copy-button');
clipboard.on('success', function(e) {console.log(e);});
clipboard.on('error', function(e) {console.log(e);});
</script>