<!DOCTYPE html>
<html>
  
<!-- Mirrored from beautifulracket.com/explainer/unit-testing.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 16 Mar 2017 05:46:56 GMT -->
<head>
    <meta charset="UTF-8">
    <title>Beautiful Racket: Unit testing</title>
    <link rel="stylesheet" type="text/css" media="all" href="../styles.css"/>
    <script type="text/javascript" src="../functions.js"></script>
    <script type="text/javascript" src="../clipboard.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-74684045-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>
<body>
<div id="alert">Thank you for your comment</div>
    <div id="doc"><h3 class="dept" anchorize="false"><a href="../index.html">Beau­ti­ful Racket</a> / <a href="../index.html#explainers">explain­ers</a></h3><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;unit-testing&quot;)"></div><h1 anchor="unit-testing" id="unit-testing" hyphens="none">Unit testing</h1></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_VuJsK&quot;)"></div><p id="a_VuJsK">Racket’s empha­sis on <a class="glossary" href="../appendix/glossary.html#functional-programming"><span class="glossary-link-text">func­tional pro­gram­ming</span></a> nat­u­rally leads to an empha­sis on <em>unit test­ing</em>. Why? Because as func­tions become self-con­tained—that is, they no longer rely on exter­nal <a class="glossary" href="../appendix/glossary.html#state"><span class="glossary-link-text">state</span></a> or <a class="glossary" href="../appendix/glossary.html#mutation"><span class="glossary-link-text">muta­tion</span></a>—they become eas­ier to test. And when some­thing is easy to test, it’s more likely to actu­ally be tested.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_e1iCu&quot;)"></div><p id="a_e1iCu">Unit test­ing is the cat­e­gory of soft­ware test­ing that checks the behav­ior of indi­vid­ual func­tions—the epony­mous “units.” (One among <a class=" ext" href="https://en.wikipedia.org/wiki/Software_testing">many test­ing cat­e­gories</a>.)  Unit test­ing has two pur­poses:</p></div><ol><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_alqLC&quot;)"></div><p id="a_alqLC">To prove that the soft­ware does what it’s sup­posed to. (As opposed to “well, the soft­ware seems to work.”)</p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_CgJrb&quot;)"></div><p id="a_CgJrb">To make it pos­si­ble to reli­ably refac­tor the soft­ware later. (As opposed to “well, that change didn’t seem to break the soft­ware.”)</p></div></li></ol><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_cshXr&quot;)"></div><p id="a_cshXr">Though unit test­ing is a vir­tu­ous habit, it’s always optional. If you’re pro­gram­ming in an exper­i­men­tal or exploratory way—mean­ing, inten­tion­ally mak­ing &amp; break­ing things—unit tests can be a dis­trac­tion.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_wCv9L&quot;)"></div><p id="a_wCv9L">As the design of the soft­ware firms up, unit tests become increas­ingly valu­able. They allow you to add rigor to your func­tions by nail­ing down expec­ta­tions. In that way, unit tests are sim­i­lar to <a class="explainer" href="contracts.html">con­tracts</a>. But whereas con­tracts make guar­an­tees about the out­side inter­face of a func­tion, unit tests val­i­date its inner work­ings.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_orLOr&quot;)"></div><p id="a_orLOr">For released soft­ware, unit tests are indis­pens­able. They pro­vide a base­line to mea­sure the cor­rect­ness of future revi­sions of the soft­ware. This is espe­cially impor­tant when you’re mak­ing pro­gram­ming lan­guages: oth­ers will be writ­ing pro­grams with your lan­guage, and you want to min­i­mize the chance that revi­sions to the lan­guage will break those pro­grams.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;writing-checks&quot;)"></div><h3 anchor="writing-checks" class="subhead" id="writing-checks"><a href="#writing-checks">Writ­ing checks</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_hcktF&quot;)"></div><p id="a_hcktF">Racket includes a library called <a href="http://docs.racket-lang.org/rackunit"><span class="my-code" decode="exclude">rackunit</span></a> that allows us to cre­ate unit tests called <em>checks</em>. Each check is an asser­tion about the behav­ior of the pro­gram, usu­ally con­sist­ing of a func­tion call and the expected result. If the check is valid, it passes silently. If the check is invalid, an error is raised that tells us both the expected and actual result:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_XYn9F&quot;)"></div><div class="highlight-container" id="a_XYn9F"><div id="code_43" form="false" decode="exclude" style="font-size:0;width:0;height:0">(require rackunit)<br/>(define (plus x y) (+ x y))<br/>(check-equal? (plus 10 14) 24) ; valid<br/>(check-equal? (plus 10 10) 24) ; invalid, actual result is 20</div><div class="highlight" form="false" id="a_Sr1x4"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">rackunit</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">plus</span> <span class="n">x</span> <span class="n">y</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="n">x</span> <span class="n">y</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-equal~3f))" class="docs" hyphens="none">check-equal?</a></span> <span class="p">(</span><span class="n">plus</span> <span class="mi">10</span> <span class="mi">14</span><span class="p">)</span> <span class="mi">24</span><span class="p">)</span> <span class="c1">; valid</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-equal~3f))" class="docs" hyphens="none">check-equal?</a></span> <span class="p">(</span><span class="n">plus</span> <span class="mi">10</span> <span class="mi">10</span><span class="p">)</span> <span class="mi">24</span><span class="p">)</span> <span class="c1">; invalid, actual result is 20</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk" data-clipboard-target="#code_43" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_cAcEa&quot;)"></div><div class="highlight-container err" id="a_cAcEa"><div id="code_44" form="false" decode="exclude" style="font-size:0;width:0;height:0">--------------------<br/>FAILURE<br/>name:       check-equal?<br/>location:   unsaved editor:6:0<br/>actual:     20<br/>expected:   24<br/>expression: (check-equal? (plus 10 10) 24)<br/>--------------------</div><div class="highlight" form="false" id="a_19ddC"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="source"><pre>--------------------
FAILURE
name:       check-equal?
location:   unsaved editor:6:0
actual:     20
expected:   24
expression: (check-equal? (plus 10 10) 24)
--------------------
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk1" data-clipboard-target="#code_44" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_PfLYv&quot;)"></div><p id="a_PfLYv"><span class="my-code" decode="exclude">rackunit</span> has built-in checks for the stan­dard <a class="explainer" href="equality.html">equal­ity</a> func­tions, and cor­re­spond­ing negated checks:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_8PNc1&quot;)"></div><div class="highlight-container" id="a_8PNc1"><div id="code_45" form="false" decode="exclude" style="font-size:0;width:0;height:0">(require rackunit)<br/>(check-eq? 'a 'a) ; symbols are guaranteed to be `eq?`<br/>(check-not-eq? "a" (format "~a" 'a)) ; strings are not<br/>(check-equal? "a" (format "~a" 'a)) ; strings can be `equal?`<br/>(check-not-equal? "a" 25) ; but not with numbers</div><div class="highlight" form="false" id="a_5XvdD"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">rackunit</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-eq~3f))" class="docs" hyphens="none">check-eq?</a></span> <span class="o">&#39;</span><span class="ss">a</span> <span class="o">&#39;</span><span class="ss">a</span><span class="p">)</span> <span class="c1">; symbols are guaranteed to be `eq?`</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-not-eq~3f))" class="docs" hyphens="none">check-not-eq?</a></span> <span class="s2">"a"</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/Writing.html#(def._((quote._~23~25kernel)._format))" class="docs" hyphens="none">format</a></span> <span class="s2">"~a"</span> <span class="o">&#39;</span><span class="ss">a</span><span class="p">))</span> <span class="c1">; strings are not</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-equal~3f))" class="docs" hyphens="none">check-equal?</a></span> <span class="s2">"a"</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/Writing.html#(def._((quote._~23~25kernel)._format))" class="docs" hyphens="none">format</a></span> <span class="s2">"~a"</span> <span class="o">&#39;</span><span class="ss">a</span><span class="p">))</span> <span class="c1">; strings can be `equal?`</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-not-equal~3f))" class="docs" hyphens="none">check-not-equal?</a></span> <span class="s2">"a"</span> <span class="mi">25</span><span class="p">)</span> <span class="c1">; but not with numbers</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk2" data-clipboard-target="#code_45" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_zqoZ5&quot;)"></div><p id="a_zqoZ5"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-true))" class="docs" hyphens="none">check-true</a> and <a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-false))" class="docs" hyphens="none">check-false</a> are short­hand checks for <a class="glossary" href="../appendix/glossary.html#predicate"><span class="glossary-link-text">pred­i­cates</span></a>:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_dAk2C&quot;)"></div><div class="highlight-container" id="a_dAk2C"><div id="code_46" form="false" decode="exclude" style="font-size:0;width:0;height:0">(require rackunit)<br/>(check-true (symbol? 'a))<br/>(check-false (symbol? "a"))<br/>(check-true (number? 42))</div><div class="highlight" form="false" id="a_yhqCi"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">rackunit</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-true))" class="docs" hyphens="none">check-true</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/symbols.html#(def._((quote._~23~25kernel)._symbol~3f))" class="docs" hyphens="none">symbol?</a></span> <span class="o">&#39;</span><span class="ss">a</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-false))" class="docs" hyphens="none">check-false</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/symbols.html#(def._((quote._~23~25kernel)._symbol~3f))" class="docs" hyphens="none">symbol?</a></span> <span class="s2">"a"</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-true))" class="docs" hyphens="none">check-true</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="docs" hyphens="none">number?</a></span> <span class="mi">42</span><span class="p">))</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk3" data-clipboard-target="#code_46" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_lgoHg&quot;)"></div><p id="a_lgoHg">The spe­cial <a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-~3d))" class="docs" hyphens="none">check-=</a> can test whether a numer­i­cal result falls within a cer­tain tol­er­ance of a pre­cise result, which is use­ful for inex­act or prob­a­bilis­tic checks:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_9uZ08&quot;)"></div><div class="highlight-container" id="a_9uZ08"><div id="code_47" form="false" decode="exclude" style="font-size:0;width:0;height:0">(require rackunit)<br/>(check-= (/ 10 2) 5 0) ; valid (within tolerance)<br/>(check-= (/ 11 2) 5 1) ; valid (within tolerance)<br/>(check-= (/ 11 2) 5 0) ; invalid (outside tolerance)</div><div class="highlight" form="false" id="a_HLZI9"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">rackunit</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-~3d))" class="docs" hyphens="none">check-=</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._/))" class="docs" hyphens="none">/</a></span> <span class="mi">10</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">5</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">; valid (within tolerance)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-~3d))" class="docs" hyphens="none">check-=</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._/))" class="docs" hyphens="none">/</a></span> <span class="mi">11</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">5</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">; valid (within tolerance)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-~3d))" class="docs" hyphens="none">check-=</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._/))" class="docs" hyphens="none">/</a></span> <span class="mi">11</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">5</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">; invalid (outside tolerance)</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk4" data-clipboard-target="#code_47" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_qKnBk&quot;)"></div><p id="a_qKnBk">We can also check <a class="explainer" href="errors-and-exceptions.html">errors and excep­tions</a> with <a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-exn))" class="docs" hyphens="none">check-exn</a>. For this check, we need two input argu­ments. First, a <a class="glossary" href="../appendix/glossary.html#predicate"><span class="glossary-link-text">pred­i­cate</span></a> that describes the excep­tion we expect to get. Sec­ond, a test expres­sion that raises an excep­tion. We wrap this expres­sion in a <a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="docs" hyphens="none">lambda</a> to pre­vent it from being imme­di­ately eval­u­ated. The check passes if the expres­sion raises an excep­tion that matches the pred­i­cate. For instance, <span class="my-code" decode="exclude">(/ 25 0)</span> will raise an excep­tion of type <a href="http://docs.racket-lang.org/reference/exns.html#(def._((quote._~23~25kernel)._exn~3afail~3acontract~3f))" class="docs" hyphens="none">exn:fail:contract?</a>, but <span class="my-code" decode="exclude">(/ 25 5)</span> will not:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_HDvTV&quot;)"></div><div class="highlight-container" id="a_HDvTV"><div id="code_48" form="false" decode="exclude" style="font-size:0;width:0;height:0">(require rackunit)<br/>(check-exn exn:fail:contract? (lambda () (/ 25 0))) ; valid<br/>(check-exn exn:fail:contract? (lambda () (/ 25 5))) ; invalid</div><div class="highlight" form="false" id="a_FX3QO"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">rackunit</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-exn))" class="docs" hyphens="none">check-exn</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/exns.html#(def._((quote._~23~25kernel)._exn~3afail~3acontract~3f))" class="docs" hyphens="none">exn:fail:contract?</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="docs" hyphens="none">lambda</a></span> <span class="p">()</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._/))" class="docs" hyphens="none">/</a></span> <span class="mi">25</span> <span class="mi">0</span><span class="p">)))</span> <span class="c1">; valid</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-exn))" class="docs" hyphens="none">check-exn</a></span> <span class="nb"><a href="http://docs.racket-lang.org/reference/exns.html#(def._((quote._~23~25kernel)._exn~3afail~3acontract~3f))" class="docs" hyphens="none">exn:fail:contract?</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="docs" hyphens="none">lambda</a></span> <span class="p">()</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._/))" class="docs" hyphens="none">/</a></span> <span class="mi">25</span> <span class="mi">5</span><span class="p">)))</span> <span class="c1">; invalid</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk5" data-clipboard-target="#code_48" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_4HtzE&quot;)"></div><p id="a_4HtzE">Checks are easy to work with because they’re sim­ple, flex­i­ble, and self-con­tained. Beware, how­ever: as soft­ware code, they’re vul­ner­a­ble to the same defects of mind that can afflict other parts of the code. There’s no way for <span class="my-code" decode="exclude">rackunit</span> to know whether your checks are com­plete or them­selves cor­rect. That remains your job.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;running-unit-tests-in-drracket&quot;)"></div><h3 anchor="running-unit-tests-in-drracket" class="subhead" id="running-unit-tests-in-drracket"><a href="#running-unit-tests-in-drracket">Run­ning unit tests in DrRacket</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_XVKwP&quot;)"></div><p id="a_XVKwP">Checks are only valu­able when they’re being run. How often? As often as pos­si­ble. For that rea­son, other Racket tools coop­er­ate with the <span class="my-code" decode="exclude">test</span> sub­mod­ule.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_n61Ib&quot;)"></div><p id="a_n61Ib">When you run a source file in DrRacket, it will also eval­u­ate any sub­mod­ule in the file called <span class="my-code" decode="exclude">test</span>. <span class="tooltip" onclick="this.classList.toggle('tooltip_visible')"> + <span class="tooltip-inner">Within DrRacket, you can change this default behav­ior through the menu item <em>Lan­guage</em> → <em>Choose Lan­guage …</em> → <em>Sub­mod­ules to Run</em>.</span></span> Though you can use <a href="http://docs.racket-lang.org/reference/module.html#(form._((quote._~23~25kernel)._module))" class="docs" hyphens="none">module</a> to make this sub­mod­ule, it’s often con­ve­nient to use <a href="http://docs.racket-lang.org/reference/module.html#(form._((lib._racket/private/base..rkt)._module+))" class="docs" hyphens="none">module+</a>, which makes a sub­mod­ule that auto­mat­i­cally pulls in the exist­ing bind­ings in the file (which you need for run­ning checks):</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_36WEg&quot;)"></div><div class="highlight-container" id="a_36WEg"><div id="code_49" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define (f x) (expt x 2))<br/>(module+ test<br/>  (require rackunit)<br/>  (check-equal? 16 (f 4))) ; valid</div><div class="highlight" form="false" id="a_2BsXW"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">f</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._expt))" class="docs" hyphens="none">expt</a></span> <span class="n">x</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/module.html#(form._((lib._racket/private/base..rkt)._module+))" class="docs" hyphens="none">module+</a></span> <span class="n">test</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">rackunit</span><span class="p">)</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-equal~3f))" class="docs" hyphens="none">check-equal?</a></span> <span class="mi">16</span> <span class="p">(</span><span class="n">f</span> <span class="mi">4</span><span class="p">)))</span> <span class="c1">; valid</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk6" data-clipboard-target="#code_49" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_BMs8y&quot;)"></div><p id="a_BMs8y">Fur­ther­more, a sub­mod­ule made with <span class="my-code" decode="exclude">module+</span> can be defined in pieces, so a source file can have tests inter­spersed with func­tion def­i­n­i­tions: <span class="tooltip" onclick="this.classList.toggle('tooltip_visible')"> + <span class="tooltip-inner">We only need to import <span class="my-code" decode="exclude">rackunit</span> once within the sub­mod­ule.</span></span></p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_ywb4T&quot;)"></div><div class="highlight-container" id="a_ywb4T"><div id="code_50" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define (f x) (expt x 2))<br/>(module+ test<br/>  (require rackunit)<br/>  (check-equal? 16 (f 4))) ; valid<br/><br/>(define (g x) (expt x 3))<br/>(module+ test<br/>  (check-equal? 64 (g 4))) ; valid</div><div class="highlight" form="false" id="a_h7iiy"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">f</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._expt))" class="docs" hyphens="none">expt</a></span> <span class="n">x</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/module.html#(form._((lib._racket/private/base..rkt)._module+))" class="docs" hyphens="none">module+</a></span> <span class="n">test</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="docs" hyphens="none">require</a></span> <span class="n">rackunit</span><span class="p">)</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-equal~3f))" class="docs" hyphens="none">check-equal?</a></span> <span class="mi">16</span> <span class="p">(</span><span class="n">f</span> <span class="mi">4</span><span class="p">)))</span> <span class="c1">; valid</span>

<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">g</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._expt))" class="docs" hyphens="none">expt</a></span> <span class="n">x</span> <span class="mi">3</span><span class="p">))</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/module.html#(form._((lib._racket/private/base..rkt)._module+))" class="docs" hyphens="none">module+</a></span> <span class="n">test</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/rackunit/api.html#(def._((lib._rackunit/main..rkt)._check-equal~3f))" class="docs" hyphens="none">check-equal?</a></span> <span class="mi">64</span> <span class="p">(</span><span class="n">g</span> <span class="mi">4</span><span class="p">)))</span> <span class="c1">; valid</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk7" data-clipboard-target="#code_50" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_zKTVj&quot;)"></div><p id="a_zKTVj">This way, checks are close to the func­tions they test, and it’s eas­ier to work between the two.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_B8CRi&quot;)"></div><p id="a_B8CRi">When the source file is run under nor­mal cir­cum­stances (e.g., from the com­mand line, or imported by another mod­ule), the <span class="my-code" decode="exclude">test</span> sub­mod­ule will not be eval­u­ated.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;running-unit-tests-in-a-package&quot;)"></div><h3 anchor="running-unit-tests-in-a-package" class="subhead" id="running-unit-tests-in-a-package"><a href="#running-unit-tests-in-a-package">Run­ning unit tests in a pack­age</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_qyvUX&quot;)"></div><p id="a_qyvUX">The <span class="my-code" decode="exclude">raco pkg</span> com­mand-line tool can also auto­mat­i­cally run tests.</p></div><ol><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_v8eUy&quot;)"></div><p id="a_v8eUy">When a pack­age is installed with <span class="my-code" decode="exclude">raco pkg install <em>name</em></span>, every file will be com­piled, and any <span class="my-code" decode="exclude">test</span> sub­mod­ules within the pack­age will be run. See <a href="http://docs.racket-lang.org/pkg/cmdline.html#%28part._raco-pkg-install%29"><span class="my-code" decode="exclude">raco pkg install</span></a>.</p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_pelJu&quot;)"></div><p id="a_pelJu">After instal­la­tion, a pack­age can be tested with <span class="my-code" decode="exclude">raco test -p <em>name</em></span>. In this case, <span class="my-code" decode="exclude">raco pkg test</span> will either run the <span class="my-code" decode="exclude">test</span> sub­mod­ule (if it exists) or the whole file (if it doesn’t). See <a href="http://docs.racket-lang.org/raco/test.html"><span class="my-code" decode="exclude">raco test</span></a>.</p></div></li></ol><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_UFvle&quot;)"></div><p id="a_UFvle">Though <span class="my-code" decode="exclude">test</span> sub­mod­ules are handy, a pack­age author always has the choice whether to put checks in <span class="my-code" decode="exclude">test</span> sub­mod­ules, or cre­ate sep­a­rate files strictly for test­ing. Racket’s pack­age-con­fig­u­ra­tion tools allow <a href="http://docs.racket-lang.org/raco/test.html#%28part._test-config-info%29">even more gran­u­lar con­trol</a> of which files get tested and which are omit­ted.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;further&quot;)"></div><h3 anchor="further" class="subhead" id="further"><a href="#further">Fur­ther</a></h3></div><ul><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_LYavu&quot;)"></div><p id="a_LYavu"><a href="http://docs.racket-lang.org/rackunit">Rack­U­nit docs</a></p></div></li></ul></div>
    <a class="nav-left" href="syntax-patterns.html">← prev</a>
    <a class="nav-right" href="../appendix/domain-specific-languages.html">next →</a>




</body>

<script type="text/javascript">



function show_all_forms() {
 var elems = document.getElementsByClassName('has_form');
 for (var i = 0 ; i < elems.length ; i++) {
  toggle_form(elems[i].id);
 }
}

// for debugging forms only: uncomment next line
// show_all_forms();

// sets up copy-to-clipboard buttons in code boxes
var clipboard = new Clipboard('.copy-button');
clipboard.on('success', function(e) {console.log(e);});
clipboard.on('error', function(e) {console.log(e);});
</script>