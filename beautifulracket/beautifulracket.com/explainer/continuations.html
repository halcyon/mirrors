<!DOCTYPE html>
<html>
  
<!-- Mirrored from beautifulracket.com/explainer/continuations.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 16 Mar 2017 05:46:54 GMT -->
<head>
    <meta charset="UTF-8">
    <title>Beautiful Racket: Continuations</title>
    <link rel="stylesheet" type="text/css" media="all" href="../styles.css"/>
    <script type="text/javascript" src="../functions.js"></script>
    <script type="text/javascript" src="../clipboard.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-74684045-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>
<body>
<div id="alert">Thank you for your comment</div>
    <div id="doc"><h3 class="dept" anchorize="false"><a href="../index.html">Beau­ti­ful Racket</a> / <a href="../index.html#explainers">explain­ers</a></h3><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;continuations&quot;)"></div><h1 anchor="continuations" id="continuations" hyphens="none">Continuations</h1></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_n7Gbq&quot;)"></div><p id="a_n7Gbq">A <em>con­tin­u­a­tion</em> is a spe­cial kind of func­tion that’s like a book­mark to the loca­tion of an expres­sion. Con­tin­u­a­tions let us jump back to an ear­lier point in the pro­gram, thereby cir­cum­vent­ing the <a class="glossary" href="../appendix/glossary.html#control-flow"><span class="glossary-link-text">con­trol flow</span></a> of the usual <a class="explainer" href="evaluation.html">eval­u­a­tion</a> model. Like <a class="explainer" href="macros.html">macros</a>, they’re not a tool of first resort. But they have a niche.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_DgFN4&quot;)"></div><p id="a_DgFN4">When you invoke a con­tin­u­a­tion, it sends you back to the point in the pro­gram when the book­marked expres­sion was eval­u­ated. The con­tin­u­a­tion takes one argu­ment, which replaces the value of the book­marked expres­sion. Eval­u­a­tion resumes from there.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_23pUT&quot;)"></div><p id="a_23pUT">Con­sider this math expres­sion:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_DgWeA&quot;)"></div><div class="highlight-container" id="a_DgWeA"><div id="code_43" form="false" decode="exclude" style="font-size:0;width:0;height:0">(+ 1 (+ 2 (+ 3 (+ 4 5)))) ; 15</div><div class="highlight" form="false" id="a_wBis3"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">1</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">2</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">3</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))))</span> <span class="c1">; 15</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk" data-clipboard-target="#code_43" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_Fflg0&quot;)"></div><p id="a_Fflg0">Sup­pose we want to cap­ture a con­tin­u­a­tion at the <span class="my-code" decode="exclude">4</span>. To do this, we wrap it in <a href="http://docs.racket-lang.org/reference/cont.html#(form._((lib._racket/private/more-scheme..rkt)._let/cc))" class="docs" hyphens="none">let/cc</a>:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_YXgXo&quot;)"></div><div class="highlight-container" id="a_YXgXo"><div id="code_44" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define c #f)<br/>(+ 1 (+ 2 (+ 3 (+ (let/cc here<br/>                    (set! c here)<br/>                    4) 5)))) ; 15</div><div class="highlight" form="false" id="a_EfLzI"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">c</span> <span class="no">#f</span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">1</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">2</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">3</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/cont.html#(form._((lib._racket/private/more-scheme..rkt)._let/cc))" class="docs" hyphens="none">let/cc</a></span> <span class="n">here</span>
                    <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/set_.html#(form._((quote._~23~25kernel)._set!))" class="docs" hyphens="none">set!</a></span> <span class="n">c</span> <span class="n">here</span><span class="p">)</span>
                    <span class="mi">4</span><span class="p">)</span> <span class="mi">5</span><span class="p">))))</span> <span class="c1">; 15</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk1" data-clipboard-target="#code_44" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_mx5yi&quot;)"></div><p id="a_mx5yi"><span class="my-code" decode="exclude">let/cc</span> does three things:</p></div><ol><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_DZXBN&quot;)"></div><p id="a_DZXBN">It serves as the expres­sion that’s book­marked by the con­tin­u­a­tion.</p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_Da5iH&quot;)"></div><p id="a_Da5iH">It cap­tures the con­tin­u­a­tion (<span class="my-code" decode="exclude">cc</span> means “cur­rent con­tin­u­a­tion”) and assigns it to a vari­able we des­ig­nate, in this case <span class="my-code" decode="exclude">here</span>.</p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_FG4xo&quot;)"></div><p id="a_FG4xo">Like ordi­nary <a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))" class="docs" hyphens="none">let</a>, it eval­u­ates any expres­sions within, and the last expres­sion becomes the return value. In this case, <span class="my-code" decode="exclude">let/cc</span> stashes our <span class="my-code" decode="exclude">here</span> con­tin­u­a­tion in the vari­able <span class="my-code" decode="exclude">c</span>, and then returns <span class="my-code" decode="exclude">4</span>. So the value of the over­all expres­sion is unchanged.</p></div></li></ol><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_MsvRW&quot;)"></div><p id="a_MsvRW">What will be the value of <span class="my-code" decode="exclude">(c 20)</span>? When we invoke our con­tin­u­a­tion <span class="my-code" decode="exclude">c</span> with an argu­ment, it’s equiv­a­lent to replac­ing the result of the book­marked expres­sion with the argu­ment:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_7jZ9M&quot;)"></div><div class="highlight-container" id="a_7jZ9M"><div id="code_45" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define c empty)<br/>(+ 1 (+ 2 (+ 3 (+ (let/cc here (set! c here) 4) 5)))) ; 15<br/>(+ 1 (+ 2 (+ 3 (+ 20 5)))) ; 31 (same as `(c 20)`)<br/>(c 20) ; 31</div><div class="highlight" form="false" id="a_ep7JX"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">c</span> <span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((lib._racket/list..rkt)._empty))" class="docs" hyphens="none">empty</a></span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">1</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">2</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">3</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/cont.html#(form._((lib._racket/private/more-scheme..rkt)._let/cc))" class="docs" hyphens="none">let/cc</a></span> <span class="n">here</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/set_.html#(form._((quote._~23~25kernel)._set!))" class="docs" hyphens="none">set!</a></span> <span class="n">c</span> <span class="n">here</span><span class="p">)</span> <span class="mi">4</span><span class="p">)</span> <span class="mi">5</span><span class="p">))))</span> <span class="c1">; 15</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">1</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">2</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">3</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">20</span> <span class="mi">5</span><span class="p">))))</span> <span class="c1">; 31 (same as `(c 20)`)</span>
<span class="p">(</span><span class="n">c</span> <span class="mi">20</span><span class="p">)</span> <span class="c1">; 31</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk2" data-clipboard-target="#code_45" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_I7AYx&quot;)"></div><p id="a_I7AYx">Since a con­tin­u­a­tion is a func­tion, another way of visu­al­iz­ing how it works is to think of <span class="my-code" decode="exclude">let/cc</span> turn­ing its sur­round­ing expres­sion into a func­tion of a vari­able <span class="my-code" decode="exclude">x</span>, where <span class="my-code" decode="exclude">x</span> is the for­mer loca­tion of the <span class="my-code" decode="exclude">let/cc</span> expres­sion:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_tFgsM&quot;)"></div><div class="highlight-container" id="a_tFgsM"><div id="code_46" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define (c x) (+ 1 (+ 2 (+ 3 (+ x 5)))))<br/>(c 20) ; 31</div><div class="highlight" form="false" id="a_57Qkr"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">c</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">1</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">2</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">3</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="n">x</span> <span class="mi">5</span><span class="p">)))))</span>
<span class="p">(</span><span class="n">c</span> <span class="mi">20</span><span class="p">)</span> <span class="c1">; 31</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk3" data-clipboard-target="#code_46" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_bW0gO&quot;)"></div><p id="a_bW0gO">Let’s try a weirder exam­ple: what hap­pens if we imme­di­ately invoke the <span class="my-code" decode="exclude">here</span> con­tin­u­a­tion instead of sav­ing it for later?</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_B4NfC&quot;)"></div><div class="highlight-container" id="a_B4NfC"><div id="code_47" form="false" decode="exclude" style="font-size:0;width:0;height:0">(+ 1 (+ 2 (+ 3 (+ (let/cc here<br/>                    (here 20)<br/>                    4) 5)))) ; ?</div><div class="highlight" form="false" id="a_UuY9R"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">1</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">2</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="mi">3</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="docs" hyphens="none">+</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/cont.html#(form._((lib._racket/private/more-scheme..rkt)._let/cc))" class="docs" hyphens="none">let/cc</a></span> <span class="n">here</span>
                    <span class="p">(</span><span class="n">here</span> <span class="mi">20</span><span class="p">)</span>
                    <span class="mi">4</span><span class="p">)</span> <span class="mi">5</span><span class="p">))))</span> <span class="c1">; ?</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk4" data-clipboard-target="#code_47" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_IQNSH&quot;)"></div><p id="a_IQNSH">We haven’t changed the posi­tion of <span class="my-code" decode="exclude">let/cc</span>, so the con­tin­u­a­tion <span class="my-code" decode="exclude">here</span> is the same as <span class="my-code" decode="exclude">c</span> in the last exam­ple. Thus <span class="my-code" decode="exclude">(here 20)</span> is the same as <span class="my-code" decode="exclude">(c 20)</span>, and the result is still <span class="my-code" decode="exclude">31</span>.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_S2nld&quot;)"></div><p id="a_S2nld">For those who find it strange that invok­ing the con­tin­u­a­tion short-cir­cuits the usual order of eval­u­a­tion—right. That’s the point.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;run-time-travel&quot;)"></div><h3 anchor="run-time-travel" class="subhead" id="run-time-travel"><a href="#run-time-travel">Run-time travel</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_AWsmt&quot;)"></div><p id="a_AWsmt">When we use <span class="my-code" decode="exclude">let/cc</span>, the con­tin­u­a­tion is not (and can­not be) cap­tured until the pro­gram actu­ally reaches the <span class="my-code" decode="exclude">let/cc</span> expres­sion. This means that a con­tin­u­a­tion is strictly a <a class="glossary" href="../appendix/glossary.html#run-time"><span class="glossary-link-text">run-time</span></a> con­cept. More­over, it cap­tures all the run-time con­text that applies to the sur­round­ing expres­sion at that point.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_5Y01r&quot;)"></div><p id="a_5Y01r">Con­sis­tent with their name, con­tin­u­a­tions are <a class=" ext" href="http://matt.might.net/articles/programming-with-continuations--exceptions-backtracking-search-threads-generators-coroutines/">some­times described as</a> rep­re­sent­ing “the remain­ing steps in the com­pu­ta­tion.” True, but we shouldn’t apply this idea rigidly, as it can lead to faulty intu­itions.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_Slgt6&quot;)"></div><p id="a_Slgt6">For exam­ple, let’s rewrite our pre­vi­ous exam­ple as a <a href="http://docs.racket-lang.org/reference/for.html#(form._((lib._racket/private/base..rkt)._for/sum))" class="docs" hyphens="none">for/sum</a> loop, which iter­ates over <span class="my-code" decode="exclude">i</span> and returns the sum of its val­ues (in this case <span class="my-code" decode="exclude">1</span> to <span class="my-code" decode="exclude">5</span>). Once again, we’ll use <span class="my-code" decode="exclude">let/cc</span> to cap­ture the con­tin­u­a­tion when <span class="my-code" decode="exclude">i</span> is <span class="my-code" decode="exclude">4</span>:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_EsyzP&quot;)"></div><div class="highlight-container" id="a_EsyzP"><div id="code_48" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define c empty)<br/>(for/sum ([i (in-list '(1 2 3 4 5))])<br/>         (if (= i 4)<br/>             (let/cc here (set! c here) i)<br/>             i)) ; 15<br/>(c 20) ; ?</div><div class="highlight" form="false" id="a_DqRQi"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">c</span> <span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((lib._racket/list..rkt)._empty))" class="docs" hyphens="none">empty</a></span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/for.html#(form._((lib._racket/private/base..rkt)._for/sum))" class="docs" hyphens="none">for/sum</a></span> <span class="p">([</span><span class="n">i</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/sequences.html#(def._((lib._racket/private/base..rkt)._in-list))" class="docs" hyphens="none">in-list</a></span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))])</span>
         <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((quote._~23~25kernel)._if))" class="docs" hyphens="none">if</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" class="docs" hyphens="none">=</a></span> <span class="n">i</span> <span class="mi">4</span><span class="p">)</span>
             <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/cont.html#(form._((lib._racket/private/more-scheme..rkt)._let/cc))" class="docs" hyphens="none">let/cc</a></span> <span class="n">here</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/set_.html#(form._((quote._~23~25kernel)._set!))" class="docs" hyphens="none">set!</a></span> <span class="n">c</span> <span class="n">here</span><span class="p">)</span> <span class="n">i</span><span class="p">)</span>
             <span class="n">i</span><span class="p">))</span> <span class="c1">; 15</span>
<span class="p">(</span><span class="n">c</span> <span class="mi">20</span><span class="p">)</span> <span class="c1">; ?</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk5" data-clipboard-target="#code_48" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_ZRpRX&quot;)"></div><p id="a_ZRpRX">What hap­pens with <span class="my-code" decode="exclude">(c 20)</span> this time? The faulty intu­ition would be that invok­ing the con­tin­u­a­tion sends <span class="my-code" decode="exclude">20</span> back into the loop when <span class="my-code" decode="exclude">i</span> is <span class="my-code" decode="exclude">4</span>, so the result is <span class="my-code" decode="exclude">(+ 20 5)</span>, or <span class="my-code" decode="exclude">25</span>, because those are the “remain­ing steps in the com­pu­ta­tion.”</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_vT1M7&quot;)"></div><p id="a_vT1M7">But that’s not what hap­pens. The con­tin­u­a­tion cap­tures every­thing about the run-time con­text of the sur­round­ing <span class="my-code" decode="exclude">for/sum</span> expres­sion—not just the eval­u­a­tion steps that need to be com­pleted, but the ones that have <em>already</em> been com­pleted, includ­ing the val­ues of <span class="my-code" decode="exclude">i</span> that have already been vis­ited. So the result is still <span class="my-code" decode="exclude">31</span>:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_t0nBa&quot;)"></div><div class="highlight-container" id="a_t0nBa"><div id="code_49" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define c empty)<br/>(for/sum ([i (in-list '(1 2 3 4 5))])<br/>         (if (= i 4)<br/>             (let/cc here (set! c here) i)<br/>             i)) ; 15<br/>(c 20) ; 31</div><div class="highlight" form="false" id="a_yNkWs"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">c</span> <span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((lib._racket/list..rkt)._empty))" class="docs" hyphens="none">empty</a></span><span class="p">)</span>
<span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/for.html#(form._((lib._racket/private/base..rkt)._for/sum))" class="docs" hyphens="none">for/sum</a></span> <span class="p">([</span><span class="n">i</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/sequences.html#(def._((lib._racket/private/base..rkt)._in-list))" class="docs" hyphens="none">in-list</a></span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))])</span>
         <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((quote._~23~25kernel)._if))" class="docs" hyphens="none">if</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" class="docs" hyphens="none">=</a></span> <span class="n">i</span> <span class="mi">4</span><span class="p">)</span>
             <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/cont.html#(form._((lib._racket/private/more-scheme..rkt)._let/cc))" class="docs" hyphens="none">let/cc</a></span> <span class="n">here</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/set_.html#(form._((quote._~23~25kernel)._set!))" class="docs" hyphens="none">set!</a></span> <span class="n">c</span> <span class="n">here</span><span class="p">)</span> <span class="n">i</span><span class="p">)</span>
             <span class="n">i</span><span class="p">))</span> <span class="c1">; 15</span>
<span class="p">(</span><span class="n">c</span> <span class="mi">20</span><span class="p">)</span> <span class="c1">; 31</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk6" data-clipboard-target="#code_49" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_G3rqe&quot;)"></div><p id="a_G3rqe">Again, if we think of <span class="my-code" decode="exclude">let/cc</span> turn­ing its sur­round­ing expres­sion into a func­tion of <span class="my-code" decode="exclude">x</span>, it’s clear why <span class="my-code" decode="exclude">31</span> is the answer:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_pfwuY&quot;)"></div><div class="highlight-container" id="a_pfwuY"><div id="code_50" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define (c x)<br/>  (for/sum ([i (in-list '(1 2 3 4 5))])<br/>           (if (= i 4)<br/>               x<br/>               i)))<br/>(c 20) ; 31</div><div class="highlight" form="false" id="a_de8Nj"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">c</span> <span class="n">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/for.html#(form._((lib._racket/private/base..rkt)._for/sum))" class="docs" hyphens="none">for/sum</a></span> <span class="p">([</span><span class="n">i</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/sequences.html#(def._((lib._racket/private/base..rkt)._in-list))" class="docs" hyphens="none">in-list</a></span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))])</span>
           <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/if.html#(form._((quote._~23~25kernel)._if))" class="docs" hyphens="none">if</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" class="docs" hyphens="none">=</a></span> <span class="n">i</span> <span class="mi">4</span><span class="p">)</span>
               <span class="n">x</span>
               <span class="n">i</span><span class="p">)))</span>
<span class="p">(</span><span class="n">c</span> <span class="mi">20</span><span class="p">)</span> <span class="c1">; 31</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk7" data-clipboard-target="#code_50" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;what-are-they-good-for&quot;)"></div><h3 anchor="what-are-they-good-for" class="subhead" id="what-are-they-good-for"><a href="#what-are-they-good-for">What are they good for?</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_dH1ds&quot;)"></div><p id="a_dH1ds">When you need to jump back to an ear­lier point in your pro­gram, a con­tin­u­a­tion can be the right tool for the job. For instance, <a class="explainer" href="errors-and-exceptions.html">errors and excep­tions</a> are imple­mented with con­tin­u­a­tions, as they allow con­trol to jump from inside an expres­sion to the near­est enclos­ing <a href="http://docs.racket-lang.org/reference/exns.html#(form._((lib._racket/private/more-scheme..rkt)._with-handlers))" class="docs" hyphens="none">with-handlers</a> form.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_6onSS&quot;)"></div><p id="a_6onSS">Along those lines, though Racket has no <span class="my-code" decode="exclude">return</span> state­ment, it can be imple­mented with a con­tin­u­a­tion:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_3oPTz&quot;)"></div><div class="highlight-container" id="a_3oPTz"><div id="code_51" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define (find-multiple factor)<br/>  (let/cc return<br/>    (for ([num (shuffle (range 2000))])<br/>         (when (zero? (modulo num factor))<br/>           (return num)))))<br/><br/>(find-multiple 43)</div><div class="highlight" form="false" id="a_uIajg"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="p">(</span><span class="n">find-multiple</span> <span class="n">factor</span><span class="p">)</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/cont.html#(form._((lib._racket/private/more-scheme..rkt)._let/cc))" class="docs" hyphens="none">let/cc</a></span> <span class="n">return</span>
    <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/for.html#(form._((lib._racket/private/base..rkt)._for))" class="docs" hyphens="none">for</a></span> <span class="p">([</span><span class="n">num</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((lib._racket/list..rkt)._shuffle))" class="docs" hyphens="none">shuffle</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((lib._racket/list..rkt)._range))" class="docs" hyphens="none">range</a></span> <span class="mi">2000</span><span class="p">))])</span>
         <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/when_unless.html#(form._((lib._racket/private/letstx-scheme..rkt)._when))" class="docs" hyphens="none">when</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._zero~3f))" class="docs" hyphens="none">zero?</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._modulo))" class="docs" hyphens="none">modulo</a></span> <span class="n">num</span> <span class="n">factor</span><span class="p">))</span>
           <span class="p">(</span><span class="n">return</span> <span class="n">num</span><span class="p">)))))</span>

<span class="p">(</span><span class="n">find-multiple</span> <span class="mi">43</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk8" data-clipboard-target="#code_51" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_W8JVB&quot;)"></div><p id="a_W8JVB">We can gen­er­al­ize this into a <span class="my-code" decode="exclude">define/return</span> macro that adds <span class="my-code" decode="exclude">return</span> to any func­tion: <span class="tooltip" onclick="this.classList.toggle('tooltip_visible')"> + <span class="tooltip-inner">Of course, there are bet­ter ways to stop a loop. See <a class="explainer" href="loops.html">loops</a>. There are also bet­ter ways to write a <span class="my-code" decode="exclude">define</span> macro.</span></span></p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_vRqwn&quot;)"></div><div class="highlight-container" id="a_vRqwn"><div id="code_52" form="false" decode="exclude" style="font-size:0;width:0;height:0">(define-macro (define/return ID+ARG BODY)<br/>  (with-shared-id (return)<br/>    #'(define ID+ARG<br/>        (let/cc return<br/>          BODY))))<br/><br/>(define/return (find-multiple factor)<br/>  (for ([num (shuffle (range 2000))])<br/>       (when (zero? (modulo num factor))<br/>         (return num))))<br/><br/>(find-multiple 43)</div><div class="highlight" form="false" id="a_g14DZ"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="source"><pre><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/br/index.html#(form._((lib._br/define..rkt)._define-macro))" class="docs" hyphens="none">define-macro</a></span> <span class="p">(</span><span class="n">define/return</span> <span class="n">ID+ARG</span> <span class="n">BODY</span><span class="p">)</span>
  <span class="p">(</span><span class="n">with-shared-id</span> <span class="p">(</span><span class="n">return</span><span class="p">)</span>
    <span class="o">#&#39;</span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="docs" hyphens="none">define</a></span> <span class="n">ID+ARG</span>
        <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/cont.html#(form._((lib._racket/private/more-scheme..rkt)._let/cc))" class="docs" hyphens="none">let/cc</a></span> <span class="n">return</span>
          <span class="n">BODY</span><span class="p">))))</span>

<span class="p">(</span><span class="n">define/return</span> <span class="p">(</span><span class="n">find-multiple</span> <span class="n">factor</span><span class="p">)</span>
  <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/for.html#(form._((lib._racket/private/base..rkt)._for))" class="docs" hyphens="none">for</a></span> <span class="p">([</span><span class="n">num</span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((lib._racket/list..rkt)._shuffle))" class="docs" hyphens="none">shuffle</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((lib._racket/list..rkt)._range))" class="docs" hyphens="none">range</a></span> <span class="mi">2000</span><span class="p">))])</span>
       <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/when_unless.html#(form._((lib._racket/private/letstx-scheme..rkt)._when))" class="docs" hyphens="none">when</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._zero~3f))" class="docs" hyphens="none">zero?</a></span> <span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._modulo))" class="docs" hyphens="none">modulo</a></span> <span class="n">num</span> <span class="n">factor</span><span class="p">))</span>
         <span class="p">(</span><span class="n">return</span> <span class="n">num</span><span class="p">))))</span>

<span class="p">(</span><span class="n">find-multiple</span> <span class="mi">43</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpk9" data-clipboard-target="#code_52" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_GYTvX&quot;)"></div><p id="a_GYTvX">More broadly, any algo­rithm that incor­po­rates back­track­ing logic can work with con­tin­u­a­tions, since they pro­vide a sim­ple way to set arbi­trary return points—e.g., search, pathfind­ing, con­straint sat­is­fac­tion, and type­set­ting. Func­tions that can be sus­pended and resumed, like <a href="https://docs.racket-lang.org/reference/Generators.html">gen­er­a­tors</a> and cer­tain <a href="https://docs.racket-lang.org/more/#%28part._.Continuations%29">web appli­ca­tions</a>, can also be built with con­tin­u­a­tions.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;so-a-continuation-is-just-goto-in-disguise&quot;)"></div><h3 anchor="so-a-continuation-is-just-goto-in-disguise" class="subhead" id="so-a-continuation-is-just-goto-in-disguise"><a href="#so-a-continuation-is-just-goto-in-disguise">“So a con­tin­u­a­tion is just goto in dis­guise?”</a></h3></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_JMzPJ&quot;)"></div><p id="a_JMzPJ">Not quite. The  <span class="my-code" decode="exclude">goto</span> state­ment in a lan­guage like <a href="../basic/index.html"><span class="my-code" decode="exclude">basic</span></a> lets us jump to an arbi­trary point in the pro­gram:</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_GknKc&quot;)"></div><div class="highlight-container" id="a_GknKc"><div id="code_53" form="false" decode="exclude" style="font-size:0;width:0;height:0">#lang basic-demo<br/>10 goto 40<br/>20 print "appears first, prints second"<br/>30 end<br/>40 print "appears second, prints first"<br/>50 goto 20</div><div class="highlight" form="false" id="a_wzdLd"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="source"><pre>#lang basic-demo
<span class="nl">10</span><span class="w"> </span><span class="vg">goto</span><span class="w"> </span><span class="il">40</span>
<span class="nl">20</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="s2">"appears first, prints second"</span>
<span class="nl">30</span><span class="w"> </span><span class="vg">end</span>
<span class="nl">40</span><span class="w"> </span><span class="vg">print</span><span class="w"> </span><span class="s2">"appears second, prints first"</span>
<span class="nl">50</span><span class="w"> </span><span class="vg">goto</span><span class="w"> </span><span class="il">20</span>
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpka" data-clipboard-target="#code_53" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_Xhnlj&quot;)"></div><div class="highlight-container" id="a_Xhnlj"><div id="code_54" form="false" decode="exclude" style="font-size:0;width:0;height:0">appears second, prints first<br/>appears first, prints second</div><div class="highlight" form="false" id="a_lb0Ty"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="source"><pre>appears second, prints first
appears first, prints second
</pre></div>
</td></tr></tbody></table></div><div class="copy-button" form="false" onClick="notify('copied to clipboard', 1000)" id="a_Vldpkb" data-clipboard-target="#code_54" data-clipboard-action="copy"><img src="../fonts/feather-v1.1/svg/download.svg" alt="copy to clipboard"/></div></div></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_PNNLf&quot;)"></div><p id="a_PNNLf">A <span class="my-code" decode="exclude">goto</span> can move any­where in the pro­gram because the pos­si­ble des­ti­na­tions are known at <a class="glossary" href="../appendix/glossary.html#compile-time"><span class="glossary-link-text">com­pile time</span></a>. A con­tin­u­a­tion, by con­trast, needs the cur­rent eval­u­a­tion con­text, which is only known at run time. In that sense, a con­tin­u­a­tion is less flex­i­ble: it can only rep­re­sent a loca­tion in the pro­gram that’s already been vis­ited. Thus, when you invoke a con­tin­u­a­tion, you can only travel back­ward, not for­ward.</p></div><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;further&quot;)"></div><h3 anchor="further" class="subhead" id="further"><a href="#further">Fur­ther</a></h3></div><ul><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_j477V&quot;)"></div><p id="a_j477V"><span><a href="http://docs.racket-lang.org/guide/conts.html">Con­tin­u­a­tions</a> in the Racket Guide</span></p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_0LZNF&quot;)"></div><p id="a_0LZNF"><span><a href="http://docs.racket-lang.org/reference/cont.html">Con­tin­u­a­tions</a> in the Racket Ref­er­ence</span></p></div></li><li><div class="sidebar-container"><div class="sidebar has_form" onclick="toggle_form(&quot;a_le0vH&quot;)"></div><p id="a_le0vH"><span><a href="http://docs.racket-lang.org/reference/eval-model.html?q=continuation#%28tech._continuation%29">Eval­u­a­tion of con­tin­u­a­tions</a> in the Racket Ref­er­ence</span></p></div></li></ul></div>
    <a class="nav-left" href="booleans-and-conditionals.html">← prev</a>
    <a class="nav-right" href="contracts.html">next →</a>




</body>

<script type="text/javascript">



function show_all_forms() {
 var elems = document.getElementsByClassName('has_form');
 for (var i = 0 ; i < elems.length ; i++) {
  toggle_form(elems[i].id);
 }
}

// for debugging forms only: uncomment next line
// show_all_forms();

// sets up copy-to-clipboard buttons in code boxes
var clipboard = new Clipboard('.copy-button');
clipboard.on('success', function(e) {console.log(e);});
clipboard.on('error', function(e) {console.log(e);});
</script>