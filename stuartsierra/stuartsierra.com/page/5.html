<!DOCTYPE html>
<html lang="en-US" class="no-js">

<!-- Mirrored from stuartsierra.com/page/5 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 02 Sep 2016 17:03:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="http://gmpg.org/xfn/11">
		<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>Digital Digressions by Stuart Sierra &#8211; Page 5 &#8211; From programming to everything else</title>
<link rel='dns-prefetch' href='http://s0.wp.com/'>
<link rel='dns-prefetch' href='http://secure.gravatar.com/'>
<link rel='dns-prefetch' href='http://fonts.googleapis.com/'>
<link rel='dns-prefetch' href='http://s.w.org/'>
<link rel="alternate" type="application/rss+xml" title="Digital Digressions by Stuart Sierra &raquo; Feed" href="http://feeds2.feedburner.com/StuartSierra" />
<link rel="alternate" type="application/rss+xml" title="Digital Digressions by Stuart Sierra &raquo; Comments Feed" href="../comments/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/stuartsierra.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='twentysixteen-jetpack-css'  href='../wp-content/plugins/jetpack/modules/theme-tools/compat/twentysixteen3a05.css?ver=4.2.2' type='text/css' media='all' />
<link rel='stylesheet' id='twentysixteen-fonts-css'  href='https://fonts.googleapis.com/css?family=Merriweather%3A400%2C700%2C900%2C400italic%2C700italic%2C900italic%7CMontserrat%3A400%2C700%7CInconsolata%3A400&amp;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='../wp-content/plugins/jetpack/_inc/genericons/genericons/genericons128b.css?ver=3.1' type='text/css' media='all' />
<link rel='stylesheet' id='twentysixteen-style-css'  href='../wp-content/themes/twentysixteen/style167b.css?ver=4.6' type='text/css' media='all' />
<!--[if lt IE 10]>
<link rel='stylesheet' id='twentysixteen-ie-css'  href='https://stuartsierra.com/wp-content/themes/twentysixteen/css/ie.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentysixteen-ie8-css'  href='https://stuartsierra.com/wp-content/themes/twentysixteen/css/ie8.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 8]>
<link rel='stylesheet' id='twentysixteen-ie7-css'  href='https://stuartsierra.com/wp-content/themes/twentysixteen/css/ie7.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='jetpack_css-css'  href='../wp-content/plugins/jetpack/css/jetpack3a05.css?ver=4.2.2' type='text/css' media='all' />
<script type='text/javascript' src='../wp-includes/js/jquery/jqueryb8ff.js?ver=1.12.4'></script>
<script type='text/javascript' src='../wp-includes/js/jquery/jquery-migrate.min330a.js?ver=1.4.1'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://stuartsierra.com/wp-content/themes/twentysixteen/js/html5.js?ver=3.7.3'></script>
<![endif]-->
<link rel='https://api.w.org/' href='../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.6" />
<link rel='shortlink' href='https://wp.me/bl3J' />

<link rel='dns-prefetch' href='http://v0.wordpress.com/'>

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="website" />
<meta property="og:title" content="Digital Digressions by Stuart Sierra" />
<meta property="og:description" content="From programming to everything else" />
<meta property="og:url" content="https://stuartsierra.com/" />
<meta property="og:site_name" content="Digital Digressions by Stuart Sierra" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:locale" content="en_US" />
</head>

<body class="home blog paged paged-5 hfeed">
<div id="page" class="site">
	<div class="site-inner">
		<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

		<header id="masthead" class="site-header" role="banner">
			<div class="site-header-main">
				<div class="site-branding">
					
											<h1 class="site-title"><a href="../index.html" rel="home">Digital Digressions by Stuart Sierra</a></h1>
											<p class="site-description">From programming to everything else</p>
									</div><!-- .site-branding -->

									<button id="menu-toggle" class="menu-toggle">Menu</button>

					<div id="site-header-menu" class="site-header-menu">
													<nav id="site-navigation" class="main-navigation" role="navigation" aria-label="Primary Menu">
								<div class="menu-main-menu-container"><ul id="menu-main-menu" class="primary-menu"><li id="menu-item-635" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-635"><a href="../about-me.html">About Me</a></li>
<li id="menu-item-633" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-633"><a href="../writing.html">Writing</a></li>
<li id="menu-item-634" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-634"><a href="../presentations.html">Presentations</a></li>
<li id="menu-item-636" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-636"><a href="../software.html">Software</a></li>
<li id="menu-item-637" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-637"><a href="../contact.html">Contact</a></li>
</ul></div>							</nav><!-- .main-navigation -->
						
											</div><!-- .site-header-menu -->
							</div><!-- .site-header-main -->

											<div class="header-image">
					<a href="../index.html" rel="home">
						<img src="../wp-content/uploads/2015/12/header.jpg" srcset="https://stuartsierra.com/wp-content/uploads/2015/12/header-300x70.jpg 300w, https://stuartsierra.com/wp-content/uploads/2015/12/header-768x179.jpg 768w, https://stuartsierra.com/wp-content/uploads/2015/12/header-1024x239.jpg 1024w, https://stuartsierra.com/wp-content/uploads/2015/12/header.jpg 1200w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 81vw, (max-width: 1362px) 88vw, 1200px" width="1200" height="280" alt="Digital Digressions by Stuart Sierra">
					</a>
				</div><!-- .header-image -->
					</header><!-- .site-header -->

		<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
			
<article id="post-575" class="post-575 post type-post status-publish format-standard hentry category-programming">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="../2011/10/04/jdk-version-survey.html" rel="bookmark">JDK Version Survey</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>The most recent JDK version poll I could find was <a href="http://java.dzone.com/news/jdk-version-poll-results">from 2008</a> (thanks, Alex!) so here&#8217;s a new one.</p>
<p><iframe src="https://docs.google.com/spreadsheet/embeddedform?formkey=dEU5a0d1VE52NFhOQTJUblFKUmVKeWc6MQ" width="760" height="870" frameborder="0" marginheight="0" marginwidth="0">Loading&#8230;</iframe></p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2011/10/04/jdk-version-survey.html" rel="bookmark"><time class="entry-date published updated" datetime="2011-10-04T07:52:05+00:00">October 4, 2011</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming.html" rel="category tag">Programming</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-565" class="post-565 post type-post status-publish format-standard hentry category-programming tag-git tag-maven tag-ruby">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="../2011/08/30/design-philosophies-of-developer-tools.html" rel="bookmark">Design Philosophies of Developer Tools</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>I&#8217;ve been thinking about some of the tools that I use every day, and about the different design philosophies they reflect.</p>
<h3>Git</h3>
<p>First and foremost, Git. <a href="http://thinkrelevance.com/">We</a> use Git on every single project, internal and external. Git is a great example of the Unix design philosophy: many small programs &mdash; 153 of them by my count &mdash; each of which does exactly one thing and does it well. But this is not &#8220;loose coupling.&#8221; The components of Git are tightly integrated: they all depend on the same <a href="http://www.kernel.org/pub/software/scm/git/docs/gitrepository-layout.html">repository structure</a> and file formats. </p>
<p>One of the nice things about Git is how its internals are both exposed for the world to see and thoroughly documented. We can easily write scripts to automate common tasks or create different workflows. With a bit more effort, we could even write new tools that integrate with the Git suite. These tools can do things that Git&#8217;s authors never intended, as long as they follow the documented repository structure. Git isn&#8217;t so much a version control system as the means to construct one.</p>
<p>Still, Git is one project with many components, not many separate projects. All 153 executables in Git are governed by a single release cycle, tested and known to work together. We never have to worry about incompatible versions of, say, <code>git-branch</code> and <code>git-merge</code> on the same machine. Older versions of Git can read repositories created with newer versions even if they don&#8217;t provide all the same features.</p>
<h3>Maven</h3>
<p>In stark contrast to Git, we have tools from the Java world like <a href="http://ant.apache.org/">Ant</a> and <a href="http://maven.apache.org/">Maven</a>. The <a href="http://blog.headius.com/2009/05/fork-and-exec-on-jvm-jruby-to-rescue.html">JVM cannot fork/exec</a>, so the many-small-programs design is a non-starter. Instead, the Java tools usually favor some sort of plug-in architecture, which is a great idea in theory but hard to get right in practice. </p>
<p>I&#8217;ve <a href="https://github.com/stuartsierra/new-clojure-maven-plugin">tried writing a Maven plugin</a>. Hacking up a one-off for a single project is not too difficult, but designing a general-purpose plugin that works everywhere is maddeningly complicated. Maven plugins are just Java code, so they can do whatever they want, but the APIs for interacting with the rest of the Maven system are woefully underdocumented. The <strong>contract</strong> of a Maven plugin, what it can and cannot do, is not well-defined. The internals of Maven itself are largely a black box. </p>
<p>The core Maven plug-ins have independent release cycles, so there is the possibility for unexpected incompatibilities, but I&#8217;ve never encountered such. On the whole, the Maven ecosystem is quite stable. The struggle comes once you venture outside the realm of what the standard plugins provide. Maven plugins are not designed to be composed, so adding new capabilities is rarely as simple as scripting plugins that already exist. You have to start from scratch every time.</p>
<h3>Ruby / Rubygems / RVM / Bundler</h3>
<p>Finally, we have tools from the Ruby world, the ever-changing cornucopia of Ruby implementations, libraries, and tools to manage it all. The problem with the Ruby tools is that they are both tightly-coupled and uncoordinated. Despite having separate tools for each task, each tool reaches into at least one of the others: Rubygems modifies the behavior of the Ruby interpreter, Bundler modifies the behavior of Rubygems, RVM modifies the behavior of the <em>shell</em>, and so on. Each one adds another layer of indirection, making debugging harder.</p>
<p>All of the Ruby development tools have independent release cycles, and they don&#8217;t seem to plan or coordinate with one another in advance of each release. Integration testing is left up to the users.</p>
<p>I admire the speed and eagerness with which the Ruby community produces new tools. But on almost every Ruby project I&#8217;ve worked on, we&#8217;ve spent hours or days sorting out incompatibilities among some combination of libraries, language implementations, and development tools.  Our internal mailing list is littered with advice like &#8220;Don&#8217;t use Bundler version X with RVM version Y.&#8221; The speed of development comes with its own cost.</p>
<h3>Thoughts</h3>
<p>So what do I take from all this? Just a few principles to keep in mind when writing software tools:</p>
<ol>
<li>Plan for integration</li>
<li>Rigorously specify the boundaries and extension points of your system</li>
<li>Do not depend on unspecified behavior</li>
</ol>
<p>And a couple of ideas if you&#8217;re starting a new project from scratch:</p>
<ol>
<li>The filesystem is the universal integration point</li>
<li>Fork/exec is the universal plugin architecture</li>
</ol>
<p><strong>Update 8/31:</strong> More comments at <a href="http://news.ycombinator.com/item?id=2943902">Hacker News</a>.</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2011/08/30/design-philosophies-of-developer-tools.html" rel="bookmark"><time class="entry-date published" datetime="2011-08-30T19:55:15+00:00">August 30, 2011</time><time class="updated" datetime="2011-08-31T09:21:06+00:00">August 31, 2011</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="../tag/git.html" rel="tag">Git</a>, <a href="../tag/maven.html" rel="tag">Maven</a>, <a href="../tag/ruby.html" rel="tag">Ruby</a></span><span class="comments-link"><a href="../2011/08/30/design-philosophies-of-developer-tools.html#comments">5 Comments<span class="screen-reader-text"> on Design Philosophies of Developer Tools</span></a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-550" class="post-550 post type-post status-publish format-standard hentry category-programming tag-clojure">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="../2011/08/08/clojure-namespaces.html" rel="bookmark">The Naming of Namespaces</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>From time to time I&#8217;m asked, &#8220;How do you organize namespaces in Clojure projects?&#8221; The question surprised me at first, because I hadn&#8217;t thought about it much. But then I was using Clojure <a href="http://xkcd.com/378/">back when</a> the only way to load code was &#8220;load-file.&#8221;</p>
<p>Most programming languages, especially object-oriented languages, provide strong hints on how to structure your source files. Everything is a class, and (almost) every class is a file. In Clojure, everything (almost) is a function. Functions are much smaller units than classes. So how do we group them?</p>
<p>The important thing to remember about namespaces is that, from the compiler&#8217;s point of view, they don&#8217;t matter. Namespaces are a convenience for the programmer, to help you avoid name clashes without having to write longer names. There&#8217;s no reason why an entire application can&#8217;t be defined in a single namespace. Most of Clojure itself is defined in <a href="http://clojure.github.com/clojure/#clojure.core">one namespace</a> with over 500 symbols. (Common Lisp has <a href="http://www.lispworks.com/documentation/HyperSpec/Front/X_Symbol.htm">978 symbols</a> in a single namespace.)</p>
<p>You can think of namespaces as a tool to <strong>express something</strong> about your application. Here are some ideas to get you started:</p>
<ul>
<li>Group functions into namespaces based on <strong>type of data</strong> they manipulate. For example, functions to manipulate customer data go in the &#8220;customer&#8221; namespace. This technique is familiar from object-oriented languages, but it has the same limitations: where do you put functions concerning relationships among two or more types? The OO answer would be to make a new name for the relationship. This style leads to a proliferation of small namespaces, which can become a burden.</li>
<li>Divide a library into a <strong>public API</strong> namespace and a <strong>internal implementation</strong> namespace. Or define a <strong>high-level API</strong> for common cases and a <strong>low-level API</strong> for more advanced usage.</li>
<li>Divide an application into namespaces representing <strong>architectural layers</strong>. You can examine &#8220;ns&#8221; declarations to prove that each layer calls functions only from the layer below it.</li>
<li>Divide an application into namespaces representing <strong>functional modules</strong>, with well-defined contracts for communication between modules.</li>
<li>Try to separate <strong>decision-making</strong> code from the code that <strong>carries out</strong> those decisions. That is, keep your business logic purely functional and free of side-effects, so it is easy to test. You don&#8217;t necessarily have to put side-effect code in a separate namespace, but doing so may help keep it cleanly separated.</li>
</ul>
<p>With all these techniques, the point to remember is that namespaces are there to help you, not to get in your way. If you have a large namespace, you can still divide it up into multiple files.</p>
<p>The one hard-and-fast rule is that you cannot have a circular dependency between namespaces. That is, if namespace A needs to call functions defined in namespace B, then namespace B <strong>cannot</strong> call functions in namespace A. There is no workaround, it simply can&#8217;t be done. In practice, this is rarely a problem. If you encounter a situation where two namespaces are mutually dependent, it&#8217;s probably a sign that they should be merged into a single namespace.</p>
<p>In client projects at <a href="http://thinkrelevance.com/">Relevance</a> (home of <a href="http://clojure.com/">Clojure/core</a>) we often end up with one namespace for each aspect of an application — data access, UI, logging, and so on. Then there&#8217;s one &#8220;main&#8221; namespace that depends on all the others and ties it all together.</p>
<p><strong>Update 9/5/2011:</strong> Chris Houser wrote a nice answer on StackOverflow about <a href="http://stackoverflow.com/questions/4690758/splitting-a-clojure-namespace-over-multiple-files">how to split a Clojure namespace over several files</a>.</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2011/08/08/clojure-namespaces.html" rel="bookmark"><time class="entry-date published" datetime="2011-08-08T20:43:58+00:00">August 8, 2011</time><time class="updated" datetime="2011-09-05T01:31:29+00:00">September 5, 2011</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="../tag/clojure.html" rel="tag">Clojure</a></span><span class="comments-link"><a href="../2011/08/08/clojure-namespaces.html#comments">1 Comment<span class="screen-reader-text"> on The Naming of Namespaces</span></a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-543" class="post-543 post type-post status-publish format-standard hentry category-programming tag-clojure tag-clojurescript">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="../2011/07/21/clojurescript-launch-new-york.html" rel="bookmark">ClojureScript Launch, New York</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>As you may have heard, last night we (<a title="Clojure/core: Clojure consulting services, support, and agile software development" href="http://clojure.com/">Clojure/core</a>) announced <a href="https://github.com/clojure/clojurescript">ClojureScript</a> at the <a href="http://www.meetup.com/Clojure-NYC/">Clojure NYC Meetup</a>. Rich Hickey gave a talk, which was streamed live over the web, while we monitored Twitter and IRC for feedback.</p>
<p>The event was a great success, with loads of excitement expressed by both the local New York crowd and the Internet at large.</p>
<figure id="attachment_544" style="width: 300px" class="wp-caption alignnone"><a href="../wp-content/uploads/2011/07/2011-07-20-screenshot-during-clojurescript-talk.png"><img class="size-medium wp-image-544" title="2011-07-20-screenshot-during-clojurescript-talk" src="../wp-content/uploads/2011/07/2011-07-20-screenshot-during-clojurescript-talk-300x187.png" alt="Screenshot of IRC / Twitter during the ClojureScript announcement" width="300" height="187" srcset="https://stuartsierra.com/wp-content/uploads/2011/07/2011-07-20-screenshot-during-clojurescript-talk-300x187.png 300w, https://stuartsierra.com/wp-content/uploads/2011/07/2011-07-20-screenshot-during-clojurescript-talk-1024x640.png 1024w" sizes="(max-width: 300px) 85vw, 300px" /></a><figcaption class="wp-caption-text">Screenshot of IRC / Twitter during the ClojureScript announcement</figcaption></figure>
<p>Video was also recorded, which will be posted soon.</p>
<p>Thanks to <a href="http://www.google.com/intl/ln/jobs/uslocations/new-york/index.html">Google New York</a> for hosting.</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2011/07/21/clojurescript-launch-new-york.html" rel="bookmark"><time class="entry-date published" datetime="2011-07-21T16:04:31+00:00">July 21, 2011</time><time class="updated" datetime="2011-07-21T16:08:34+00:00">July 21, 2011</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="../tag/clojure.html" rel="tag">Clojure</a>, <a href="../tag/clojurescript.html" rel="tag">ClojureScript</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-538" class="post-538 post type-post status-publish format-standard hentry category-programming">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="../2011/06/16/vote-for-clojure-at-jax-innovation-awards.html" rel="bookmark">Vote for Clojure at JAX Innovation Awards!</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p><a href="http://vote.jax-awards.com/"><img src="../wp-content/uploads/2011/06/JAX_US_IA_Button_Vote_For_Us.png" alt="JAX Innovation Awards 2011: Vote for us" title="JAX_US_IA_Button_Vote_For_Us" width="401" height="263" class="alignnone size-full wp-image-539" srcset="https://stuartsierra.com/wp-content/uploads/2011/06/JAX_US_IA_Button_Vote_For_Us.png 401w, https://stuartsierra.com/wp-content/uploads/2011/06/JAX_US_IA_Button_Vote_For_Us-300x196.png 300w" sizes="(max-width: 401px) 85vw, 401px" /></a></p>
<p><a href="http://vote.jax-awards.com/">Vote for Clojure</a> as the Most Innovative Java Technology of 2011!</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2011/06/16/vote-for-clojure-at-jax-innovation-awards.html" rel="bookmark"><time class="entry-date published updated" datetime="2011-06-16T07:55:29+00:00">June 16, 2011</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming.html" rel="category tag">Programming</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-533" class="post-533 post type-post status-publish format-standard hentry category-programming tag-clojure tag-java tag-leiningen tag-maven">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="../2011/06/01/dependency-management.html" rel="bookmark">Dependency Management First-Aid Kit</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>This article attempts to unravel some of the mysteries of dependency management with <a href="http://maven.apache.org/">Maven</a> and Maven-based tools.</p>
<h3>Help, something&#8217;s missing!</h3>
<p>Say you have a project named &#8220;my-new-project&#8221; which declares a dependency on version 3 of the &#8220;awesome-sauce&#8221; library by the Example.com corporation. You add the dependency to your pom.xml, project.clj, or whatever configuration file your build tool uses. You take a deep breath and start a build. And it fails!</p>
<p>If you&#8217;re using Maven 2, you see something like this:</p>
<pre>[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] Failed to resolve artifact.

Missing:
----------
1) com.example:awesome-sauce:jar:3.0.0

  Try downloading the file manually from the project website.

  Then, install it using the command: 
      mvn install:install-file -DgroupId=com.example -DartifactId=awesome-sauce -Dversion=3.0.0 -Dpackaging=jar -Dfile=/path/to/file

  Alternatively, if you host your own repository you can deploy the file there: 
      mvn deploy:deploy-file -DgroupId=com.example -DartifactId=awesome-sauce -Dversion=3.0.0 -Dpackaging=jar -Dfile=/path/to/file -Durl=[url] -DrepositoryId=[id]

  Path to dependency: 
        1) my.group:my-new-project:jar:1.0.0-SNAPSHOT
        2) com.example:awesome-sauce:jar:3.0.0

----------
1 required artifact is missing.

for artifact: 
  my.group:my-new-project:jar:1.0.0-SNAPSHOT

from the specified remote repositories:
  central (http://repo1.maven.org/maven2),
  clojars (http://clojars.org/repo/)</pre>
<p>Leiningen, which uses Maven 2 under the covers, produces similar output, but it mistakenly prints the current project name as <code>org.apache.maven:super-pom:jar:2.0</code>.</p>
<p>Maven 3 prints a less verbose (and less informative) error message, but the gist is the same.</p>
<h3>What happened?</h3>
<p>What is all this verbosity saying? Well, obviously, the build failed because something was missing. <em>What</em> was missing? Maven tells you:</p>
<pre>Missing:
----------
1) com.example:awesome-sauce:jar:3.0.0</pre>
<p>The JAR file for the project &#8220;awesome-sauce&#8221;, version 3.0.0, published in the &#8220;com.example&#8221; group, is missing. That just means Maven didn&#8217;t find it in any of the places it looked.</p>
<p>Where did it look? Maven tells you that too:</p>
<pre>from the specified remote repositories:
  central (http://repo1.maven.org/maven2),
  clojars (http://clojars.org/repo/)</pre>
<p>These are the public repositories where Maven searched for the file. Each repository has an ID (&#8220;central&#8221; and &#8220;clojars&#8221; in this case) and a URL. Both are specified in the configuration of:</p>
<ol>
<li>
<p>Your project, in pom.xml or project.clj</p>
</li>
<li>
<p>Your build tool&#8217;s global configuration file</p>
<ul>
<li>settings.xml for Maven</li>
<li>N/A for Leiningen</li>
</ul>
</li>
<li>
<p>Your build tool&#8217;s built-in defaults</p>
<ul>
<li>The <a href="http://repo1.maven.org/">Maven Central Repository</a> for almost any Maven-based tool</li>
<li><a href="http://clojars.org/">Clojars</a> for Leiningen</li>
</ul>
</li>
</ol>
<p>If you visit http://repo1.maven.org/maven2/com/example/awesome-sauce or http://clojars.org/repo/com/example/awesome-sauce in a browser you will see that those directories do not, in fact, exist.</p>
<p>Although it&#8217;s not listed, the first place Maven checks for a dependency is your <em>local</em> Maven repository. The local repository is just a big cache of everything Maven has downloaded in the past. It&#8217;s typically located at <code>$HOME/.m2/repository</code>.</p>
<h3>What to do next</h3>
<p>You have two options at this point:</p>
<ol>
<li>Find a public repository containing &#8220;awesome-sauce&#8221;</li>
<li>Install &#8220;awesome-sauce&#8221; in your local repository</li>
</ol>
<p>The first option is generally less work, and more repeatable if you ever build your project on another machine.</p>
<h3>Finding a repository</h3>
<p>Odds are, if the library you are looking for is free, open-source, and popular, it will already be in a public Maven repository somewhere. Start with the source: who released the library? Large organizations with a lot of open-source projects often host their own repositories, like <a href="http://code.google.com/p/google-maven-repository/">Google</a>  and <a href="http://repository.codehaus.org/">Codehaus</a>. Failing that, search engines such as <a href="http://mvnbrowser.com/">Mvnbrowser</a> may help you find it.</p>
<p>Once you&#8217;ve found a repository, you need to add it to your build. For example, to add the Codehaus repository to a Maven project, add these lines to pom.xml inside the <code>&lt;project&gt;</code> tag:</p>
<pre>&lt;repositories&gt;
  &lt;repository&gt;
    &lt;id&gt;codehaus&lt;/id&gt;
    &lt;name&gt;Codehaus&lt;/name&gt;
    &lt;url&gt;http://repository.codehaus.org/&lt;/url&gt;
  &lt;/repository&gt;
&lt;/repositories&gt;</pre>
<p>(You can pick your own <code>&lt;id&gt;</code> and <code>&lt;name&gt;</code>.)</p>
<p>For Leiningen, add the following lines inside the <code>(defproject&nbsp;...)</code> block:</p>
<pre>  :repositories {"codehaus" "http://repository.codehaus.org/"}</pre>
<h3>Installing locally</h3>
<p>If the library you want is not available in any public repository, you&#8217;re not stuck, you just have to do a bit more work. You need to get the JAR file for the library, either by downloading it manually or building from source. Then you need to install that JAR file in your local Maven repository. That&#8217;s easy, because Maven has already told you exactly how to do it:</p>
<pre>  Then, install it using the command: 
      mvn install:install-file -DgroupId=com.example -DartifactId=awesome-sauce \
 -Dversion=3.0.0 -Dpackaging=jar -Dfile=/path/to/file</pre>
<p>Copy that command verbatim, changing only <code>/path/to/file</code> to the path to the library&#8217;s JAR file. Maven will copy the file to <code>$HOME/.m2/repository/com/example/awesome-sauce/3.0.0/awesome-sauce-3.0.0.jar</code>. The next time you build your project, Maven knows exactly where to find it.</p>
<h3>Installing remotely</h3>
<p>If you want others to be able to build your project without having to go through these manual steps, you need your own public Maven repository to which you can upload files. Hosting a Maven repository isn&#8217;t hard: <a href="../2009/09/08/run-your-own-maven-repository.html">all you need is a web server</a>.</p>
<p>If you work with a team, consider setting up a shared repository for everyone to use. A repository manager such as <a href="http://nexus.sonatype.org/">Nexus</a> can help you take care of user accounts and authentication.</p>
<p>If you publish open-source libraries, I strongly encourage you to get an account on <a href="http://nexus.sonatype.org/oss-repository-hosting.html">Sonatype OSS</a>, a free service provided by the makers of Nexus. Releasing your projects to Sonatype OSS gives them a path to get added to the Maven Central Repository. While the requirements for projects in Maven Central are more stringent than just tossing code into your own repository, it&#8217;s worth the effort. In Maven Central, your project will have greater visibility and will be easier for anyone in the world to use.</p>
<h3>But what if I don&#8217;t want that dependency?</h3>
<p>Maven dependencies are transitive: if your project depends on project X, which depends on projects Y and Z, then your build will try to download X, Y, and Z.</p>
<p>But sometimes projects declare dependencies that aren&#8217;t strictly necessary. Or they declare dependencies on something you want, but the wrong version. How can you avoid including those extra dependencies in your build?</p>
<p>Maven supports <em>dependency exclusions</em> for these cases. For example, suppose the &#8220;awesome-sauce&#8221; library declares a dependency on &#8220;com.example:stupidity:0.0.1&#8221;. You know that you don&#8217;t need &#8220;stupidity&#8221; in your project, so you want to prevent the build from including it.  In pom.xml, you write:</p>
<pre>&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;awesome-sauce&lt;/artifactId&gt;
    &lt;version&gt;3.0.0&lt;/version&gt;
    &lt;exclusions&gt;
      &lt;exclusion&gt;
        &lt;groupId&gt;com.example&lt;/groupId&gt;
        &lt;artifactId&gt;stupidity&lt;/artifactId&gt;
      &lt;/exclusion&gt;
    &lt;/exclusions&gt; 
  &lt;/dependency&gt;
&lt;/dependencies&gt;</pre>
<p>Or in Leiningen&#8217;s project.clj, you write:</p>
<pre>  :dependencies [[com.example/awesome-sauce "3.0.0"
                  :exclusions [com.example/stupidity]]]</pre>
<p>Note that once you start using exclusions, you&#8217;re on your own. It&#8217;s up to you to make sure you still have the correct versions of all the libraries your project needs. </p>
<p>On rare occasions, a project&#8217;s dependencies cannot be resolved at all. In particular, if you need two different versions of the same library with the same class names but incompatible APIs, you&#8217;re pretty much stuck. Time to refactor, or investigate multiple-Classloader schemes like <a href="http://www.osgi.org/">OSGi</a>. But that&#8217;s a whole &#8216;nother story.</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2011/06/01/dependency-management.html" rel="bookmark"><time class="entry-date published" datetime="2011-06-01T14:08:36+00:00">June 1, 2011</time><time class="updated" datetime="2011-06-01T14:09:07+00:00">June 1, 2011</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="../tag/clojure.html" rel="tag">Clojure</a>, <a href="../tag/java.html" rel="tag">Java</a>, <a href="../tag/leiningen.html" rel="tag">Leiningen</a>, <a href="../tag/maven.html" rel="tag">Maven</a></span><span class="comments-link"><a href="../2011/06/01/dependency-management.html#comments">2 Comments<span class="screen-reader-text"> on Dependency Management First-Aid Kit</span></a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-527" class="post-527 post type-post status-publish format-standard hentry category-programming tag-clojure tag-speaking">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="../2011/03/11/uberconf-denver.html" rel="bookmark">Speaking at ÜberConf Denver in July</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>I&#8217;ll be speaking at <a href="http://uberconf.com/conference/denver/2011/07/home">Über Conf 2011</a> In Denver, CO July 12th to 15th.</p>
<p>I&#8217;m doing three (gulp!) <a href="http://uberconf.com/conference/denver/2011/07/speakers/stuart_sierra">sessions</a>: two on Clojure, and one on my work with AltLaw.org.</p>
<p><img src="../wp-content/uploads/2011/03/UberConf_125x125_speaking.png" alt="&quot;I&#039;m speaking at Uber Conf&quot; banner" title="UberConf_speaker_banner" width="125" height="125" class="alignnone size-full wp-image-528" /></p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2011/03/11/uberconf-denver.html" rel="bookmark"><time class="entry-date published" datetime="2011-03-11T18:01:28+00:00">March 11, 2011</time><time class="updated" datetime="2011-05-02T12:02:36+00:00">May 2, 2011</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="../tag/clojure.html" rel="tag">Clojure</a>, <a href="../tag/speaking.html" rel="tag">Speaking</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-522" class="post-522 post type-post status-publish format-standard hentry category-programming tag-clojure">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="../2011/02/15/clojure-in-philadelphia-april-27-28.html" rel="bookmark">Clojure in Philadelphia, April 27-28</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p><a href="http://phillyemergingtech.com/2011"><img class="alignnone size-full wp-image-523" title="2011-ete-speaker-badge" src="../wp-content/uploads/2011/02/2011-ete-speaker-badge.jpg" alt="I'm speaking at Emerging Technologies for the Enterprise Conference, April 27-28, 2011" width="168" height="138" /></a></p>
<p>I&#8217;ll be talking about Clojure at <a href="http://phillyemergingtech.com/2011/">Emerging Technologies for the Enterprise</a> in Phidelphia, April 27-28, 2011.</p>
<p>My talk is tentatively titled <a href="http://phillyemergingtech.com/2011/sessions/clojure-lisp-for-the-real-world">Clojure: Lisp for the Real World</a>, and it will be a high-level overview of how Clojure&#8217;s unique features can solve real, pervasive problems in large software systems.</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2011/02/15/clojure-in-philadelphia-april-27-28.html" rel="bookmark"><time class="entry-date published updated" datetime="2011-02-15T18:11:12+00:00">February 15, 2011</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="../tag/clojure.html" rel="tag">Clojure</a></span><span class="comments-link"><a href="../2011/02/15/clojure-in-philadelphia-april-27-28.html#comments">1 Comment<span class="screen-reader-text"> on Clojure in Philadelphia, April 27-28</span></a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-518" class="post-518 post type-post status-publish format-standard hentry category-programming tag-clojure">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="../2011/01/09/edit-quotient.html" rel="bookmark">Edit Quotient</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>Remember <a href="http://en.wikipedia.org/wiki/Levenshtein_distance">Levenshtein Distance</a>: the number of changes to turn one string into another? Here&#8217;s a naïve implementation in Clojure:</p>
<pre>(defn levenshtein [s t]
  (let [m (count s)
        n (count t)
        d (make-array Integer/TYPE (inc m) (inc n))]
    (dotimes [i m] (aset-int d i 0 i))
    (dotimes [j n] (aset-int d 0 j j))
    (doseq [j (range 1 (inc n))]
      (doseq [i (range 1 (inc m))]
        (if (= (.charAt s (dec i)) (.charAt t (dec j)))
          (aset-int d i j (aget d (dec i) (dec j)))
          (aset-int d i j (min (inc (aget d (dec i) j))
                               (inc (aget d i (dec j)))
                               (inc (aget d (dec i) (dec j))))))))
    (aget d m n)))

(assert (= 0 (levenshtein "" "")))
(assert (= 3 (levenshtein "foo" "foobar")))
(assert (= 3 (levenstein "kitten" "sitting")))
(assert (= 3 (levenstein "Saturday" "Sunday")))</pre>
<p>I ripped that straight off Wikipedia&#8217;s pseudocode. Not functional at all, and probably not particularly efficient either.</p>
<p>But I&#8217;ve never seen this: the number of changes to turn one string into another, scaled by the lengths of the strings. Call it the &#8220;edit quotient,&#8221; computed as the Levenshtein Distance divided by the mean of the lengths of the two strings. The edit quotient of two empty strings is zero.</p>
<pre>(defn edit-quotient [s t]
  (let [sum (+ (count s) (count t))]
    (if (pos? sum)
      (/ (levenstein s t)
         (/ sum 2))
      0)))

(assert (= 0 (edit-quotient "" "")))
(assert (= 0 (edit-quotient "foof" "")))
(assert (= 1 (edit-quotient "foo" "bar")))
(assert (= 6/7 (edit-quotient "foof" "bar")))
(assert (= 2/3 (edit-quotient "foo" "faa")))
(assert (= 2/7 (edit-quotient "foof" "foo")))
(assert (= 1/2 (edit-quotient "foobar" "faabir")))</pre>
<p>This has some interesting properties. The edit quotient is zero if the two strings are completely identical, one if they are completely different. Values in between zero and one give some idea of how different the strings are.</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2011/01/09/edit-quotient.html" rel="bookmark"><time class="entry-date published updated" datetime="2011-01-09T21:47:08+00:00">January 9, 2011</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="../tag/clojure.html" rel="tag">Clojure</a></span><span class="comments-link"><a href="../2011/01/09/edit-quotient.html#comments">3 Comments<span class="screen-reader-text"> on Edit Quotient</span></a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-516" class="post-516 post type-post status-publish format-standard hentry category-programming tag-clojure tag-java">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="../2010/12/16/single-abstract-method-macro.html" rel="bookmark">Single Abstract Method Macro</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>John Rose&#8217;s article, <a href="http://blogs.sun.com/jrose/entry/scheme_in_one_class">Scheme in One Class</a>, introduced me to the notion of <a href="http://www.infoq.com/news/2010/07/sambdas-in-java">Single Abstract Method</a>, or SAM, classes. One of the <a href="http://cr.openjdk.java.net/~jrose/pres/indy-javadoc-mlvm-1209/java/dyn/MethodHandles.html#asInstance(java.dyn.MethodHandle,%20java.lang.Class)">proposed APIs</a> for JSR-292 allows a <code>MethodHandle</code> (the Java version of a closure) to be cast to any SAM class.</p>
<p>In Java, a SAM can be either an interface or a class, but if it&#8217;s a class then it&#8217;s usually abstract. The interface or class has exactly one method. Callbacks are often specified as SAM interfaces. The standard Java library has lots of SAM interfaces, such as Runnable and ActionListener.</p>
<p>In Clojure, it&#8217;s easy to interoperate with these Java interfaces with <code>reify</code> (or <code>proxy</code> for abstract classes) but it&#8217;s tiresome to type out. Since reflection can give us the name of the method, why not let the compiler do the work for us?</p>
<pre>(defmacro single-method
  "Returns a proxied or reified instance of c, which must be a class
  or interface with exactly one method. Forwards method calls to the
  function f, which must accept the same number of arguments as the
  method, not including the 'this' argument.

  If c is a class, not an interface, then it must have a public,
  no-argument constructor."
  [c f]
  {:pre [(symbol? c)]}
  (let [klass (resolve c)]
    (assert (instance? java.lang.Class klass))
    (let [methods (.getDeclaredMethods klass)]
      (assert (= 1 (count methods)))
      (let [method (first methods)
            method-name (symbol (.getName method))
            arg-count (count (.getParameterTypes method))
            args (repeatedly arg-count gensym)]
        (if (.isInterface klass)
          `(let [f# ~f]
             (reify ~c (~method-name ~(vec (cons (gensym "this") args))
                                     (f# ~@args))))
          `(let [f# ~f]
             (proxy [~c] [] (~method-name ~(vec args) (f# ~@args)))))))))</pre>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2010/12/16/single-abstract-method-macro.html" rel="bookmark"><time class="entry-date published updated" datetime="2010-12-16T18:55:01+00:00">December 16, 2010</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="../tag/clojure.html" rel="tag">Clojure</a>, <a href="../tag/java.html" rel="tag">Java</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

	<nav class="navigation pagination" role="navigation">
		<h2 class="screen-reader-text">Posts navigation</h2>
		<div class="nav-links"><a class="prev page-numbers" href="4.html">Previous page</a>
<a class='page-numbers' href='../index.html'><span class="meta-nav screen-reader-text">Page </span>1</a>
<span class="page-numbers dots">&hellip;</span>
<a class='page-numbers' href='4.html'><span class="meta-nav screen-reader-text">Page </span>4</a>
<span class='page-numbers current'><span class="meta-nav screen-reader-text">Page </span>5</span>
<a class='page-numbers' href='6.html'><span class="meta-nav screen-reader-text">Page </span>6</a>
<span class="page-numbers dots">&hellip;</span>
<a class='page-numbers' href='24.html'><span class="meta-nav screen-reader-text">Page </span>24</a>
<a class="next page-numbers" href="6.html">Next page</a></div>
	</nav>
		</main><!-- .site-main -->
	</div><!-- .content-area -->


	<aside id="secondary" class="sidebar widget-area" role="complementary">
		<section id="search-3" class="widget widget_search">
<form role="search" method="get" class="search-form" action="https://stuartsierra.com/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
	</label>
	<button type="submit" class="search-submit"><span class="screen-reader-text">Search</span></button>
</form>
</section><section id="text-4" class="widget widget_text">			<div class="textwidget"><ul>
<li><a href="http://feeds2.feedburner.com/StuartSierra" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="../comments/feed" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
</ul>
<ul>
<li><a href="https://twitter.com/stuartsierra">Twitter</a></li>
<li><a href="https://github.com/stuartsierra">GitHub</a></li>
</ul></div>
		</section><section id="tag-widget-2" class="widget TagWidget"><h2 class="widget-title">Clojure Do’s and Don’ts</h2><ul class = "posts-by-tag-list"><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-883"><a class = "posts-by-tag-item-title" href="../2015/08/25/clojure-donts-lazy-effects.html">Clojure Don’ts: Lazy Effects</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-877"><a class = "posts-by-tag-item-title" href="../2015/08/10/clojure-donts-redundant-map.html">Clojure Don’ts: Redundant map</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-870"><a class = "posts-by-tag-item-title" href="../2015/06/16/clojure-donts-single-branch-if.html">Clojure Don’ts: Single-branch if</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-854"><a class = "posts-by-tag-item-title" href="../2015/06/10/clojure-donts-heisenparameter.html">Clojure Don’ts: The Heisenparameter</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-849"><a class = "posts-by-tag-item-title" href="../2015/06/01/clojure-donts-optional-arguments-with-varargs.html">Clojure Don’ts: Optional Arguments with Varargs</a></li><li class="posts-by-tag-item Clojure do's and don'ts errors" id="posts-by-tag-item-836"><a class = "posts-by-tag-item-title" href="../2015/05/27/clojure-uncaught-exceptions.html">Clojure Do’s: Uncaught Exceptions</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-831"><a class = "posts-by-tag-item-title" href="../2015/05/17/clojure-record-constructors.html">Record Constructors</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-826"><a class = "posts-by-tag-item-title" href="../2015/05/10/clojure-namespace-aliases.html">Clojure Do’s: Namespace Aliases</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-820"><a class = "posts-by-tag-item-title" href="../2015/05/02/clojure-donts-isa.html">Clojure Don’ts: isa?</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-812"><a class = "posts-by-tag-item-title" href="../2015/04/26/clojure-donts-concat.html">Clojure Don’ts: Concat</a></li></ul></section>	</aside><!-- .sidebar .widget-area -->

		</div><!-- .site-content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
							<nav class="main-navigation" role="navigation" aria-label="Footer Primary Menu">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="primary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-635"><a href="../about-me.html">About Me</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-633"><a href="../writing.html">Writing</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-634"><a href="../presentations.html">Presentations</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-636"><a href="../software.html">Software</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-637"><a href="../contact.html">Contact</a></li>
</ul></div>				</nav><!-- .main-navigation -->
			
			
			<div class="site-info">
								<span class="site-title"><a href="../index.html" rel="home">Digital Digressions by Stuart Sierra</a></span>
				<a href="https://wordpress.org/">Proudly powered by WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- .site-footer -->
	</div><!-- .site-inner -->
</div><!-- .site -->

	<div style="display:none">
	<div class="grofile-hash-map-55878d0196b91803f9cb2c372b0551d3">
	</div>
	</div>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201635'></script>
<script type='text/javascript' src='https://secure.gravatar.com/js/gprofiles.js?ver=2016Sepaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='../wp-content/plugins/jetpack/modules/wpgroho167b.js?ver=4.6'></script>
<script type='text/javascript' src='../wp-content/themes/twentysixteen/js/skip-link-focus-fix8de4.js?ver=20160816'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var screenReaderText = {"expand":"expand child menu","collapse":"collapse child menu"};
/* ]]> */
</script>
<script type='text/javascript' src='../wp-content/themes/twentysixteen/js/functions8de4.js?ver=20160816'></script>
<script type='text/javascript' src='../wp-includes/js/wp-embed.min167b.js?ver=4.6'></script>
<script type='text/javascript' src='https://stats.wp.com/e-201635.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:4.2.2',blog:'2702563',post:'0',tz:'-4',srv:'stuartsierra.com'} ]);
	_stq.push([ 'clickTrackerInit', '2702563', '0' ]);
</script>
</body>

<!-- Mirrored from stuartsierra.com/page/5 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 02 Sep 2016 17:03:30 GMT -->
</html>

<!-- Dynamic page generated in 0.398 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2016-09-02 13:02:29 -->

<!-- Compression = gzip -->