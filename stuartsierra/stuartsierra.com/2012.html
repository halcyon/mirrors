<!DOCTYPE html>
<html lang="en-US" class="no-js">

<!-- Mirrored from stuartsierra.com/2012 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 02 Sep 2016 16:59:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="http://gmpg.org/xfn/11">
		<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>2012 &#8211; Digital Digressions by Stuart Sierra</title>
<link rel='dns-prefetch' href='http://s0.wp.com/'>
<link rel='dns-prefetch' href='http://secure.gravatar.com/'>
<link rel='dns-prefetch' href='http://fonts.googleapis.com/'>
<link rel='dns-prefetch' href='http://s.w.org/'>
<link rel="alternate" type="application/rss+xml" title="Digital Digressions by Stuart Sierra &raquo; Feed" href="http://feeds2.feedburner.com/StuartSierra" />
<link rel="alternate" type="application/rss+xml" title="Digital Digressions by Stuart Sierra &raquo; Comments Feed" href="comments/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/stuartsierra.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='twentysixteen-jetpack-css'  href='wp-content/plugins/jetpack/modules/theme-tools/compat/twentysixteen3a05.css?ver=4.2.2' type='text/css' media='all' />
<link rel='stylesheet' id='twentysixteen-fonts-css'  href='https://fonts.googleapis.com/css?family=Merriweather%3A400%2C700%2C900%2C400italic%2C700italic%2C900italic%7CMontserrat%3A400%2C700%7CInconsolata%3A400&amp;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='wp-content/plugins/jetpack/_inc/genericons/genericons/genericons128b.css?ver=3.1' type='text/css' media='all' />
<link rel='stylesheet' id='twentysixteen-style-css'  href='wp-content/themes/twentysixteen/style167b.css?ver=4.6' type='text/css' media='all' />
<!--[if lt IE 10]>
<link rel='stylesheet' id='twentysixteen-ie-css'  href='https://stuartsierra.com/wp-content/themes/twentysixteen/css/ie.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentysixteen-ie8-css'  href='https://stuartsierra.com/wp-content/themes/twentysixteen/css/ie8.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 8]>
<link rel='stylesheet' id='twentysixteen-ie7-css'  href='https://stuartsierra.com/wp-content/themes/twentysixteen/css/ie7.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='jetpack_css-css'  href='wp-content/plugins/jetpack/css/jetpack3a05.css?ver=4.2.2' type='text/css' media='all' />
<script type='text/javascript' src='wp-includes/js/jquery/jqueryb8ff.js?ver=1.12.4'></script>
<script type='text/javascript' src='wp-includes/js/jquery/jquery-migrate.min330a.js?ver=1.4.1'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://stuartsierra.com/wp-content/themes/twentysixteen/js/html5.js?ver=3.7.3'></script>
<![endif]-->
<link rel='https://api.w.org/' href='wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.6" />

<link rel='dns-prefetch' href='http://v0.wordpress.com/'>
</head>

<body class="archive date hfeed">
<div id="page" class="site">
	<div class="site-inner">
		<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

		<header id="masthead" class="site-header" role="banner">
			<div class="site-header-main">
				<div class="site-branding">
					
											<p class="site-title"><a href="index.html" rel="home">Digital Digressions by Stuart Sierra</a></p>
											<p class="site-description">From programming to everything else</p>
									</div><!-- .site-branding -->

									<button id="menu-toggle" class="menu-toggle">Menu</button>

					<div id="site-header-menu" class="site-header-menu">
													<nav id="site-navigation" class="main-navigation" role="navigation" aria-label="Primary Menu">
								<div class="menu-main-menu-container"><ul id="menu-main-menu" class="primary-menu"><li id="menu-item-635" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-635"><a href="about-me.html">About Me</a></li>
<li id="menu-item-633" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-633"><a href="writing.html">Writing</a></li>
<li id="menu-item-634" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-634"><a href="presentations.html">Presentations</a></li>
<li id="menu-item-636" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-636"><a href="software.html">Software</a></li>
<li id="menu-item-637" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-637"><a href="contact.html">Contact</a></li>
</ul></div>							</nav><!-- .main-navigation -->
						
											</div><!-- .site-header-menu -->
							</div><!-- .site-header-main -->

											<div class="header-image">
					<a href="index.html" rel="home">
						<img src="wp-content/uploads/2015/12/header.jpg" srcset="https://stuartsierra.com/wp-content/uploads/2015/12/header-300x70.jpg 300w, https://stuartsierra.com/wp-content/uploads/2015/12/header-768x179.jpg 768w, https://stuartsierra.com/wp-content/uploads/2015/12/header-1024x239.jpg 1024w, https://stuartsierra.com/wp-content/uploads/2015/12/header.jpg 1200w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 81vw, (max-width: 1362px) 88vw, 1200px" width="1200" height="280" alt="Digital Digressions by Stuart Sierra">
					</a>
				</div><!-- .header-image -->
					</header><!-- .site-header -->

		<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			<header class="page-header">
				<h1 class="page-title">Year: 2012</h1>			</header><!-- .page-header -->

			
<article id="post-659" class="post-659 post type-post status-publish format-standard hentry category-programming tag-clojure">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="2012/09/12/when-to-write-a-macro.html" rel="bookmark">When (Not) to Write a Macro</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">The Solution in Search of a Problem</h2>
<div class="outline-text-2" id="text-1">
<p>
A few months ago I wrote an article called <a href="2012/05/16/syntactic-pipelines.html">Syntactic Pipelines</a>, about a style of programming (in Clojure) in which each function takes and returns a map with similar structure:
</p>
<pre class="src src-clojure">(<span class="org-keyword">defn</span> <span class="org-function-name">subprocess-one</span> [data]
  (<span class="org-builtin">let</span> [{<span class="org-constant">:keys</span> [alpha beta]} data]
    (<span class="org-builtin">-&gt;</span> data
        (<span class="org-variable-name">assoc</span> <span class="org-constant">:epsilon</span> (compute-epsilon alpha))
        (<span class="org-variable-name">update-in</span> [<span class="org-constant">:gamma</span>] merge (compute-gamma beta)))))

<span class="org-comment-delimiter">;; </span><span class="org-comment">...</span>

(<span class="org-keyword">defn</span> <span class="org-function-name">large-process</span> [input]
  (<span class="org-builtin">-&gt;</span> input
      subprocess-one
      subprocess-two
      subprocess-three))
</pre>
<p>
In that article, I defined a pair of macros that allow the preceding example to be written like this:
</p>
<pre class="src src-clojure">(<span class="org-keyword">defpipe</span> <span class="org-function-name">subprocess-one</span> [alpha beta]
  (return (<span class="org-constant">:set</span> <span class="org-constant">:epsilon</span> (compute-epsilon alpha))
          (<span class="org-constant">:update</span> <span class="org-constant">:gamma</span> merge (compute-gamma beta))))

(<span class="org-keyword">defpipeline</span> <span class="org-function-name">large-process</span>
  subprocess-one
  subprocess-two
  subprocess-three)
</pre>
<p>
I wanted to demonstrate the possibilities of using macros to build abstractions out of common syntactic patterns. My example, however, was poorly chosen.
</p>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="sec-2">The Problem with the Solution</h2>
<div class="outline-text-2" id="text-2">
<p>
Every choice we make while programming has an associated cost. In the case of macros, that cost is usually borne by the person reading or maintaining the code.
</p>
<p>
In the case of <code>defpipe</code>, the poor sap stuck maintaining my code (maybe my future self!) has to know that it defines a function that takes a single map argument, despite the fact that it <i>looks</i> like a function that takes multiple arguments. That&#8217;s readily apparent if you read the docstring, but the docstring still has to be read and understood before the code makes sense.
</p>
<p>
The <code>return</code> macro is even worse. First of all, the fact that <code>return</code> is only usable within <code>defpipe</code> hints at some hidden coupling between the two, which is exactly what it is. Secondly, the word <i>return</i> is commonly understood to mean an immediate exit from a function. Clojure does not support non-tail function returns, and my macro does not add them, so the name <code>return</code> is confusing.
</p>
<p>
Using <code>return</code> correctly requires that the user first understand the <code>defpipe</code> macro, then understand the &#8220;mini language&#8221; I have created in the body of <code>return</code>, and also know that <code>return</code> only works in tail position inside of <code>defpipe</code>.
</p>
</div>
</div>
<div id="outline-container-3" class="outline-2">
<h2 id="sec-3">Is it Worth It?</h2>
<div class="outline-text-2" id="text-3">
<p>
Confusion, lack of clarity, and time spent reading docs: Those are the costs. The benefits are comparatively meager. Using the macros, my example is shorter by a couple of lines, one <code>let</code>, and some destructuring.
</p>
<p>
In short, the costs outweigh the benefits. Code using the <code>defpipe</code> macro is actually <i>worse</i> than code without the macro because it requires more effort to read. That&#8217;s not to say that the pipeline pattern I&#8217;ve described isn&#8217;t useful: It is. But my macros haven&#8217;t improved on that pattern enough to be worth their cost.
</p>
<p>
That&#8217;s the crux of the argument about macros. Whenever you think about writing one, ask yourself, &#8220;Is it worth it?&#8221; Is the benefit provided by the macro &ndash; in brevity, clarity, or power &ndash; worth the cost, in time, for you or someone else to understand it later? If the answer is anything but a resounding &#8220;yes&#8221; then you probably shouldn&#8217;t be writing a macro.
</p>
<p>
Of course, the same question can (and should) be asked of any code we write. Macros are a special case because they are so powerful that the cost of maintaining them is higher than that of &#8220;normal&#8221; code. Functions and values have semantics that are specified by the language and universally understood; macros can define their own languages. Buyer beware.
</p>
<p>
I still got some value out of the original post as an intellectual exercise, but it&#8217;s not something I&#8217;m going to put to use in my production code.
</p>
</div>
</div>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="2012/09/12/when-to-write-a-macro.html" rel="bookmark"><time class="entry-date published" datetime="2012-09-12T08:15:18+00:00">September 12, 2012</time><time class="updated" datetime="2013-03-27T20:07:09+00:00">March 27, 2013</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="tag/clojure.html" rel="tag">Clojure</a></span><span class="comments-link"><a href="2012/09/12/when-to-write-a-macro.html#comments">2 Comments<span class="screen-reader-text"> on When (Not) to Write a Macro</span></a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-629" class="post-629 post type-post status-publish format-standard hentry category-programming tag-clojure tag-clojurescript tag-javascript">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="2012/06/16/why-im-using-clojurescript.html" rel="bookmark">Why I&#8217;m Using ClojureScript</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>Elise Huard wrote about <a href="http://jabberwocky.eu/2012/06/16/why-im-not-using-clojurescript/">why she&#8217;s not using ClojureScript</a>. To quote her essential point, <em>&#8220;The browser doesn&#8217;t speak clojure, it speaks javascript.&#8221;</em>
</p>
<p>
This is true. But the CPU doesn&#8217;t speak Clojure either, or JavaScript. This argument against ClojureScript is similar to arguments made against any high-level language which compiles down to a lower-level representation. Once upon a time, I feel sure, the same argument was made against FORTRAN.
</p>
<p>
A new high-level language has to overcome a period of skepticism from those who are already comfortable programming in the lower-level representation. A young compiler struggles to produce code as efficient as that hand-optimized by an expert. But compilers tend to get better over time, and some smart folks are working hard on <a href="http://www.50ply.com/cljs-bench/">making ClojureScript fast</a>. ClojureScript applications can get the benefit of improvements in the compiler without changing their source code, just as Clojure applications benefit from years of JVM optimizations.
</p>
<p>
To address Huard&#8217;s other points in order:
</p>
<p>
<i>1. Compiled ClojureScript code is hard to read, therefore hard to debug.</i>
</p>
<p>
This has not been an issue for me. In development mode (no optimizations, with pretty-printing) ClojureScript compiles to JavaScript which is, in my opinion, fairly readable. Admittedly, I know Clojure much better than I know JavaScript. The greater challenge for me has been working with the highly-dynamic nature of JavaScript execution in the browser. For example, a function called with the wrong number of arguments will not trigger an immediate error. Perhaps ClojureScript can evolve to catch more of these errors at compile time.
</p>
<p>
<em>2. ClojureScript forces the inclusion of the <a href="https://developers.google.com/closure/library/">Google Closure Library</a>.</em>
</p>
<p>
This is mitigated by the <a href="https://developers.google.com/closure/compiler/">Google Closure Compiler</a>&#8216;s dead-code elimination and aggressive space optimizations. You only pay, in download size, for what you use. For example, <a href="http://code.jquery.com/jquery-1.7.2.min.js">jQuery 1.7.2</a> is 33K, minified and gzipped. <a href="http://samsaffron.com/archive/2012/02/17/stop-paying-your-jquery-tax">Caching doesn&#8217;t always save you</a>. &#8220;Hello World&#8221; in ClojureScript, optimized and gzipped, is 18K.
</p>
<p>
<i>3. Hand-tuning performance is harder in a higher-level language.</i>
</p>
<p>
This is true, as per my comments above about high-level languages. Again, this has not been an issue for me, but you can always &#8220;drop down&#8221; to JavaScript for specialized optimizations.
</p>
<p>
<i>4. Cross-browser compatibility is hard.</i>
</p>
<p>
This is, as Huard admits, unavoidable in any language. The Google Closure Libraries help with some of the basics, and ClojureScript libraries such as <a href="https://github.com/levand/domina">Domina</a> are evolving to deal with other browser-compatibility issues. You also have the entire world of JavaScript libraries to paper over browser incompatibilities.
</p>
<p style="text-align:center">* * *</p>
<p>
Overall, I think I would agree with Elise Huard when it comes to browser programming &#8220;in the small.&#8221; If you just want to add some dynamic behavior to an HTML form, then ClojureScript has little advantage over straight JavaScript, jQuery, and whatever other libraries you favor.
</p>
<p>
What ClojureScript allows you to do is tackle browser-based programming &#8220;in the large.&#8221; I&#8217;ve found it quite rewarding to develop entire applications in ClojureScript, something I would have been reluctant to attempt in JavaScript.
</p>
<p>
It&#8217;s partially a matter of taste and familiarity. Clojure programmers such as myself will likely prefer ClojureScript over JavaScript. Experienced JavaScript programmers will have less to gain &mdash; and more work to do, learning a new language &mdash; by adopting ClojureScript. JavaScript is indeed &#8220;good enough&#8221; for a lot of applications, which means ClojureScript has to work even harder to prove its worth. I still believe that ClojureScript has an edge over JavaScript in the long run, but that edge will be less immediately obvious than the advantage that, say, Clojure on the JVM has over Java.</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="2012/06/16/why-im-using-clojurescript.html" rel="bookmark"><time class="entry-date published updated" datetime="2012-06-16T17:36:15+00:00">June 16, 2012</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="tag/clojure.html" rel="tag">Clojure</a>, <a href="tag/clojurescript.html" rel="tag">ClojureScript</a>, <a href="tag/javascript.html" rel="tag">JavaScript</a></span><span class="comments-link"><a href="2012/06/16/why-im-using-clojurescript.html#comments">4 Comments<span class="screen-reader-text"> on Why I&#8217;m Using ClojureScript</span></a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-624" class="post-624 post type-post status-publish format-standard hentry category-programming tag-clojure tag-macros">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="2012/05/16/syntactic-pipelines.html" rel="bookmark">Syntactic Pipelines</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<style type="text/css">
  .org-constant {
     color: purple;
  }</p>
<p>  .org-string {
     color: green;
  }</p>
<p>  .org-comment {
     color: darkred;
  }</p>
<p>  .org-comment-delimiter {
     color: darkred;
  }</p>
<p>  .org-keyword, .org-builtin, .org-variable-name {
     color: blue;
  }
  </style>
<p>
Lately I&#8217;ve been thinking about Clojure programs written in this &#8220;threaded&#8221; or &#8220;pipelined&#8221; style:
</p>
<pre class="src src-clojure">(<span class="org-keyword">defn</span> <span class="org-function-name">large-process</span> [input]
  (<span class="org-builtin">-&gt;</span> input
      subprocess-one
      subprocess-two
      subprocess-three))
</pre>
<p>
If you saw my talk at Clojure/West (<a href="http://clojurewest.org/news/2012/5/11/clojurewest-video-schedule.html">video forthcoming</a>) this should look familiar. The value being &#8220;threaded&#8221; by the <code>-&gt;</code> macro from one <i>subprocess-</i> function to the next is usually a map, and each subprocess can add, remove, or update keys in the map. A typical subprocess function might look something like this:
</p>
<pre class="src src-clojure">(<span class="org-keyword">defn</span> <span class="org-function-name">subprocess-two</span> [data]
  (<span class="org-builtin">let</span> [{<span class="org-constant">:keys</span> [alpha beta]} data]
    (<span class="org-builtin">-&gt;</span> data
        (<span class="org-variable-name">assoc</span> <span class="org-constant">:epsilon</span> (compute-epsilon alpha))
        (<span class="org-variable-name">update-in</span> [<span class="org-constant">:gamma</span>] merge (compute-gamma beta)))))
</pre>
<p>
Most subprocess functions, therefore, have a similar structure: they begin by destructuring the input map and end by performing updates to that same map.
</p>
<p>
This style of programming tends to produce slightly longer code than would be obtained by writing larger functions with <code>let</code> bindings for intermediate values, but it has some advantages. The structure is immediately apparent: someone reading the code can get a high-level overview of what the code does simply by looking at the outer-most function, which, due to the single-pass design of Clojure&#8217;s compiler, will always be at the bottom of a file. It&#8217;s also easy to insert new functions into the process: as long as they accept and return a map with the same structure, they will not interfere with the existing functions.
</p>
<p>
The only problem with this code from a readability standpoint is the visual clutter of repeatedly destructuring and updating the same map. (It&#8217;s possible to move the destructuring into the function argument vector, but it&#8217;s still messy.)
</p>
<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">defpipe</h2>
<div class="outline-text-2" id="text-1">
<p>
What if we could clean up the syntax without changing the behavior? That&#8217;s exactly what macros are good for. Here&#8217;s a first attempt:
</p>
<pre class="src src-clojure">(<span class="org-keyword">defmacro</span> <span class="org-function-name">defpipe</span> [name argv &amp; body]
  `(<span class="org-keyword">defn</span> <span class="org-function-name">~name</span> [arg#]
     (<span class="org-builtin">let</span> [{<span class="org-constant">:keys</span> ~argv} arg#]
       ~@body)))
</pre>
<pre class="src src-clojure">(<span class="org-variable-name">macroexpand-1</span> '(<span class="org-keyword">defpipe</span> <span class="org-function-name">foo</span> [a b c] ...))
<span class="org-comment-delimiter">;;</span><span class="org-comment">=&gt; (clojure.core/defn foo [arg_47_auto]</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(clojure.core/let [{:keys [a b c]} arg_47_auto] ...))</span>
</pre>
<p>
That doesn&#8217;t quite work: we&#8217;ve eliminated the <code>:keys</code> destructuring, but lost the original input map.
</p>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="sec-2">return</h2>
<div class="outline-text-2" id="text-2">
<p>
What if we make a second macro specifically for updating the input map?
</p>
<pre class="src src-clojure">(<span class="org-keyword">def</span> <span class="org-constant">^:private</span> <span class="org-function-name">pipe-arg</span> (<span class="org-variable-name">gensym</span> <span class="org-string">"pipeline-argument"</span>))

(<span class="org-keyword">defmacro</span> <span class="org-function-name">defpipe</span> [name argv &amp; body]
  `(<span class="org-keyword">defn</span> <span class="org-function-name">~name</span> [~pipe-arg]
     (<span class="org-builtin">let</span> [{<span class="org-constant">:keys</span> ~argv} ~pipe-arg]
       ~@body)))

(<span class="org-keyword">defn-</span> <span class="org-function-name">return-clause</span> [spec]
  (<span class="org-builtin">let</span> [[command sym &amp; body] spec]
    (<span class="org-builtin">case</span> command
      <span class="org-constant">:update</span> `(<span class="org-variable-name">update-in</span> [~(<span class="org-variable-name">keyword</span> (<span class="org-variable-name">name</span> sym))] ~@body)
      <span class="org-constant">:set</span>    `(<span class="org-variable-name">assoc</span> ~(<span class="org-variable-name">keyword</span> (<span class="org-variable-name">name</span> sym)) ~@body)
      <span class="org-constant">:remove</span> `(<span class="org-variable-name">dissoc</span> ~(<span class="org-variable-name">keyword</span> (<span class="org-variable-name">name</span> sym)) ~@body)
      body)))

(<span class="org-keyword">defmacro</span> <span class="org-function-name">return</span> [&amp; specs]
  `(<span class="org-builtin">-&gt;</span> ~pipe-arg
       ~@(<span class="org-variable-name">map</span> return-clause specs)))
</pre>
<p>
This requires some more explanation. The <code>return</code> macro works in tandem with <code>defpipe</code>, and provides a mini-language for threading the input map through a series of transformations. So it can be used like this:
</p>
<pre class="src src-clojure">(<span class="org-keyword">defpipe</span> <span class="org-function-name">foo</span> [a b]
  (return (<span class="org-constant">:update</span> a + 10)
          (<span class="org-constant">:remove</span> b)
          (<span class="org-constant">:set</span> c a)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">which expands to:</span>
(<span class="org-keyword">defn</span> <span class="org-function-name">foo</span> [input]
  (<span class="org-builtin">let</span> [{<span class="org-constant">:keys</span> [a b]} input]
    (<span class="org-builtin">-&gt;</span> input
        (<span class="org-variable-name">update-in</span> [<span class="org-constant">:a</span>] + 10)
        (<span class="org-variable-name">dissoc</span> <span class="org-constant">:b</span>)
        (<span class="org-variable-name">assoc</span> <span class="org-constant">:c</span> a))))
</pre>
<p>
As a fallback, we can put any old expression inside the <code>return</code>, and it will be just as if we had used it in the <code>-&gt;</code> macro. The rest of the code inside <code>defpipe</code>, before <code>return</code>, is a normal function body. The <code>return</code> can appear anywhere inside <code>defpipe</code>, as long as it is in tail position.
</p>
<p>
The symbol used for the input argument has to be the same in both <code>defpipe</code> and <code>return</code>, so we define it once and use it again. This is safe because that symbol is not exposed anywhere else, and the <code>gensym</code> ensures that it is unique.
</p>
</div>
</div>
<div id="outline-container-3" class="outline-2">
<h2 id="sec-3">defpipeline</h2>
<div class="outline-text-2" id="text-3">
<p>
Now that we have the <code>defpipe</code> macro, it&#8217;s trivial to add another macro for defining the composition of functions created with <code>defpipe</code>:
</p>
<pre class="src src-clojure">(<span class="org-keyword">defmacro</span> <span class="org-function-name">defpipeline</span> [name &amp; body]
  `(<span class="org-keyword">defn</span> <span class="org-function-name">~name</span> [arg#]
     (<span class="org-builtin">-&gt;</span> arg# ~@body)))
</pre>
<p>
This macro does so little that I debated whether or not to include it. The only thing it eliminates is the argument name. But I like the way it expresses intent: a pipeline is purely the composition of <code>defpipe</code> functions.
</p>
</div>
</div>
<div id="outline-container-4" class="outline-2">
<h2 id="sec-4">Further Possibilities</h2>
<div class="outline-text-2" id="text-4">
<p>
One flaw in the &#8220;pipeline&#8221; style is that it cannot express conditional logic in the middle of a pipeline. Some might say this is a feature: the whole point of the pipeline is that it defines a single thread of execution. But I&#8217;m toying with the idea of adding syntax for predicate dispatch within a pipeline, something like this:
</p>
<pre class="src src-clojure">(<span class="org-keyword">defpipeline</span> <span class="org-function-name">name</span>
  pipe1
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Map signifies a conditional branch:</span>
  {predicate-a pipe-a
   predicate-b pipe-b
   <span class="org-constant">:else</span>       pipe-c}
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Regular pipeline execution follows:</span>
  pipe2
  pipe3)
</pre>
</div>
</div>
<div id="outline-container-5" class="outline-2">
<h2 id="sec-5">The Whole Shebang</h2>
<div class="outline-text-2" id="text-5">
<p>
The complete implementation follows. I&#8217;ve added doc strings, metadata, and some helper functions to parse the arguments to <code>defpipe</code> and <code>defpipeline</code> in the same style as <code>defn</code>.
</p>
<pre class="src src-clojure">(<span class="org-keyword">def</span> <span class="org-constant">^:private</span> <span class="org-function-name">pipe-arg</span> (<span class="org-variable-name">gensym</span> <span class="org-string">"pipeline-argument"</span>))

(<span class="org-keyword">defn-</span> <span class="org-function-name">req</span>
  <span class="org-doc">"Required argument"</span>
  [pred spec message]
  (<span class="org-variable-name">assert</span> (pred (<span class="org-variable-name">first</span> spec))
          (<span class="org-variable-name">str</span> message <span class="org-string">" : "</span> (<span class="org-variable-name">pr-str</span> (<span class="org-variable-name">first</span> spec))))
  [(<span class="org-variable-name">first</span> spec) (<span class="org-variable-name">rest</span> spec)])

(<span class="org-keyword">defn-</span> <span class="org-function-name">opt</span>
  <span class="org-doc">"Optional argument"</span>
  [pred spec]
  (<span class="org-builtin">if</span> (pred (<span class="org-variable-name">first</span> spec))
    [(<span class="org-variable-name">list</span> (<span class="org-variable-name">first</span> spec)) (<span class="org-variable-name">rest</span> spec)]
    [nil spec]))

(<span class="org-keyword">defmacro</span> <span class="org-function-name">defpipeline</span> [name &amp; spec]
  (<span class="org-builtin">let</span> [[docstring spec] (opt string? spec)
        [attr-map spec] (opt map? spec)]
    `(<span class="org-keyword">defn</span> <span class="org-function-name">~name</span> 
       ~@docstring
       ~@attr-map
       [arg#]
       (<span class="org-builtin">-&gt;</span> arg# ~@spec))))

(<span class="org-keyword">defmacro</span> <span class="org-function-name">defpipe</span>
  <span class="org-doc">"Defines a function which takes one argument, a map. The params are</span>
<span class="org-doc">  symbols, which will be bound to values from the map as by :keys</span>
<span class="org-doc">  destructuring. In any tail position of the body, use the 'return'</span>
<span class="org-doc">  macro to update and return the input map."</span>
  [name &amp; spec]
  {<span class="org-constant">:arglists</span> '([name doc-string? attr-map? [params*] &amp; body])}
  (<span class="org-builtin">let</span> [[docstring spec] (opt string? spec)
        [attr-map spec] (opt map? spec)
        [argv spec] (req vector? spec <span class="org-string">"Should be a vector"</span>)]
    (<span class="org-variable-name">assert</span> (<span class="org-variable-name">every?</span> symbol? argv)
            (<span class="org-variable-name">str</span> <span class="org-string">"Should be a vector of symbols : "</span>
                 (<span class="org-variable-name">pr-str</span> argv)))
    `(<span class="org-keyword">defn</span> <span class="org-function-name">~name</span>
       ~@docstring
       ~@attr-map
       [~pipe-arg]
       (<span class="org-builtin">let</span> [{<span class="org-constant">:keys</span> ~argv} ~pipe-arg]
         ~@spec))))

(<span class="org-keyword">defn-</span> <span class="org-function-name">return-clause</span> [spec]
  (<span class="org-builtin">let</span> [[command sym &amp; body] spec]
    (<span class="org-builtin">case</span> command
      <span class="org-constant">:update</span> `(<span class="org-variable-name">update-in</span> [~(<span class="org-variable-name">keyword</span> (<span class="org-variable-name">name</span> sym))] ~@body)
      <span class="org-constant">:set</span>    `(<span class="org-variable-name">assoc</span> ~(<span class="org-variable-name">keyword</span> (<span class="org-variable-name">name</span> sym)) ~@body)
      <span class="org-constant">:remove</span> `(<span class="org-variable-name">dissoc</span> ~(<span class="org-variable-name">keyword</span> (<span class="org-variable-name">name</span> sym)) ~@body)
      body)))

(<span class="org-keyword">defmacro</span> <span class="org-function-name">return</span>
  <span class="org-doc">"Within the body of the defpipe macro, returns the input argument of</span>
<span class="org-doc">  the defpipe function. Must be in tail position. The input argument,</span>
<span class="org-doc">  a map, is threaded through exprs as by the -&gt; macro.</span>

<span class="org-doc">  Expressions within the 'return' macro may take one of the following</span>
<span class="org-doc">  forms:</span>

<span class="org-doc">      (:set key value)      ; like (assoc :key value)</span>
<span class="org-doc">      (:remove key)         ; like (dissoc :key)</span>
<span class="org-doc">      (:update key f args*) ; like (update-in [:key] f args*)</span>

<span class="org-doc">  Optionally, any other expression may be used: the input map will be</span>
<span class="org-doc">  inserted as its first argument."</span>
  [&amp; exprs]
  `(<span class="org-builtin">-&gt;</span> ~pipe-arg
       ~@(<span class="org-variable-name">map</span> return-clause exprs)))
</pre>
</div>
</div>
<div id="outline-container-6" class="outline-2">
<h2 id="sec-6">And a Made-Up Example</h2>
<div class="outline-text-2" id="text-6">
<pre class="src src-clojure">(<span class="org-keyword">defpipe</span> <span class="org-function-name">setup</span> []
  (return  <span class="org-comment-delimiter">; </span><span class="org-comment">imagine these come from a database</span>
   (<span class="org-constant">:set</span> alpha 4)
   (<span class="org-constant">:set</span> beta 3)))

(<span class="org-keyword">defpipe</span> <span class="org-function-name">compute-step1</span> [alpha beta]
  (return (<span class="org-variable-name">:set</span> delta (<span class="org-variable-name">+</span> alpha beta))))

(<span class="org-keyword">defpipe</span> <span class="org-function-name">compute-step2</span> [delta]
  (return
   (<span class="org-variable-name">assoc-in</span> [<span class="org-constant">:x</span> <span class="org-constant">:y</span>] 42)  <span class="org-comment-delimiter">; </span><span class="org-comment">ordinary function expression</span>
   (<span class="org-constant">:update</span> delta * 2)
   (<span class="org-constant">:set</span> gamma (<span class="org-variable-name">+</span> delta 100))))  <span class="org-comment-delimiter">; </span><span class="org-comment">uses old value of delta</span>

(<span class="org-keyword">defpipe</span> <span class="org-function-name">respond</span> [alpha beta gamma delta]
  (<span class="org-variable-name">println</span> <span class="org-string">" Alpha is"</span> alpha <span class="org-string">"\n"</span>
           <span class="org-string">"Beta is"</span> beta <span class="org-string">"\n"</span>
           <span class="org-string">"Delta is"</span> delta <span class="org-string">"\n"</span>
           <span class="org-string">"Gamma is"</span> gamma)
  (return)) <span class="org-comment-delimiter">; </span><span class="org-comment">not strictly necessary, but a good idea</span>

(<span class="org-keyword">defpipeline</span> <span class="org-function-name">compute</span>
  compute-step1
  compute-step2)

(<span class="org-keyword">defpipeline</span> <span class="org-function-name">process-request</span>
  setup
  compute
  respond)
</pre>
<pre class="src src-clojure">(process-request {})

<span class="org-comment-delimiter">;; </span><span class="org-comment">Alpha is 4 </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Beta is 3 </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Delta is 14 </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Gamma is 107</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">=&gt; {:gamma 107, :delta 14, :beta 3, :alpha 4}</span>
</pre>
</div>
</div>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="2012/05/16/syntactic-pipelines.html" rel="bookmark"><time class="entry-date published" datetime="2012-05-16T17:42:41+00:00">May 16, 2012</time><time class="updated" datetime="2012-05-17T09:46:27+00:00">May 17, 2012</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="tag/clojure.html" rel="tag">Clojure</a>, <a href="tag/macros.html" rel="tag">macros</a></span><span class="comments-link"><a href="2012/05/16/syntactic-pipelines.html#comments">14 Comments<span class="screen-reader-text"> on Syntactic Pipelines</span></a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-613" class="post-613 post type-post status-publish format-standard hentry category-programming tag-exceptions">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="2012/04/03/three-kinds-of-error.html" rel="bookmark">Three Kinds of Error</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>
<b>Warning! This post contains strong, New York City-inflected language. If you are discomfited or offended by such language, do not read further &hellip;</b>
</p>
<p>
further &hellip;
</p>
<p>
further &hellip;
</p>
<p>
further &hellip;
</p>
<p>
This is about three categories of software error. I have given them catchy names for purposes of illustration. The three kinds of error are the <i>Fuck-Up</i>, the <i>Oh, Fuck</i> and the <i>What the Fuck?</i>.
</p>
<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">One</h2>
<div class="outline-text-2" id="text-1">
<p>
The <i>Fuck-Up</i> is a simple programmer mistake. In prose writing, it would be called a typo. You misspelled the name of a function or variable. You forgot to include all the arguments to a function. You misplaced a comma, bracket, or semicolon.
</p>
<p>
<i>Fuck-Up</i> errors are usually caught early in the development process and very soon after they are written. You made a change, and suddenly your program doesn&#8217;t work. You look back at what you just wrote and the mistake jumps right out at you.
</p>
<p>
Statically-typed languages can often catch <i>Fuck-Ups</i> at compile time, but not always. The mistake may be syntactically valid but semantically incorrect, or it may be a literal value such as a string or number which is not checked by the compiler. I find that one of the more insidious <i>Fuck-Ups</i> occurs when I misspell the name of a field, property, or keyword. This is more common in dynamically-typed languages that use literal keywords for property accesses, but even strongly-typed Java APIs sometimes use strings for property names. Compile-time type checkers cannot save you from all your <i>Fuck-Ups</i>.
</p>
<p>
I&#8217;ve occasionally wished for a source code checker that would look at all syntactic tokens in my program and warn me whenever I use a token exactly once: that&#8217;s a good candidate for a typo. Editors can help: even without the kind of semantic auto-completion found in Java IDEs, I&#8217;ve found I can avoid some misspellings by using auto-completion based solely on other text in the project.
</p>
<p>
<i>Fuck-Ups</i> become harder to diagnose the longer they go unnoticed. They are particularly dangerous in edge-case code that rarely gets run. The application seems to work until it encounters that unusual path, at which point it fails mysteriously. The failure could be many layers removed from the source line containing the <i>Fuck-Up</i>. This is where rapid feedback cycles and test coverage are helpful.
</p>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="sec-2">Two</h2>
<div class="outline-text-2" id="text-2">
<p>
Said with a mixture of resignation and annoyance, <i>Oh, Fuck</i> names the category of error when a program makes a seemingly-reasonable assumption about the state of the world that turns out not to be true. A file doesn&#8217;t exist. There isn&#8217;t enough disk space. The network is unreachable. We have wandered off the happy path and stumbled into the wilderness of the unexpected.
</p>
<p>
<i>Oh, Fuck</i> errors are probably the most common kind to make it past tests, due to positive bias. They&#8217;re also the most commonly ignored during development, because they are essentially unrelated to the problem at hand. You don&#8217;t care <i>why</i> the file wasn&#8217;t there, and it&#8217;s not necessarily something you can do anything about. But your code still has to deal with the possibility.
</p>
<p>
I would venture that most errors which make it through static typing, testing, and QA to surface in front of production users are <i>Oh, Fuck</i> errors. It&#8217;s difficult to anticipate everything that could go wrong.
</p>
<p>
However, I believe that <i>Oh, Fuck</i> errors are often inappropriately categorized as exceptions, because they are not really &#8220;exceptional,&#8221; <i>i.e.</i> rare. Exceptions are a form of non-local control flow, the last relic of <code>GOTO</code>. Whenever a failed condition causes an <i>Oh, Fuck</i> error, it typically needs to be handled locally, near the code that attempted to act on the condition, not in some distant error handler. Java APIs frequently use exceptions to indicate that an operation failed, but really they&#8217;re working around Java&#8217;s lack of union types. The return type of an file-read operation, for example, is the union of its normal return value and <code>IOException</code>. You have to handle both cases, but there&#8217;s rarely a good reason for the <code>IOException</code> to jump all the way out of the current function stack.
</p>
<p>
Programming &#8220;defensively&#8221; is not a bad idea, but filling every function with try/catch clauses is tedious and clutters up the code with non-essential concerns. I would advocate, instead, trying to isolate problem-domain code behind a &#8220;defensive&#8221; barrier of condition checking. Enumerate all the assumptions your code depends on, then encapsulate it in code which checks those assumptions. Then the problem-domain code can remain concise and free of extraneous error-checking.
</p>
<p>
Java APIs also frequently use <code>null</code> return values to indicate failure. Every non-primitive Java type declaration is an implicit union with <code>null</code>, but it&#8217;s easy to forget this, leading to the dreaded and difficult-to-diagnose <code>NullPointerException</code>. The possibility of a <code>null</code> return value really should be part of the type declaration. For languages which do not support such declarations, rigorous documentation is the only recourse.
</p>
</div>
</div>
<div id="outline-container-3" class="outline-2">
<h2 id="sec-3">Three</h2>
<div class="outline-text-2" id="text-3">
<p>
Finally, we have the errors that really are exceptional circumstances. You ran out of memory, divided by zero, overflowed an integer. In rare cases, these errors are caused by intermittent hardware failures, making them virtually impossible to reproduce consistently. More commonly, they are caused by emergent properties of the code that you did not anticipate. <i>What the Fuck?</i> errors are almost always encountered in production, when the program is exposed to new circumstances, longer runtimes, or heavier loads than it was ever tested with.
</p>
<p>
By definition, <i>What the Fuck?</i> errors are those you did not expect. The best you can do is try to ensure that such errors are noticed quickly and are not allowed to compromise the correct behavior of the system. Depending on requirements, this may mean the system should immediately shut down on encountering such an error, or it may mean selectively aborting and restarting the affected sub-processes. In either case, non-local control flow is probably your best hope. <i>What the Fuck?</i> errors are a crisis in your code: forget whatever you were trying to do and concentrate on minimizing the damage. The <i>worst</i> response is to ignore the error and continue as if nothing had happened: the system is in a failed state, and nothing it produces can be trusted.
</p>
</div>
</div>
<div id="outline-container-4" class="outline-2">
<h2 id="sec-4">Conclusion</h2>
<div class="outline-text-2" id="text-4">
<p>
All errors, even <i>What the Fuck?</i> errors, are ultimately programmer errors. But programmers are human, and software is hard. These categories I&#8217;ve named are not the only kinds of errors software can have, nor are they mutually exclusive. What starts as a simple <i>Fuck-Up</i> could trigger an <i>Oh, Fuck</i> that blossoms into a full-blown <i>What the Fuck?</i>.
</p>
<p>
Be careful out there.
</p>
</div>
</div>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="2012/04/03/three-kinds-of-error.html" rel="bookmark"><time class="entry-date published" datetime="2012-04-03T11:07:00+00:00">April 3, 2012</time><time class="updated" datetime="2012-04-05T07:12:53+00:00">April 5, 2012</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="tag/exceptions.html" rel="tag">exceptions</a></span><span class="comments-link"><a href="2012/04/03/three-kinds-of-error.html#comments">2 Comments<span class="screen-reader-text"> on Three Kinds of Error</span></a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-607" class="post-607 post type-post status-publish format-standard hentry category-programming tag-clojure">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="2012/01/03/clojure-2011-year-in-review.html" rel="bookmark">Clojure 2011 Year in Review</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>A new year is upon us. Before the world ends, let&#8217;s take a look back at what 2011 meant for everybody&#8217;s favorite programming language:
</p>
<ul>
<li>
<p><a href="https://groups.google.com/d/msg/clojure/w5Nmx5rPaQs/-Kl4dvGApP0J">Clojure 1.3.0 was released</a>, bringing better performance to numeric applications, reader syntax for record types, and <a href="https://github.com/clojure/clojure/blob/1.3.x/changes.txt">other enhancements</a>.</p>
</li>
<li>
<p><a href="http://clojure.com/blog/2011/07/22/introducing-clojurescript.html">ClojureScript was unveiled</a> to the world, leading to universal confusion about how to pronounce &#8220;Clojure&#8221; differently from &#8220;Closure.&#8221;</p>
</li>
<li>
<p>The <a href="http://clojure-conj.org/">second Clojure/conj</a> went off without a hitch but <a href="http://overtone.github.com/">plenty of bang</a>.</p>
</li>
<li>
<p><a href="http://clojure.com/blog/2011/12/05/lojic-part-one.html">Logic programming</a> burst into the mindspace of Clojure developers with <a href="http://clojure.com/blog/2011/12/08/lojic-part-two.html">core.logic</a>.</p>
</li>
<li>
<p><a href="http://dev.clojure.org/display/doc/Clojure+Contrib">Clojure-contrib was completely restructured</a> to support new libraries, a distributed development model, and an automated release process.</p>
</li>
<li>
<p><a href="https://groups.google.com/d/msg/clojure/QZGmfWFsgoo/XbqpUy5wuqYJ">ClojureCLR got a new home</a> and recognition as a Clojure sub-project.</p>
</li>
<li>
<p>David Liebke <a href="http://clojure.com/blog/2011/11/29/avout.html">introduced Avout</a>, an extension of Clojure&#8217;s software transactional memory model to distributed computing.</p>
</li>
<li>
<p>Clojure project management tools <a href="http://groups.google.com/group/leiningen/browse_thread/thread/5a79d02198a91b91">Leiningen and Cake</a> decided to bury the hatchet and join forces for the greater good.</p>
</li>
<li>
<p><a href="http://clojure.com/blog/">Clojure/core started blogging</a> more regularly.</p>
</li>
<li>
<p>Books! <a href="http://www.manning.com/fogus/">The Joy of Clojure</a> and <a href="http://www.manning.com/rathore/">Clojure in Action</a> (both from Manning) hit the bookshelves. The <a href="http://pragprog.com/book/shcloj2/programming-clojure">Second Edition of Programming Clojure</a> (Pragmatic) and <a href="http://shop.oreilly.com/product/0636920013754.do">Clojure Programming</a> (O&#8217;Reilly) went into early release.</p>
</li>
<li>
<p>PragPub magazine <a href="http://pragprog.com/magazines/2011-07/content">dedicated their July 2011 issue to Clojure</a>.</p>
</li>
<li>
<p>Chas Emerick released <a href="http://www.clojureatlas.com/">Clojure Atlas</a>, an interactive documentation system.</p>
</li>
<li>
<p>Clojure creator <a href="http://www.infoq.com/presentations/Simple-Made-Easy">Rich Hickey spoke at Strange Loop</a> and caused a minor tweet-storm.</p>
</li>
<li>
<p><a href="https://www.4clojure.com/">4Clojure</a> entered the world, giving thousands of programmers a new way to kill time and learn Clojure.</p>
</li>
</ul>
<p>
At this point, I&#8217;ve been typing and looking up links for an hour, so I&#8217;m calling it quits. Needless to say, this was a big year for Clojure, and I&#8217;m sure there&#8217;s a ton of stuff that I missed on this list. Regarding 2012, all I can say is, <i>You ain&#8217;t seen nothing yet</i>.</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=49&amp;d=blank&amp;r=g' srcset='https://secure.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=98&amp;d=blank&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">Author </span> <a class="url fn n" href="author/stuart.html">Stuart</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="2012/01/03/clojure-2011-year-in-review.html" rel="bookmark"><time class="entry-date published" datetime="2012-01-03T08:00:15+00:00">January 3, 2012</time><time class="updated" datetime="2012-01-03T11:56:37+00:00">January 3, 2012</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="category/programming.html" rel="category tag">Programming</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="tag/clojure.html" rel="tag">Clojure</a></span><span class="comments-link"><a href="2012/01/03/clojure-2011-year-in-review.html#comments">5 Comments<span class="screen-reader-text"> on Clojure 2011 Year in Review</span></a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

		</main><!-- .site-main -->
	</div><!-- .content-area -->


	<aside id="secondary" class="sidebar widget-area" role="complementary">
		<section id="search-3" class="widget widget_search">
<form role="search" method="get" class="search-form" action="https://stuartsierra.com/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
	</label>
	<button type="submit" class="search-submit"><span class="screen-reader-text">Search</span></button>
</form>
</section><section id="text-4" class="widget widget_text">			<div class="textwidget"><ul>
<li><a href="http://feeds2.feedburner.com/StuartSierra" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="comments/feed" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
</ul>
<ul>
<li><a href="https://twitter.com/stuartsierra">Twitter</a></li>
<li><a href="https://github.com/stuartsierra">GitHub</a></li>
</ul></div>
		</section><section id="tag-widget-2" class="widget TagWidget"><h2 class="widget-title">Clojure Do’s and Don’ts</h2><ul class = "posts-by-tag-list"><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-883"><a class = "posts-by-tag-item-title" href="2015/08/25/clojure-donts-lazy-effects.html">Clojure Don’ts: Lazy Effects</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-877"><a class = "posts-by-tag-item-title" href="2015/08/10/clojure-donts-redundant-map.html">Clojure Don’ts: Redundant map</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-870"><a class = "posts-by-tag-item-title" href="2015/06/16/clojure-donts-single-branch-if.html">Clojure Don’ts: Single-branch if</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-854"><a class = "posts-by-tag-item-title" href="2015/06/10/clojure-donts-heisenparameter.html">Clojure Don’ts: The Heisenparameter</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-849"><a class = "posts-by-tag-item-title" href="2015/06/01/clojure-donts-optional-arguments-with-varargs.html">Clojure Don’ts: Optional Arguments with Varargs</a></li><li class="posts-by-tag-item Clojure do's and don'ts errors" id="posts-by-tag-item-836"><a class = "posts-by-tag-item-title" href="2015/05/27/clojure-uncaught-exceptions.html">Clojure Do’s: Uncaught Exceptions</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-831"><a class = "posts-by-tag-item-title" href="2015/05/17/clojure-record-constructors.html">Record Constructors</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-826"><a class = "posts-by-tag-item-title" href="2015/05/10/clojure-namespace-aliases.html">Clojure Do’s: Namespace Aliases</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-820"><a class = "posts-by-tag-item-title" href="2015/05/02/clojure-donts-isa.html">Clojure Don’ts: isa?</a></li><li class="posts-by-tag-item Clojure do's and don'ts" id="posts-by-tag-item-812"><a class = "posts-by-tag-item-title" href="2015/04/26/clojure-donts-concat.html">Clojure Don’ts: Concat</a></li></ul></section>	</aside><!-- .sidebar .widget-area -->

		</div><!-- .site-content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
							<nav class="main-navigation" role="navigation" aria-label="Footer Primary Menu">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="primary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-635"><a href="about-me.html">About Me</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-633"><a href="writing.html">Writing</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-634"><a href="presentations.html">Presentations</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-636"><a href="software.html">Software</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-637"><a href="contact.html">Contact</a></li>
</ul></div>				</nav><!-- .main-navigation -->
			
			
			<div class="site-info">
								<span class="site-title"><a href="index.html" rel="home">Digital Digressions by Stuart Sierra</a></span>
				<a href="https://wordpress.org/">Proudly powered by WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- .site-footer -->
	</div><!-- .site-inner -->
</div><!-- .site -->

	<div style="display:none">
	<div class="grofile-hash-map-55878d0196b91803f9cb2c372b0551d3">
	</div>
	</div>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201635'></script>
<script type='text/javascript' src='https://secure.gravatar.com/js/gprofiles.js?ver=2016Sepaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content/plugins/jetpack/modules/wpgroho167b.js?ver=4.6'></script>
<script type='text/javascript' src='wp-content/themes/twentysixteen/js/skip-link-focus-fix8de4.js?ver=20160816'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var screenReaderText = {"expand":"expand child menu","collapse":"collapse child menu"};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content/themes/twentysixteen/js/functions8de4.js?ver=20160816'></script>
<script type='text/javascript' src='wp-includes/js/wp-embed.min167b.js?ver=4.6'></script>
<script type='text/javascript' src='https://stats.wp.com/e-201635.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:4.2.2',blog:'2702563',post:'0',tz:'-4',srv:'stuartsierra.com'} ]);
	_stq.push([ 'clickTrackerInit', '2702563', '0' ]);
</script>
</body>

<!-- Mirrored from stuartsierra.com/2012 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 02 Sep 2016 16:59:43 GMT -->
</html>

<!-- Dynamic page generated in 0.370 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2016-09-02 12:57:01 -->

<!-- Compression = gzip -->